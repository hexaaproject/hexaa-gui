function ResourceFactory(){function a(){this._original=angular.copy(this)}function b(){for(var a in this._original)"_original"!==a&&(this[a]=this._original[a])}function c(a){return new e(a)}var d={id:-1},e=function(a){var b=angular.copy(d);angular.extend(this,a||b),this._original={},angular.copy(a||d,this._original)};return e.prototype.undo=b,e.prototype.commit=a,e["new"]=c,e}function OrganizationFactory(a){function b(a){var b=angular.copy(h);angular.extend(this,a||b)}function c(a){return new b(a)}function d(){var b=a.get("OrganizationsProxy");return b.deleteOrganization(this.id)}function e(){var b=a.get("OrganizationsProxy");if(-1===this.id||void 0===this.id){var c=this;return b.createOrganization(this).then(f(c))}return b.updateOrganization(this)}function f(a){return function(b){a.default_role=angular.fromJson(b.config.data).default_role,a.id=null!=b.config.url.match("(.*)/api/organizations/(.*).json")?b.config.url.match("(.*)/api/organizations/(.*).json")[2]:b.headers("Location").match("(.*)/api/organizations/(.*)")[2]}}var g=a.get("ResourceEntity"),h={name:null,description:null,default_role:null,members:[],managers:[],invitations:[],role:{name:"default"},roles:[],entitlements:[],entitlementpacks:[]};return b.prototype=g["new"](),b.prototype["delete"]=d,b.prototype.save=e,b["new"]=c,b}function SercviceFactory(a){function b(a){var b=angular.copy(i);angular.extend(this,a||b)}function c(a){return new b(a)}function d(){var b=a.get("ServicesProxy");return void 0===this.id||-1===this.id?b.addService(this,this.contacts):b.updateService(this)}function e(){var b=a.get("ServicesProxy");return b.deleteService(this.id)}function f(a){this.logo_path=a}function g(){return void 0===this.logo_path||null===this.logo_path||""===this.logo_path?baseUIAddr+"/images/default.png":baseAddr+"/"+this.logo_path}var h=a.get("ResourceEntity"),i={name:null,description:null,managers:[],org_name:null,org_description:null,org_short_name:null,org_url:null,priv_url:null,priv_description:null};return b.prototype=h["new"](),b.prototype.save=d,b.prototype.getLogo=g,b.prototype["delete"]=e,b.prototype.setLogo=f,b["new"]=c,b}function RoleFactory(a){function b(a){var b=angular.copy(g);angular.extend(this,a||b),this._original=angular.copy(a||b)}function c(a){return new b(a)}function d(){var b=a.get("RolesProxy");return b.deleteRole(this.id)}function e(){var b=a.get("RolesProxy");if(-1==this.id||void 0==this.id){var c=this;return b.createRole(this.oid,this).then(function(a){c.id=a.headers("Location").match("(.*)/api/roles/(.*)")[2],c._original=angular.copy(c)})}return b.updateRole(this)}var f=a.get("ResourceEntity"),g={name:null,description:null,start_date:null,end_date:null,principals:[],entitlements:[]};return b.prototype=f["new"](),b.prototype.save=e,b.prototype["delete"]=d,b["new"]=c,b}function PrincipalFactory(a){function b(a){var b=angular.copy(h);angular.extend(this,a||b)}function c(a){return new b(a)}function d(){var b=a.get("PrincipalProxy");return b.deletePrincipal(this.id)}function e(){var b=a.get("PrincipalProxy");return void 0==this.id||-1==this.id?b.addPrincipal(this).success(f(this)):b.updatePrincipal(this)}function f(a){return function(b,c,d){a.id=d("Location").match("(.*)/api/principals/(.*)/id")[2]}}var g=a.get("ResourceEntity"),h={fedid:null,display_name:null,email:[]};return b.prototype=g["new"](),b.prototype.save=e,b.prototype["delete"]=d,b["new"]=c,b}function InvitationFactory(a){function b(a){var b=angular.copy(h);angular.extend(this,a||b)}function c(a){return new b(a)}function d(){var b=a.get("InvitationsProxy");return b["delete"](this.id)}function e(){var b=a.get("InvitationsProxy");return-1===this.id||void 0===this.id?b.invite(this):b.update(this)}function f(){var b=a.get("InvitationsProxy");return b.resend(this.id)}var g=a.get("ResourceEntity"),h={limit:null,start_date:null,end_date:null,locale:null,landing_url:null,emails:[],statuses:{},counter:null,message:null};return b.prototype=g["new"](),b.prototype.resend=f,b.prototype.save=e,b.prototype["delete"]=d,b["new"]=c,b}function EntitlementpackFactory(a){function b(a){var b=angular.copy(i);angular.extend(this,a||b),this._original=angular.copy(a||b)}function c(){var b=a.get("ServicesProxy");return-1===this.id||void 0===this.id?b.addEntitlementpack(this.service.id,this):b.updateEntitlementpack(this)}function d(a){return new b(a)}function e(){var b=a.get("EntitlementpacksProxy");return b.generateToken(this.id)}function f(){var b=a.get("EntitlementpacksProxy");return b.getEntitlements(this.id)}function g(){var b=a.get("EntitlementpacksProxy");return b.remove(this.id)}var h=a.get("ResourceEntity"),i={entitlements:[],name:[],description:[],type:!1,token:null};return b.prototype=h["new"](),b.prototype.getToken=e,b.prototype.getEntitlements=f,b.prototype["delete"]=g,b.prototype.save=c,b["new"]=d,b}function AttributeSpecificationFactory(a){function b(a){angular.extend(this,a||angular.copy(g))}function c(a){return new b(a)}function d(){var b=a.get("AttributeSpecificationsProxy");return b["delete"](this.id)}function e(){var b=a.get("AttributeSpecificationsProxy");return-1===this.id||void 0===this.id?b.create(this).success(f(this)):b.update(this)}function f(a){return function(b,c,d){a.id=d("Location").match("(.*)/api/attributespecs/(.*)")[2]}}var g={name:null,is_public:null,description:null},h=a.get("ResourceEntity");return b.prototype=h["new"](),b.constructor=b,b.prototype.save=e,b.prototype["delete"]=d,b["new"]=c,b}function PrincipalProxyService(a,b,c,d,e){function f(){var a=c+"/Shibboleth.sso/Logout?return="+c,b=btoa(a);location.href="logout.php?redirect="+b}function g(a){q.managedOrganizations.push(a)}function h(a){q.managedServices.push(a)}function i(){j()}function j(){return a.getPrincipal().then(o)}function k(){return null!==q?q:(q={},q.$promise=j(),q)}function l(a){return void 0!==a&&void 0!==q?q.isAdmin||$linq(q.managedServices).indexOf("x=>x.id=="+a)>=0:!1}function m(a){if(void 0!==a){if(void 0!==q){var b=$linq(q.managedOrganizations).indexOf("x=>x.id=="+a)>=0;return q.isAdmin||b}return!1}return!1}function n(a){return void 0!==a&&void 0!==q?q.isAdmin||$linq(q.memberships).indexOf("x=>x.id=="+a)>=0:!1}function o(a){angular.copy(a.data,q),angular.extend(q,s),b.setIsAdmin(a.data.isAdmin)}function p(a){b.setIsAdmin(a),q.isAdmin=a,d.$broadcast(e.onUserPermissionChanged)}var q=null,r={run:i,refresh:j,getProfile:k,logout:f},s={isManagerOfService:l,isManagerOfOrganization:m,isMemberOfOrganization:n,setIsAdmin:p,addManagedOrganization:g,addManagedService:h};return r}function pagerFilter(a,b){return void 0!==a?void 0!==b?$linq(a).skip((b.currentPage-1)*b.itemPerPage).take(b.itemPerPage).toArray():a:[]}function pagerFilterFactory(){return pagerFilter}function imageFormatterFilter(a,b){return function(c){return void 0===c||null===c||""===c?b+"/images/default.png":a+"/"+this.logo_path}}function placeholderFilter(a,b){return void 0===a?b:a}function placeholderFilterFactory(){return placeholderFilter}function navigate(a){window.location=a}function wrapResponse(a,b,c,d){return{data:a,status:b,headers:c,config:d}}function Jobject(){Jobject.prototype.prop=function(a,b){return void 0!==b&&(this[a]=b),this}}function QueryStringBuilder(a){var b={};QueryStringBuilder.prototype.set=function(a,c){return void 0!==c&&(b[a]=c),this},QueryStringBuilder.prototype.toString=function(){var c=void 0!==a?a:"";c.endsWith("?")||-1!=c.indexOf("?")||(c+="?");for(var d in b)("/"!==c[c.length]||"?"!==c[c.length])&&(c+="&"),c+=d+"="+b[d];return c}}angular.module("multi-select",["ng"]).directive("multiSelect",["$sce","$timeout",function(a,b){return{restrict:"AE",replace:!0,scope:{inputModel:"=",outputModel:"=",staticLabel:"@",buttonLabel:"@",defaultLabel:"@",directiveId:"@",helperElements:"@",isDisabled:"=",itemLabel:"@",maxLabels:"@",orientation:"@",selectionMode:"@",tickProperty:"@",disableProperty:"@",groupProperty:"@",maxHeight:"@",onClose:"&",onItemClick:"&",onOpen:"&"},template:'<span class="multiSelect inlineBlock"><button type="button" class="button multiSelectButton" ng-click="toggleCheckboxes( $event ); refreshSelectedItems(); refreshButton();" ng-bind-html="varButtonLabel"></button><div class="checkboxLayer"><form><div class="helperContainer" ng-if="displayHelper( \'filter\' ) || displayHelper( \'all\' ) || displayHelper( \'none\' ) || displayHelper( \'reset\' )"><div class="line" ng-if="displayHelper( \'all\' ) || displayHelper( \'none\' ) || displayHelper( \'reset\' )"><button type="button" ng-click="select( \'all\',   $event );"    class="helperButton" ng-if="!isDisabled && displayHelper( \'all\' )">   &#10003;&nbsp; Select All</button> <button type="button" ng-click="select( \'none\',  $event );"   class="helperButton" ng-if="!isDisabled && displayHelper( \'none\' )">  &times;&nbsp; Select None</button><button type="button" ng-click="select( \'reset\', $event );"  class="helperButton" ng-if="!isDisabled && displayHelper( \'reset\' )" style="float:right">&#8630;&nbsp; Reset</button></div><div class="line" style="position:relative" ng-if="displayHelper( \'filter\' )"><input placeholder="Search..." type="text" ng-click="select( \'filter\', $event )" ng-model="inputLabel.labelFilter" ng-change="updateFilter();$scope.getFormElements();" class="inputFilter" /><button type="button" class="clearButton" ng-click="inputLabel.labelFilter=\'\';updateFilter();prepareGrouping();prepareIndex();select( \'clear\', $event )">&times;</button> </div></div><div class="checkBoxContainer" style="{{setHeight();}}"><div ng-repeat="item in filteredModel | filter:removeGroupEndMarker" class="multiSelectItem"ng-class="{selected: item[ tickProperty ], horizontal: orientationH, vertical: orientationV, multiSelectGroup:item[ groupProperty ], disabled:itemIsDisabled( item )}"ng-click="syncItems( item, $event, $index );"ng-mouseleave="removeFocusStyle( tabIndex );"><div class="acol" ng-if="item[ spacingProperty ] > 0" ng-repeat="i in numberToArray( item[ spacingProperty ] ) track by $index">&nbsp;</div><div class="acol"><label><input class="checkbox focusable" type="checkbox" ng-disabled="itemIsDisabled( item )" ng-checked="item[ tickProperty ]" ng-click="syncItems( item, $event, $index )" /><span ng-class="{disabled:itemIsDisabled( item )}" ng-bind-html="writeLabel( item, \'itemLabel\' )"></span></label></div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tickMark" ng-if="item[ groupProperty ] !== true && item[ tickProperty ] === true">&#10004;</span></div></div></form></div></span>',link:function(c,d,e){c.backUp=[],c.varButtonLabel="",c.scrolled=!1,c.spacingProperty="",c.indexProperty="",c.checkBoxLayer="",c.orientationH=!1,c.orientationV=!0,c.filteredModel=[],c.inputLabel={labelFilter:""},c.selectedItems=[],c.formElements=[],c.tabIndex=0,c.clickedItem=null,prevTabIndex=0,helperItems=[],helperItemsLength=0,c.setHeight=function(){return"undefined"!=typeof c.maxHeight?"max-height: "+c.maxHeight+"; overflow-y:scroll":void 0},c.numberToArray=function(a){return new Array(a)},c.updateFilter=function(){c.filteredModel=[];var a=0;if("undefined"==typeof c.inputModel)return[];for(a=c.inputModel.length-1;a>=0;a--){"undefined"!=typeof c.inputModel[a][c.groupProperty]&&c.inputModel[a][c.groupProperty]===!1&&c.filteredModel.push(c.inputModel[a]);var d=!1;if("undefined"==typeof c.inputModel[a][c.groupProperty]){for(var e in c.inputModel[a])if("boolean"!=typeof c.inputModel[a][e]&&String(c.inputModel[a][e]).toUpperCase().indexOf(c.inputLabel.labelFilter.toUpperCase())>=0){d=!0;break}d===!0&&c.filteredModel.push(c.inputModel[a])}"undefined"!=typeof c.inputModel[a][c.groupProperty]&&c.inputModel[a][c.groupProperty]===!0&&("undefined"!=typeof c.filteredModel[c.filteredModel.length-1][c.groupProperty]&&c.filteredModel[c.filteredModel.length-1][c.groupProperty]===!1?c.filteredModel.pop():c.filteredModel.push(c.inputModel[a]))}c.filteredModel.reverse(),b(function(){c.getFormElements()},0)},c.getFormElements=function(){c.formElements=[];for(var a=0;a<d[0].getElementsByTagName("FORM")[0].elements.length;a++)c.formElements.push(d[0].getElementsByTagName("FORM")[0].elements[a])},c.isGroupMarker=function(a,b){return"undefined"!=typeof a[c.groupProperty]&&a[c.groupProperty]===b?!0:!1},c.removeGroupEndMarker=function(a){return"undefined"!=typeof a[c.groupProperty]&&a[c.groupProperty]===!1?!1:!0},c.displayHelper=function(a){if(e.selectionMode&&"SINGLE"===c.selectionMode.toUpperCase()){switch(a.toUpperCase()){case"ALL":return!1;case"NONE":return!1;case"RESET":if("undefined"==typeof e.helperElements)return!0;if(e.helperElements&&c.helperElements.toUpperCase().indexOf("RESET")>=0)return!0;break;case"FILTER":if("undefined"==typeof e.helperElements)return!0;if(e.helperElements&&c.helperElements.toUpperCase().indexOf("FILTER")>=0)return!0}return!1}return"undefined"==typeof e.helperElements?!0:e.helperElements&&c.helperElements.toUpperCase().indexOf(a.toUpperCase())>=0?!0:!1},c.syncItems=function(a,b,d){if(b.preventDefault(),b.stopPropagation(),"undefined"!=typeof e.disableProperty&&a[c.disableProperty]===!0)return!1;if("undefined"!=typeof e.isDisabled&&c.isDisabled===!0)return!1;if("undefined"!=typeof a[c.groupProperty]&&a[c.groupProperty]===!1)return!1;if(index=c.filteredModel.indexOf(a),"undefined"!=typeof a[c.groupProperty]&&a[c.groupProperty]===!0){if(e.selectionMode&&"SINGLE"===c.selectionMode.toUpperCase())return!1;var f,g,h=0,i=c.filteredModel.length-1,j=[],k=0;for(f=index;f<c.filteredModel.length&&!(0===k&&f>index);f++)if("undefined"!=typeof c.filteredModel[f][c.groupProperty]&&c.filteredModel[f][c.groupProperty]===!0)0===j.length&&(h=f+1),k+=1;else if("undefined"!=typeof c.filteredModel[f][c.groupProperty]&&c.filteredModel[f][c.groupProperty]===!1){if(k-=1,j.length>0&&0===k){var l=!0;for(i=f,g=0;g<j.length;g++)if("undefined"!=typeof j[g][c.tickProperty]&&j[g][c.tickProperty]===!1){l=!1;break}if(l===!0)for(g=h;i>=g;g++)"undefined"==typeof c.filteredModel[g][c.groupProperty]&&("undefined"==typeof e.disableProperty?(c.filteredModel[g][c.tickProperty]=!1,inputModelIndex=c.filteredModel[g][c.indexProperty],c.inputModel[inputModelIndex][c.tickProperty]=!1):c.filteredModel[g][c.disableProperty]!==!0&&(c.filteredModel[g][c.tickProperty]=!1,inputModelIndex=c.filteredModel[g][c.indexProperty],c.inputModel[inputModelIndex][c.tickProperty]=!1));else for(g=h;i>=g;g++)"undefined"==typeof c.filteredModel[g][c.groupProperty]&&("undefined"==typeof e.disableProperty?(c.filteredModel[g][c.tickProperty]=!0,inputModelIndex=c.filteredModel[g][c.indexProperty],c.inputModel[inputModelIndex][c.tickProperty]=!0):c.filteredModel[g][c.disableProperty]!==!0&&(c.filteredModel[g][c.tickProperty]=!0,inputModelIndex=c.filteredModel[g][c.indexProperty],c.inputModel[inputModelIndex][c.tickProperty]=!0))}}else j.push(c.filteredModel[f])}else{if(e.selectionMode&&"SINGLE"===c.selectionMode.toUpperCase()){for(f=0;f<c.filteredModel.length;f++)c.filteredModel[f][c.tickProperty]=!1;for(f=0;f<c.inputModel.length;f++)c.inputModel[f][c.tickProperty]=!1;c.filteredModel[index][c.tickProperty]=!0,c.toggleCheckboxes(b)}else c.filteredModel[index][c.tickProperty]=!c.filteredModel[index][c.tickProperty];inputModelIndex=c.filteredModel[index][c.indexProperty],void 0!==inputModelIndex&&(c.inputModel[inputModelIndex][c.tickProperty]=c.filteredModel[index][c.tickProperty])}c.clickedItem=angular.copy(a),prevTabIndex=c.tabIndex,c.tabIndex=d+helperItemsLength,b.target.focus(),c.removeFocusStyle(prevTabIndex),c.setFocusStyle(c.tabIndex)},c.refreshSelectedItems=function(){c.selectedItems=[],angular.forEach(c.inputModel,function(a){"undefined"!=typeof a&&"undefined"==typeof a[c.groupProperty]&&a[c.tickProperty]===!0&&c.selectedItems.push(a)})},c.refreshOutputModel=function(){"undefined"!=typeof e.outputModel&&(c.outputModel=angular.copy(c.selectedItems),angular.forEach(c.outputModel,function(a){delete a[c.indexProperty],delete a[c.spacingProperty]}))},c.refreshButton=function(){if(c.varButtonLabel="",ctr=0,void 0===c.staticLabel)if(0===c.selectedItems.length)c.varButtonLabel="undefined"!=typeof c.defaultLabel?c.defaultLabel:"None selected";else{var b=c.selectedItems.length;"undefined"!=typeof c.maxLabels&&""!==c.maxLabels&&(b=c.maxLabels),c.more=c.selectedItems.length>b?!0:!1,angular.forEach(c.selectedItems,function(a){"undefined"!=typeof a&&(ctr<b&&(c.varButtonLabel+=(c.varButtonLabel.length>0?'</div>, <div class="buttonLabel">':'<div class="buttonLabel">')+c.writeLabel(a,"buttonLabel")),ctr++)}),c.more===!0&&(b>0&&(c.varButtonLabel+=", ... "),c.varButtonLabel+="(Total: "+c.selectedItems.length+")")}else c.varButtonLabel=c.staticLabel;c.varButtonLabel=a.trustAsHtml(c.varButtonLabel+'<span class="caret"></span>')},c.itemIsDisabled=function(a){return"undefined"!=typeof e.disableProperty&&a[c.disableProperty]===!0?!0:c.isDisabled===!0?!0:!1},c.writeLabel=function(b,d){var e="",f=c[d].split(" ");return angular.forEach(f,function(a){"undefined"!=typeof a&&angular.forEach(b,function(b,c){c==a&&(e+="&nbsp;"+b)})}),"BUTTONLABEL"===d.toUpperCase()?e:a.trustAsHtml(e)},c.toggleCheckboxes=function(a){if(c.checkBoxLayer=d.children()[1],clickedEl=d.children()[0],angular.element(document).unbind("click",c.externalClickListener),angular.element(document).unbind("keydown",c.keyboardListener),c.inputLabel.labelFilter="",c.updateFilter(),27===a.keyCode)return angular.element(c.checkBoxLayer).removeClass("show"),angular.element(clickedEl).removeClass("buttonClicked"),angular.element(document).unbind("click",c.externalClickListener),angular.element(document).unbind("keydown",c.keyboardListener),c.removeFocusStyle(c.tabIndex),c.onClose({data:d}),!0;if(angular.element(c.checkBoxLayer).hasClass("show"))angular.element(c.checkBoxLayer).removeClass("show"),angular.element(clickedEl).removeClass("buttonClicked"),angular.element(document).unbind("click",c.externalClickListener),angular.element(document).unbind("keydown",c.keyboardListener),c.removeFocusStyle(c.tabIndex),c.onClose({data:d});else{helperItems=[],helperItemsLength=0,angular.element(c.checkBoxLayer).addClass("show"),angular.element(clickedEl).addClass("buttonClicked"),angular.element(document).bind("click",c.externalClickListener),angular.element(document).bind("keydown",c.keyboardListener),c.getFormElements(),c.tabIndex=0;var b=angular.element(d[0].querySelector(".helperContainer"))[0];if("undefined"!=typeof b){for(i=0;i<b.getElementsByTagName("BUTTON").length;i++)helperItems[i]=b.getElementsByTagName("BUTTON")[i];helperItemsLength=helperItems.length+b.getElementsByTagName("INPUT").length}d[0].querySelector(".inputFilter")?(d[0].querySelector(".inputFilter").focus(),c.tabIndex=c.tabIndex+helperItemsLength-2):c.formElements[c.tabIndex].focus(),c.onOpen({data:d})}},c.externalClickListener=function(a){targetsArr=d.find(a.target.tagName);for(var e=0;e<targetsArr.length;e++)if(a.target==targetsArr[e])return;angular.element(c.checkBoxLayer.previousSibling).removeClass("buttonClicked"),angular.element(c.checkBoxLayer).removeClass("show"),angular.element(document).unbind("click",c.externalClickListener),angular.element(document).unbind("keydown",c.keyboardListener),b(function(){c.onClose({data:d})},0)},c.findUpTag=function(a,b,c){for(;a.parentNode;)if(a=a.parentNode,"undefined"!=typeof a.tagName&&a.tagName.toUpperCase()===b.toUpperCase()&&a.className.indexOf(c)>-1)return a;return null},c.select=function(a,b){switch(helperIndex=helperItems.indexOf(b.target),c.tabIndex=helperIndex,a.toUpperCase()){case"ALL":angular.forEach(c.filteredModel,function(a){"undefined"!=typeof a&&a[c.disableProperty]!==!0&&"undefined"==typeof a[c.groupProperty]&&(a[c.tickProperty]=!0)});break;case"NONE":angular.forEach(c.filteredModel,function(a){"undefined"!=typeof a&&a[c.disableProperty]!==!0&&"undefined"==typeof a[c.groupProperty]&&(a[c.tickProperty]=!1)});break;case"RESET":angular.forEach(c.filteredModel,function(a){"undefined"==typeof a[c.groupProperty]&&"undefined"!=typeof a&&a[c.disableProperty]!==!0&&(temp=a[c.indexProperty],void 0!==temp&&(a[c.tickProperty]=c.backUp[temp][c.tickProperty]))});break;case"CLEAR":c.tabIndex=c.tabIndex+1;break;case"FILTER":c.tabIndex=helperItems.length-1}},genRandomString=function(a){for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",c="",d=0;a>d;d++)c+=b.charAt(Math.floor(Math.random()*b.length));return c},c.prepareGrouping=function(){var a=0;angular.forEach(c.filteredModel,function(b){b[c.spacingProperty]=a,b[c.groupProperty]===!0?a+=2:b[c.groupProperty]===!1&&(a-=2)})},c.prepareIndex=function(){ctr=0,angular.forEach(c.filteredModel,function(a){a[c.indexProperty]=ctr,ctr++})},c.keyboardListener=function(a){var b=a.keyCode?a.keyCode:a.which,d=!1;if(27===b)c.toggleCheckboxes(a);else if(40===b||39===b||!a.shiftKey&&9==b)for(d=!0,prevTabIndex=c.tabIndex,c.tabIndex++,c.tabIndex>c.formElements.length-1&&(c.tabIndex=0,prevTabIndex=c.formElements.length-1);c.formElements[c.tabIndex].disabled===!0;)c.tabIndex++,c.tabIndex>c.formElements.length-1&&(c.tabIndex=0);else if(38===b||37===b||a.shiftKey&&9==b)for(d=!0,prevTabIndex=c.tabIndex,c.tabIndex--,c.tabIndex<0&&(c.tabIndex=c.formElements.length-1,prevTabIndex=0);c.formElements[c.tabIndex].disabled===!0;)c.tabIndex--,c.tabIndex<0&&(c.tabIndex=c.formElements.length-1);if(d===!0){a.preventDefault(),a.stopPropagation(),c.formElements[c.tabIndex].focus();var e=document.activeElement;"CHECKBOX"===e.type.toUpperCase()?(c.setFocusStyle(c.tabIndex),c.removeFocusStyle(prevTabIndex)):(c.removeFocusStyle(prevTabIndex),c.removeFocusStyle(helperItemsLength),c.removeFocusStyle(c.formElements.length-1))}d=!1},c.setFocusStyle=function(a){angular.element(c.formElements[a]).parent().parent().parent().addClass("multiSelectFocus")},c.removeFocusStyle=function(a){angular.element(c.formElements[a]).parent().parent().parent().removeClass("multiSelectFocus")};var f=genRandomString(5);c.indexProperty="idx_"+f,c.spacingProperty="spc_"+f,"undefined"!=typeof e.orientation&&("HORIZONTAL"===e.orientation.toUpperCase()?(c.orientationH=!0,c.orientationV=!1):(c.orientationH=!1,c.orientationV=!0)),c.$watch("inputModel",function(a){a&&(c.refreshSelectedItems(),c.refreshOutputModel(),c.refreshButton(),null!==c.clickedItem&&b(function(){c.onItemClick({data:c.clickedItem}),c.clickedItem=null},0))},!0),c.$watch("inputModel",function(a){a&&(c.backUp=angular.copy(c.inputModel),c.updateFilter(),c.prepareGrouping(),c.prepareIndex(),c.refreshSelectedItems(),c.refreshOutputModel(),c.refreshButton())}),c.$watch("isDisabled",function(a){c.isDisabled=a}),angular.element(document).bind("touchstart",function(){c.$apply(function(){c.scrolled=!1})}),angular.element(document).bind("touchmove",function(){c.$apply(function(){c.scrolled=!0})}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){b=b||0;for(var c=this.length;c>b;){if(this[b]===a)return b;++b}return-1})}}}]),angular.module("hexaaApp",["ui.bootstrap","ngCookies","ngRoute","angular.css.injector","pascalprecht.translate","ngSanitize","multi-select","angularFileUpload","toastr","hexaaApp.constants","hexaaApp.config","hexaaApp.filters","hexaaApp.services","hexaaApp.services.facades","hexaaApp.models","hexaaApp.shared","hexaaApp.shared.controllers","hexaaApp.shared.controllers.pages","hexaaApp.shared.controllers.modals","hexaaApp.shared.directives","hexaaApp.components","hexaaApp.components.admin","hexaaApp.components.admin.controllers","hexaaApp.components.admin.controllers.pages","hexaaApp.components.admin.controllers.modals","hexaaApp.components.admin.directives","hexaaApp.components.organizations","hexaaApp.components.organizations.controllers","hexaaApp.components.organizations.controllers.modals","hexaaApp.components.organizations.controllers.pages","hexaaApp.components.organizations.directives","hexaaApp.components.profile","hexaaApp.components.profile.controllers","hexaaApp.components.profile.controllers.pages","hexaaApp.components.profile.directives","hexaaApp.components.profile.controllers.modals","hexaaApp.components.services","hexaaApp.components.services.controllers","hexaaApp.components.services.controllers.modals","hexaaApp.components.services.controllers.pages","hexaaApp.components.services.directives"]),function(){"use strict";angular.module("hexaaApp.constants",[]),angular.module("hexaaApp.constants").constant("baseAddr",baseAddr),angular.module("hexaaApp.constants").constant("apiAddr",apiAddr),angular.module("hexaaApp.constants").constant("hexaaCookieName",hexaaCookieName),angular.module("hexaaApp.constants").constant("settingsCookieName","hexaaUISettings"),angular.module("hexaaApp.constants").constant("baseUIAddr",hexaaUIAddr),angular.module("hexaaApp.constants").constant("tags",[{name:"attribute_release",ticked:!1},{name:"invitation",ticked:!0},{name:"service",ticked:!0},{name:"service_manager",ticked:!0},{name:"service_attribute_spec",ticked:!0},{name:"organization",ticked:!0},{name:"organization_manager",ticked:!0},{name:"organization_member",ticked:!0},{name:"organization_entitlement_pack",ticked:!0},{name:"entityid",ticked:!0}]),angular.module("hexaaApp.constants").constant("events",{notifyUIError:"notify_UI_Error",siteThemeChanged:"site_Theme_Changed",organizationsSelectionChanged:"organizations_List_Changed",servicesSelectionChanged:"services_List_Changed",serviceChanged:"serviceChanged",organizationSave:"organization_Save",organizationChanged:"organizationChanged",serviceSave:"service_Save",organizationCanBeSaved:"organization_can_be_saved",serviceCanBeSaved:"service_can_be_saved",authenticated:"authenticated",authError:"authError",languageChanged:"langChanged",tokenExpired:"tokenExpired",refreshOrganizationInvitations:"refreshOrganizationInvitations",refreshServiceInvitations:"refreshServiceInvitations",subpageTitleChanged:"subpageTitleChanged",forceAction:"forceAction",actionResult:"actionResult",onBadRequest:"onBadRequest",onInternalServerError:"onInternalServerError",onUserPermissionChanged:"onUserPermissionChanged"}),angular.module("hexaaApp").run(["startupService",function(a){a.run()}])}(),angular.module("hexaaApp.config",[]),angular.module("hexaaApp.shared",[]),angular.module("hexaaApp.shared.controllers",[]),angular.module("hexaaApp.shared.controllers.pages",[]),angular.module("hexaaApp.shared.controllers.modals",[]),angular.module("hexaaApp.shared.directives",[]),angular.module("hexaaApp.components",[]),angular.module("hexaaApp.components.admin",[]),angular.module("hexaaApp.components.admin.controllers",[]),angular.module("hexaaApp.components.admin.controllers.modals",[]),angular.module("hexaaApp.components.admin.controllers.pages",[]),angular.module("hexaaApp.components.admin.directives",[]),angular.module("hexaaApp.components.organizations",[]),angular.module("hexaaApp.components.organizations.controllers",[]),angular.module("hexaaApp.components.organizations.controllers.pages",[]),angular.module("hexaaApp.components.organizations.controllers.modals",[]),angular.module("hexaaApp.components.organizations.directives",[]),angular.module("hexaaApp.components.profile",[]),angular.module("hexaaApp.components.profile.controllers",[]),angular.module("hexaaApp.components.profile.controllers.pages",[]),angular.module("hexaaApp.components.profile.controllers.modals",[]),angular.module("hexaaApp.components.profile.directives",[]),angular.module("hexaaApp.components.services",[]),angular.module("hexaaApp.components.services.controllers",[]),angular.module("hexaaApp.components.services.controllers.pages",[]),angular.module("hexaaApp.components.services.controllers.modals",[]),function(){angular.module("hexaaApp.components.services.controllers.modals").controller("EntityIdContactDialogController",["$scope","$modalInstance","entityIds",function(a,b,c){function d(b){var c=$linq(a.selectedContacts).contains(b);c?a.selectedContacts.remove(b):a.selectedContacts.push(b)}function e(c){"close"===c?b.dismiss():b.close(a.selectedContacts)}a.entityIds=c,a.selectedContacts=[],a.close=e,a.select=d}])}(),angular.module("hexaaApp.components.services.directives",[]),angular.module("hexaaApp.services",[]),angular.module("hexaaApp.services.facades",[]),angular.module("hexaaApp.models",[]),angular.module("hexaaApp.filters",[]),function(){"use strict";function a(a,b){function c(a){return f=f||b.get("requestNotificationChannel"),f.requestStarted(),a}function d(a){var c=b.get("$http");return c.pendingRequests.length<1&&(f=f||b.get("requestNotificationChannel"),f.requestEnded()),a}function e(c){var d=b.get("$http");return d.pendingRequests.length<1&&(f=f||b.get("requestNotificationChannel"),f.requestEnded()),401===c.status?f.tokenExpired():500==c.status?f.internalServerError():f.badRequest(c.data),a.reject(c)}var f;return{request:c,response:d,responseError:e}}function b(b){var c=["$q","$injector",a];void 0!==b.interceptors&&b.interceptors.push(c)}angular.module("hexaaApp.config").config(["$httpProvider",b])}(),function(){"use strict";angular.module("hexaaApp.config").config(["$routeProvider",function(a){a.when("/organizations",{templateUrl:"views/components/organizations/pages/index.html"}).when("/organizations/:id?/:page",{templateUrl:"views/components/organizations/pages/index.html"}).when("/services",{templateUrl:"views/components/services/pages/index.html"}).when("/services/:id?/:page",{templateUrl:"views/components/services/pages/index.html"}).when("/profile",{templateUrl:"views/components/profile/pages/index.html"}).when("/profile/:page",{templateUrl:"views/components/profile/pages/index.html"}).when("/profile/myservices/entitlement?/:entitlement_id?",{templateUrl:"views/components/profile/pages/myservices.html"}).when("/profile/myorganizations/entitlement?/:entitlement_id?",{templateUrl:"views/components/profile/pages/myorganizations.html"}).when("/admin",{templateUrl:"views/components/admin/pages/index.html"}).when("/admin/:page",{templateUrl:"views/components/admin/pages/index.html"}).otherwise({redirectTo:"/profile/dashboard"})}])}(),function(){"use strict";angular.module("hexaaApp.config").config(["$translateProvider","$translatePartialLoaderProvider",function(a,b){b.addPart("index"),b.addPart("organizations/index"),b.addPart("organizations/new"),b.addPart("organizations/news"),b.addPart("organizations/properties"),b.addPart("organizations/managers"),b.addPart("organizations/members"),b.addPart("organizations/attributes"),b.addPart("organizations/consents"),b.addPart("organizations/entitlementpacks"),b.addPart("organizations/roles"),b.addPart("organizations/invitations"),b.addPart("organizations/inviteorgmanagers"),b.addPart("organizations/inviteorgmembers"),b.addPart("organizations/principalmanagement"),b.addPart("organizations/public_catalog"),b.addPart("organizations/modals/attributeEditorDialog"),b.addPart("modals/message"),b.addPart("modals/entityIdContactDialog"),b.addPart("modals/newRole"),b.addPart("modals/newEntitlementpackDialog"),b.addPart("modals/invitation"),b.addPart("modals/confirmationDialog"),b.addPart("modals/loading"),b.addPart("modals/organizationDetails"),b.addPart("modals/serviceDetails"),b.addPart("modals/organizationChangerDialog"),b.addPart("modals/serviceChangerDialog"),b.addPart("admin/attributespecifications"),b.addPart("admin/new_attrspec"),b.addPart("admin/index"),b.addPart("admin/principals"),b.addPart("admin/entityids"),b.addPart("admin/modals/newAttrspecDialog"),b.addPart("profile/index"),b.addPart("profile/attributes"),b.addPart("profile/modals/attributeEditorDialog"),b.addPart("profile/me"),b.addPart("profile/vowizard"),b.addPart("profile/consents"),b.addPart("profile/dashboard"),b.addPart("profile/myorganizations"),b.addPart("profile/myservices"),b.addPart("profile/news"),b.addPart("services/index"),b.addPart("services/owner"),b.addPart("services/properties"),b.addPart("services/managers"),b.addPart("services/entitlements"),b.addPart("services/modals/newEntitlementpackDialog"),b.addPart("services/attributespecifications"),b.addPart("services/entitlementpacks"),b.addPart("services/connectedpacks"),b.addPart("services/invitations"),b.addPart("services/new"),b.addPart("services/news"),b.addPart("services/inviteservicemanagers"),b.addPart("services/entityids"),b.addPart("services/modals/newEntitlementDialog"),a.useLoader("$translatePartialLoader",{urlTemplate:"lang/{lang}/{part}.json"}),a.fallbackLanguage("en"),a.preferredLanguage("en"),a.useCookieStorage()
}])}(),function(){"use strict";function a(a){a.decorator("$exceptionHandler",b)}function b(a,b,c){return function(d,e){a(d,e);var f=b.get("$http"),g=b.get("toastr"),h=(b.get("$rootScope"),b.get("profileService")),i=angular.toJson({fedid:h.getProfile().fedid,message:d.message,stack:d.stack,cause:e});f({method:"POST",url:c+"/log.php",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:"errorData="+i}).success(function(){g.info("Exception has been logged.")}).error(function(a){g.warning("Exception occured, but could not log because "+a)})}}a.$inject=["$provide"],b.$inject=["$delegate","$injector","baseUIAddr"],angular.module("hexaaApp.config").config(a)}(),function(){angular.module("hexaaApp.config").config(["toastrConfig",function(a){angular.extend(a,{positionClass:"toast-bottom-right",tapToDismiss:!0})}])}(),function(){"use strict";angular.module("hexaaApp.components.services.directives").directive("hexaaServicesEntitlementpackEditor",[function(){function a(a){function b(){vm.entitlementpack.undo()}function c(){void 0!==a.saveEntitlementpack&&a.saveEntitlementpack({entitlementpack:vm.entitlementpack})}a.save=c,a.undo=b}var b={entitlementpack:"=",service:"=",saveEntitlementpack:"&saveEntitlementpack"},c={restrict:"A",link:a,scope:b,templateUrl:"views/components/services/directives/hexaa-services-entitlementpack-editor-widget.html"};return c}])}(),function(){"use strict";angular.module("hexaaApp.shared.controllers.pages").controller("IndexCtrl",["$scope","cssInjector","$rootScope","themeService","events","settingsService","pageTitleService","profileService","dialogService",function(a,b,c,d,e,f,g,h,i){function j(){c.$on(e.siteThemeChanged,m),c.$on(e.onBadRequest,l),c.$on(e.onInternalServerError,k),d.apply(d.getTheme(f.get("selectedTheme")))}function k(){i.error("Internal Server Error!")}function l(a,b){null!==b&&void 0!==b.message&&i.error(b.message.toString())}function m(a,c){b.removeAll(),b.add(c.src),b.add("styles/6a0b0a6a.main.css")}a.Page=g,a.profile=h.getProfile(),j()}])}(),function(){"use strict";angular.module("hexaaApp.components.organizations.controllers.pages").controller("OrganizationsCtrl",["$scope","OrganizationsProxy","$route","$translate","events","dialogService","settingsService","$modal","pageTitleService",function(a,b,c,d,e,f,g,h,i){function j(b){a.selectedOrganization=b,void 0!=b&&(a.$broadcast(e.organizationsSelectionChanged,b.id),g.set("selectedOrganization",b.id))}function k(){a.$broadcast(e.organizationSave,g.get("selectedOrganization"))}function l(a){void 0!==a&&null!==a&&f.confirm(d.instant(w+"msg.confirmationNeeded"),d.instant(w+"msg.organizationDeleteConfirm",{name:a.name})).then(s(a))}function m(){a.$parent.page=c.current.params.page||"news",a.$on(e.organizationCanBeSaved,o),a.$on(e.organizationChanged,n),void 0==a.page&&(a.$parent.page="news"),b.getOrganizations().then(p)["catch"](q),i.setPageTitle(d.instant(w+"lbl.title"))}function n(b,c){var d=$linq(a.organizations).indexOf("x => x.id == "+c.id);angular.equals(a.organizations[d],c)||angular.copy(c,a.organizations[d])}function o(b,c){a.canBeSaved=c}function p(b){if(a.organizations=b.data.items,void 0!==c.current.params.id)var d=$linq(a.organizations).where("x=>x.id=="+c.current.params.id).singleOrDefault(void 0);else if(void 0!=g.get("selectedOrganization"))var d=$linq(a.organizations).where("x=>x.id=="+g.get("selectedOrganization")).singleOrDefault(void 0);void 0!==d?a.selectionChanged(d):a.openOrganizationChanger()}function q(a){f.error(d.instant(w+"msg.organizationsGetError")+a.data.message)}function r(b){return function(){f.success(d.instant(w+"msg.organizationDeleteSuccess")),a.organizations.removeAt($linq(a.organizations).indexOf("x => x.id == "+b.id)),a.navigate("#/")}}function s(a){return function(c){"yes"===c&&b.deleteOrganization(a).success(r(a)).error(function(a){f.error(d.instant(w+"msg.organizationDeleteError")+a.data.message)})}}function t(a){null!==a&&j(a)}function u(){null===a.selectedOrganization&&a.navigate("#/")}function v(){var b=h.open({templateUrl:"views/components/organizations/modals/organizationChangerDialog.html",controller:"OrganizationChangerController as vm",resolve:{organizations:function(){return a.organizations}}});b.result.then(t,u)}var w="organizations.index.";a.Page=i,a.canBeSaved=!0,a.organizations=[],a.selectedOrganization=null,a.selectionChanged=j,a.deleteOrganization=l,a.saveOrganization=k,a.openOrganizationChanger=v,m()}])}(),angular.module("hexaaApp.components.organizations.controllers.modals").controller("OrganizationNewDialogCtrl",["$scope","dialogService","$modalInstance","OrganizationsProxy","$translate",function(a,b,c,d,e){function f(){}function g(){k.organization.save().then(h)["catch"](i)}function h(){b.success(e.instant(l+"msg.organizationCreateSuccess")),c.close(k.organization)}function i(a){b.notifyUIError(a.data.errors),b.error(e.instant(l+"msg.organizationCreateError"))}function j(){c.dismiss("close")}var k=this,l="organizations.new.";k.save=g,k.close=j,k.organization=d["new"](),k.valid=!1,f()}]),function(){"use strict";angular.module("hexaaApp.components.organizations.controllers.pages").controller("OrganizationPrincipalManagement",["$scope","OrganizationsProxy","$translate","events","$modal","dialogService","pageTitleService","profileService",function(a,b,c,d,e,f,g,h){function i(a){a.id===y.profile.id?f.confirm(c.instant(x+"msg.confirmationNeeded"),c.instant(x+"msg.confirmRevokeSelf")).then(w(a)):f.confirm(c.instant(x+"msg.confirmationNeeded"),c.instant(x+"msg.confirmRevokeManager",{fedid:a.fedid})).then(w(a))}function j(a){b.addManager(y.organization.id,a.id).then(t(a))["catch"](u)}function k(a){a.id===y.profile.id?f.confirm(c.instant(x+"msg.confirmationNeeded"),c.instant(x+"msg.confirmRemoveSelf")).then(v(a)):f.confirm(c.instant(x+"msg.confirmationNeeded"),c.instant(x+"msg.confirmRemoveMember",{fedid:a.fedid})).then(v(a))}function l(){a.$emit(d.organizationCanBeSaved,!1),a.$on(d.organizationsSelectionChanged,m),g.setSubPageTitle(c.instant(x+"lbl.title")),y.profile=h.getProfile()}function m(a,c){y.organization={id:c},void 0!=c&&b.getPrincipals(c).then(o)["catch"](n)}function n(){f.error(c.instant(x+"msg.failedToRetrieveData"))}function o(a){y.organization.principals=angular.copy(a.data),y.organization.principals.saveMemento()}function p(a){return function(){f.success(c.instant(x+"msg.memberRemoveSuccess")),y.organization.principals=$linq(y.organization.principals).except(a,"(x,y) => x.id == y.id").toArray()}}function q(){f.error(c.instant(x+"msg.memberRemoveError"))}function r(a){return function(){f.success(c.instant(x+"msg.managerRevokeSuccess")),a.is_manager=!1}}function s(){f.error(c.instant(x+"msg.managerRevokeError"))}function t(a){return function(){f.success(c.instant(x+"msg.managerProposeSuccess")),a.is_manager=!0}}function u(){f.error(c.instant(x+"msg.managerProposeError"))}function v(a){return function(c){"yes"==c&&b.removeMember(y.organization.id,a.id).then(p(a))["catch"](q)}}function w(a){return function(c){"yes"==c&&b.removeManager(y.organization.id,a.id).then(r(a))["catch"](s)}}var x="organizations.principalmanagement.",y=this;y.organization={},y.profile={},y.revoke=i,y.propose=j,y.remove=k,l()}])}(),function(){"use strict";angular.module("hexaaApp.components.organizations.controllers.pages").controller("OrganizationPropertiesCtrl",["$scope","OrganizationsProxy","$translate","events","dialogService","pageTitleService","$q",function(a,b,c,d,e,f,g){function h(){a.$emit(d.organizationCanBeSaved,!0),a.$on(d.organizationsSelectionChanged,l),a.$on(d.organizationSave,o),f.setSubPageTitle(c.instant(p+"lbl.title"))}function i(){e.error(c.instant(p+"msg.organizationGetError"))}function j(){e.error(c.instant(p+"msg.organizationRoleGetError"))}function k(b){a.properties=angular.copy(b.organization.data),a.properties.roles=angular.copy(b.roles.data.items)}function l(a,c){void 0!==c&&g.all({organization:b.getOrganization(c)["catch"](i),roles:b.getRoles(c)["catch"](j)}).then(k)}function m(b){return function(){e.success(c.instant(p+"msg.organizationUpdateSuccess")),a.$emit(d.organizationChanged,b)}}function n(a){e.notifyUIError(a.data.errors),e.error(c.instant(p+"msg.organizationUpdateError"))}function o(b,c){a.organizationPropertiesForm.$valid&&void 0!==c&&a.properties.save().then(m(a.properties))["catch"](n)}var p="organizations.properties.";a.properties={},h()}])}(),function(){"use strict";angular.module("hexaaApp.components.organizations.controllers.pages").controller("OrganizationManagersCtrl",["$scope","OrganizationsProxy","PrincipalProxy","$cookies","$translate","events","dialogService","pageTitleService",function(a,b,c,d,e,f,g,h){function i(){a.$emit(f.organizationCanBeSaved,!0),a.$on(f.organizationsSelectionChanged,q),a.$on(f.organizationSave,j),a.profile.isAdmin&&c.getPrincipals().then(m)["catch"](n),h.setSubPageTitle(e.instant(r+"lbl.title"))}function j(c,d){-1!=a.organization.id&&void 0!=d&&b.updateManagers(a.organization).then(k)["catch"](l)}function k(){g.success(e.instant(r+"msg.managerUpdateSuccess"))}function l(){g.error(e.instant(r+"msg.managerUpdateFail")),a.organization.managers.restoreMemento()}function m(b){a.principals=angular.copy(b.data.items)}function n(){g.error(e.instant(r+"msg.principalsRetrieveError"))}function o(b){a.organization.managers=angular.copy(b.data.items),a.organization.managers.saveMemento()}function p(){g.error(e.instant(r+"msg.principalsRetrieveError"))}function q(c,d){a.organization={id:d},a.profile.isAdmin&&-1!=d&&a.profile.isManagerOfOrganization(d)?b.getManagers(d).then(o)["catch"](p):a.navigate("#/")}var r="organizations.managers.";a.organization={},i()}])}(),function(){"use strict";angular.module("hexaaApp.components.organizations.controllers.pages").controller("OrganizationMembersCtrl",["$scope","HexaaService","PrincipalProxy","$translate","events","OrganizationsProxy","dialogService","pageTitleService",function(a,b,c,d,e,f,g,h){function i(b,c){a.profile.isAdmin&&void 0!=c?(a.organization={id:c},f.getMembers(c).then(l)["catch"](k)):a.navigate("#/")}function j(){a.$on(e.organizationSave,q),a.$emit(e.organizationCanBeSaved,!0),a.$on(e.organizationsSelectionChanged,i),a.profile.isAdmin&&c.getPrincipals().then(n)["catch"](m),h.setSubPageTitle(d.instant(r+"lbl.title"))}function k(){g.error(d.instant(r+"msg.memberRetrieveError"))}function l(b){a.organization.members=angular.copy(b.data.items),a.organization.members.saveMemento()}function m(){g.error(d.instant(r+"msg.principalsRetrieveError"))}function n(b){a.principals=angular.copy(b.data.items)}function o(){g.success(d.instant(r+"msg.memberUpdateSuccess"))}function p(){g.error(d.instant(r+"msg.memberUpdateFail")),a.organization.members.restoreMemento()}function q(){f.updateMembers(a.organization).then(o)["catch"](p)}var r="organizations.members.";a.organization={},a.principals=[],j()}])}(),function(){"use strict";angular.module("hexaaApp.components.organizations.controllers.pages").controller("OrganizationNewsCtrl",["$scope","events","OrganizationsProxy","tags","dialogService","pageTitleService","$translate",function(a,b,c,d,e,f,g){function h(){a.tagSources.push({name:"<strong>Tags</strong>",multiSelectGroup:!0}),angular.forEach(d,function(a){this.push(a)},a.tagSources),a.tagSources.push({multiSelectGroup:!1})}function i(){h(),a.$watch("pager.currentPage",p),a.$watch("tagSources",o,!0),a.$watch("pager.itemPerPage",n),a.$on(b.organizationsSelectionChanged,m),a.$emit(b.organizationCanBeSaved,!1),f.setSubPageTitle(g.instant(q+"lbl.title"))}function j(b){if(void 0!==b.id){var d=$linq(a.tagSources).where("x=>x.ticked==true").select("x => x.name").toArray();c.getNews(b.id,(a.pager.currentPage-1)*a.pager.itemPerPage,a.pager.itemPerPage,d).then(l)["catch"](k)}}function k(a){e.error(a.data.message)}function l(b){a.organization.news=angular.copy(b.data.items),a.pager.totalItems=angular.copy(b.data.item_number)}function m(b,c){a.pager.currentPage=1,a.organization.id=c,a.organization.news.length=0,-1!=c&&j(a.organization)}function n(){-1!=a.organization.id&&j(a.organization)}function o(b,c){-1!=a.organization.id&&c!=b&&(a.pager.currentPage=1,j(a.organization))}function p(){-1!=a.organization.id&&j(a.organization)}var q="organizations.news.";a.organization={id:-1,news:[]},a.pager={itemPerPage:25,maxSize:5,totalItems:Number.MAX_VALUE,currentPage:1,numPages:0},a.tagSources=[],a.refreshFeed=j,i()}])}(),function(){"use strict";angular.module("hexaaApp.components.organizations.controllers.pages").controller("OrganizationRolesCtrl",["$scope","$window","$timeout","dialogService","OrganizationsProxy","$cookies","$q","$rootScope","$translate","events","$modal","RolesProxy","PrincipalProxy","pageTitleService","profileService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){a.$emit(j.organizationCanBeSaved,!1),a.$watch("vm.roleSources",r,!0),a.$on(j.organizationsSelectionChanged,z),n.setSubPageTitle(i.instant(M+"lbl.title"))}function q(a){N.roleSources=[],N.roleSources.push({name:"<strong>Roles</strong>",multiSelectGroup:!0}),angular.forEach(a,function(a){a.ticked=!0,this.push(a)},N.roleSources),N.roleSources.push({multiSelectGroup:!1})}function r(){-1!=N.organization.id&&(N.organization.roles=$linq(N.roleSources).where("x=>x.ticked==true").toArray())}function s(){var a=k.open({templateUrl:"views/components/organizations/modals/newRole.html",controller:"OrganizationsRolesNewCtrl",resolve:{targetOrganization:function(){return N.organization},targetRole:function(){return void 0}}});a.result.then(C,null)}function t(a,b){a.preventDefault(),a.stopPropagation(),N[b]=!0}function u(a){var b=k.open({templateUrl:"views/components/organizations/modals/newRole.html",controller:"OrganizationsRolesNewCtrl",resolve:{targetOrganization:function(){return N.organization},targetRole:function(){return a}}});b.result.then(v,w)}function v(a){a.save().then(J(a))["catch"](K)}function w(a){void 0!==a&&a.undo()}function x(a){d.confirm(i.instant(M+"msg.confirmationNeeded"),i.instant(M+"msg.roleDeleteConfirmation",{name:a.name})).then(function(b){"yes"==b&&a["delete"]().success(D(a)).error(E)})}function y(){e.getRoles(N.organization.id).then(F)}function z(a,b){void 0!=b&&(N.organization=e["new"]({id:b}),y(),e.getMembers(b).then(G),e.getEntitlements(b).then(H))}function A(a){a.undo()}function B(a){a.save().then(I(a))["catch"](L)}function C(a){N.saveRole(a)}function D(a){return function(){d.success(i.instant(M+"msg.roleRemoveSuccess")),N.organization.roles.splice($linq(N.organization.roles).indexOf("x=>x.id=="+a.id),1)}}function E(){d.error(i.instant(M+"msg.roleRemoveError"))}function F(a){N.organization.roles=angular.copy(a.data.items),q(a.data.items)}function G(a){N.organization.principals=angular.copy(a.data.items)}function H(a){N.organization.entitlements=angular.copy(a.data.items)}function I(a){return function(){d.success(i.instant(M+"msg.roleSaveSuccess")),N.organization.roles.push(l["new"](a))}}function J(a){return function(){var b=$linq(N.organization.roles).indexOf("x => x.id == "+a.id);N.organization.roles[b]=a,d.success(i.instant(M+"msg.roleUpdateSuccess"))}}function K(){d.error(i.instant(M+"msg.roleUpdateError"))}function L(){d.showMessage(i.instant(M+"msg.roleSaveError"))}var M="organizations.roles.",N=this;N.organization={id:-1},N.roleSources=[],N.principals=[],N.btnNewRole=s,N.open=t,N.editRole=u,N.deleteRole=x,N.undoRole=A,N.saveRole=B,N.profile=o.getProfile(),N.pager={itemPerPage:25,maxSize:5,totalItems:0,currentPage:1,numPages:0},p()}])}(),function(){"use strict";angular.module("hexaaApp.components.organizations.controllers.pages").controller("OrganizationsRolesNewCtrl",["$scope","$translate","$modalInstance","targetOrganization","RolesProxy","targetRole",function(a,b,c,d,e,f){function g(){}function h(){a.role.oid=a.organization.id,c.close(a.role)}function i(){c.dismiss("close")}function j(b,c){b.preventDefault(),b.stopPropagation(),a[c]=!0}a.role=angular.copy(f)||e["new"](),a.organization=d,a.saveRole=h,a.close=i,a.open=j,g()}])}(),function(){angular.module("hexaaApp.components.organizations.controllers.pages").controller("InviteOrganizationManagersCtrl",["$scope","$modal","dialogService","$translate","InvitationsProxy","baseUIAddr","events","OrganizationsProxy",function(a,b,c,d,e,f,g,h){function i(a){var c=b.open({templateUrl:"views/shared/modals/invitation.html",controller:"ModalInstanceCtrl",size:"lg",resolve:{unitName:function(){return a.name},principal:function(){return"manager"},roles:function(){return void 0},invitation:function(){return e["new"]({organization:a.id,as_manager:!0})}}});c.result.then(k)}function j(){a.$on(g.organizationsSelectionChanged,o)}function k(a){a.save().then(m)["catch"](l)}function l(){c.error(d.instant(p+"msg.invitationSendError"))}function m(){c.success(d.instant(p+"msg.invitationSendSuccess")),a.$emit(g.refreshOrganizationInvitations)}function n(b){a.organization=b.data}function o(a,b){void 0!=b&&h.getOrganization(b).then(n)}var p="organizations.inviteorgmanagers.";a.inviteManagers=i,j()}])}(),function(){angular.module("hexaaApp.components.organizations.controllers.pages").controller("InviteOrganizationMembersCtrl",["$scope","$modal","dialogService","OrganizationsProxy","$translate","InvitationsProxy","baseUIAddr","events",function(a,b,c,d,e,f,g,h){function i(a){var c=b.open({templateUrl:"views/shared/modals/invitation.html",controller:"ModalInstanceCtrl",size:"lg",resolve:{unitName:function(){return a.name},principal:function(){return"member"},roles:function(){return a.roles},invitation:function(){return f["new"]({role:a.default_role_id,organization:a.id})}}});c.result.then(m)}function j(){a.$on(h.organizationsSelectionChanged,p)}function k(){c.success(e.instant(q+"msg.invitationSendSuccess")),a.$emit(h.refreshOrganizationInvitations)}function l(){c.error(e.instant(q+"msg.invitationSendError"))}function m(a){a.save().then(k)["catch"](l)}function n(b){a.organization=angular.copy(b.data)}function o(b){a.organization.roles=angular.copy(b.data.items)}function p(b,c){a.organization={id:c},void 0!=c&&(d.getOrganization(c).then(n),d.getRoles(c).then(o))}var q="organizations.inviteorgmembers.";a.inviteMembers=i,j()}])}(),function(){"use strict";angular.module("hexaaApp.components.organizations.controllers.pages").controller("OrganizationEntitlementpacksCtrl",["$scope","EntitlementpacksProxy","OrganizationsProxy","$translate","events","dialogService","pageTitleService",function(a,b,c,d,e,f,g){function h(b){void 0!=b&&c.linkPrivateEntitlementpack(a.organization,b).then(s)["catch"](r)}function i(a){c.getEntitlementpacks(a.id).then(n(a))["catch"](o)}function j(){a.$emit(e.organizationCanBeSaved,!1),a.$on(e.organizationsSelectionChanged,m),g.setSubPageTitle(d.instant(t+"lbl.title"))}function k(a){f.confirm(d.instant(t+"msg.confirmationNeeded"),d.instant(t+"msg.entitlementpackDeleteConfirm",{name:a.name})).then(l(a))}function l(b){return function(d){"yes"===d&&c.removeEntitlementpack(a.organization.id,b.id).then(p(b))["catch"](q)}}function m(b,c){void 0!=c&&(a.organization={id:c},a.profile.isManagerOfOrganization(c)?i(a.organization):a.navigate("#/"))}function n(a){return function(b){a.entitlementpacks=b.data.items}}function o(){f.error(d.instant(t+"msg.organizationEntitlementpacksRetrieveError"))}function p(b){return function(){f.success(d.instant(t+"msg.entitlementpackRemoveSuccess")),a.organization.entitlementpacks.removeAt($linq(a.organization.entitlementpacks).indexOf("x=>x.id == "+b.id))}}function q(){f.error(d.instant(t+"msg.entilementpackRemoveError"))}function r(a){f.notifyUIError(a.data.errors),f.error(d.instant(t+"msg.tokenLinkError"))}function s(){f.success(d.instant(t+"msg.tokenLinkSuccessful")),i(a.organization),a.token=""}var t="organizations.entitlementpacks.";a.organization={},a.link=h,a.remove=k,j()}])}(),function(){"use strict";angular.module("hexaaApp.components.organizations.controllers.pages").controller("OrganizationAttributesCtrl",["$scope","dialogService","$translate","AttributeSpecificationsProxy","PrincipalProxy","events","OrganizationsProxy","pageTitleService","$modal",function(a,b,c,d,e,f,g,h,i){function j(){a.$emit(f.organizationCanBeSaved,!1),a.$on(f.organizationsSelectionChanged,k),h.setSubPageTitle(c.instant(C+"lbl.title"))}function k(b,c){void 0!=c&&(a.profile.isManagerOfOrganization(c)?(a.organization={id:c},g.getAttributeSpecifications(c).then(q)["catch"](B)):a.navigate("#/"))}function l(b,c){-1===c.id?(c.organizationId=a.organization.id,g.addAttributeValueOrganization(c).then(x(b,c))["catch"](y)):g.updateAttributeValueOrganization(c).then(z(b,c))["catch"](A)}function m(b){b.organization_id=a.organization.id,g.getAttributeValueOrganizations(b).then(v(b))["catch"](w(b)),d.getSupportingServices(b).then(t(b))["catch"](u)}function n(a,b){var c=b||{id:-1,is_default:!1,attribute_spec:{id:a.id},organization_id:a.organization_id,services:[],associatedServices:[]},d=i.open({templateUrl:"views/components/organizations/modals/attributeEditorDialog.html",controller:"OrganizationAttributeEditorDialogCtrl as vm",resolve:{targetAttribute:function(){return c},targetAttributeSpecification:function(){return a}}});d.result.then(o(a))}function o(a){return function(b){l(a,b)}}function p(a,b){g.deleteAttributeValueOrganization(b).then(s(a,b))["catch"](r)}function q(b){a.organization.attributeSpecifications=b.data.items}function r(a){b.showMessage(c.instant(C+"msg.problemOccured"),a.data.message.toString())}function s(a,d){return function(){b.success(c.instant(C+"msg.attributeValueChangesSaved"));var e=$linq(a).indexOf("x => x.id == "+d.id);a.values.splice(e,1),m(a)}}function t(a){return function(b){a.supportingServices=b.data.items}}function u(a){b.error(c.instant(C+"msg.supportingServicesGetError")+a.data.message)}function v(a){return function(b){a.values=b.data.items}}function w(a){return function(d){b.error(c.instant(C+"msg.attributeValueGetError",{attrspec:a.name})+d.data.message)}}function x(a,d){return function(){b.success(c.instant(C+"msg.attributeValueCreateSuccess")),a.values.push(d)}}function y(a){b.notifyUIError(a.data.errors),b.error(c.instant(C+"msg.attributeValueCreateError")+a.data.message)}function z(a,d){return function(){var e=$linq(a.values).indexOf("x => x.id == "+d.id);a.values[e]=d,b.success(c.instant(C+"msg.attributeValueUpdateSuccess"))}}function A(a){void 0!==a.data&&b.notifyUIError(a.data.errors),b.error(c.instant(C+"msg.attributeValueUpdateError"))}function B(a){b.error(c.instant(C+"msg.attributeSpecificationGetError")+a.data.message)}var C="organizations.attributes.";a.organization={},a.saveAttribute=l,a.newAttribute=n,a.load=m,a.removeAttribute=p,a.editAttribute=n,j()}])}(),function(){"use strict";angular.module("hexaaApp.components.organizations.controllers.pages").controller("OrganizationsInvitationsCtrl",["$scope","OrganizationsProxy","$modal","$translate","events","InvitationsProxy","dialogService","pageTitleService",function(a,b,c,d,e,f,g,h){function i(a){a.resend().success(v).error(w)}function j(a){g.confirm(d.instant(A+"msg.confirmationNeeded"),d.instant(A+"msg.invitationDeleteConfirmation")).then(z(a))}function k(a){1==a.emails.length&&""==a.emails[0]&&(a.emails=[]);var b=c.open({templateUrl:"views/shared/modals/invitation.html",controller:"ModalInstanceCtrl",size:"lg",resolve:{unitName:function(){return"Organization"},principal:function(){return"manager"},roles:function(){return B.organization.roles},invitation:function(){return angular.copy(a)}}});b.result.then(function(a){a.organization_id=B.organization.id,a.save().success(n(a)).error(o)})}function l(){a.$emit(e.organizationCanBeSaved,!1),a.$on(e.organizationsSelectionChanged,u),a.$on(e.refreshOrganizationInvitations,m),a.$watch("pager.currentPage",r),a.$watch("pager.itemPerPage",s),h.setSubPageTitle(d.instant(A+"lbl.title"))}function m(){u({},B.organization.id)}function n(a){return function(){g.success(d.instant(A+"msg.invitationUpdateSuccess"));var b=$linq(B.organization.invitations).indexOf("x => x.id == "+a.id);-1!==b&&(B.organization.invitations[b]=a)}}function o(){g.error(d.instant(A+"msg.invitationUpdateError"))}function p(a){B.organization.invitations=a.data.items,B.pager.totalItems=a.data.item_number}function q(){g.error(d.instant(A+"msg.invitationGetError"))}function r(){-1!=B.organization.id&&t()}function s(){-1!=B.organization.id&&t()}function t(){b.getInvitations(B.organization.id,B.pager).then(p)["catch"](q)}function u(a,b){void 0!=b&&(B.organization.id=b,t())}function v(){g.success(d.instant(A+"msg.invitationResendSuccess"))}function w(){g.error(d.instant(A+"msg.invitationResendError"))}function x(a){return function(){g.success(d.instant(A+"msg.invitationRemoveSuccess")),B.organization.invitations.splice($linq(B.organization.invitations).indexOf("x=>x.id=="+a.id),1),B.pager.totalItems--}}function y(){g.error(d.instant(A+"msg.invitationRemoveError"))}function z(a){return function(b){"yes"==b&&a["delete"]().success(x(a)).error(y)}}var A="organizations.invitations.",B=this;B.organization={id:-1,roles:[],invitations:[]},B.pager={itemPerPage:25,maxSize:5,totalItems:0,currentPage:1,numPages:0},B.edit=k,B.resend=i,B["delete"]=j,l()}])}(),function(){"use strict";angular.module("hexaaApp.components.organizations.controllers.pages").controller("OrganizationPublicCatalogCtrl",["$scope","EntitlementpacksProxy","OrganizationsProxy","events","$translate","$modal","dialogService","pageTitleService",function(a,b,c,d,e,f,g,h){function i(){a.$on(d.organizationsSelectionChanged,s),a.$emit(d.organizationCanBeSaved,!1),h.setSubPageTitle(e.instant(v+"lbl.title")),a.$watch("pager.currentPage",j),a.$watch("pager.itemPerPage",k)}function j(){-1!=w.organization.id&&b.getPublicEntitlementpacks(w.pager).then(o)}function k(){-1!=w.organization.id&&b.getPublicEntitlementpacks(w.pager).then(o)}function l(a){c.addEntitlementpack(w.organization,a).then(r(a))["catch"](u)}function m(a){c.deleteEntitlementpack(w.organization.id,a.id).then(q(a))["catch"](p)}function n(a){f.open({templateUrl:"views/components/services/modals/serviceDetails.html",controller:"ServiceDetailsCtrl",size:"lg",resolve:{serviceId:function(){return a}}})}function o(a){w.entitlementpacks=a.data.items,w.pager.totalItems=a.data.item_number}function p(){g.error(e.instant("organizations.public_catalog.msg.entitlementpackRemoveError"))}function q(a){return function(){var b=$linq(w.organization.entitlementpacks).indexOf("x=>x.id=="+a.id);w.organization.entitlementpacks.splice(b,1),g.success(e.instant("organizations.public_catalog.msg.entitlementpackRemoveSuccess"))}}function r(a){return function(){w.organization.entitlementpacks.push(a),g.success(e.instant("organizations.public_catalog.msg.entitlementpackAddSuccess"))}}function s(a,b){void 0!==b&&(w.organization={id:b},c.getEntitlementpacks(b).then(t))}function t(a){w.organization.entitlementpacks=a.data.items}function u(){g.error(e.instant("organizations.public_catalog.msg.entitlementpackAddError"))}var v="organizations.public_catalog.",w=this;w.entitlementpacks=[],w.organization={},w.showServiceDetails=n,w.add=l,w.remove=m,w.pager={itemPerPage:25,maxSize:5,totalItems:0,currentPage:1,numPages:0},i()}])}(),function(){"use strict";angular.module("hexaaApp.components.organizations.directives").directive("hexaaOrganizationsPropertiesWidget",function(){function a(a){function b(b){void 0!==a.formValid&&(a.formValid=b)}a.$watch("newOrganizationForm.$valid",b)}var b={organization:"=",formValid:"="},c={restrict:"A",link:a,scope:b,templateUrl:"views/components/organizations/directives/hexaa-organizations-properties-widget.html"};return c})}(),function(){"use strict";angular.module("hexaaApp.components.organizations.directives").directive("hexaaOrganizationsRoleEditorWidget",function(){function a(a){function b(){a.saveRole()}function c(){a.role.undo()}a.undo=c,a.save=b}var b={organization:"=",role:"=",saveRole:"&saveRole"},c={restrict:"A",link:a,scope:b,templateUrl:"views/components/organizations/directives/hexaa-organizations-role-editor-widget.html"};return c})}(),function(){"use strict";angular.module("hexaaApp.components.organizations.directives").directive("hexaaOrganizationsRoleWidget",["profileService",function(a){function b(b){function c(){b.profile=a.getProfile()}c()}var c={organization:"@",role:"="},d={restrict:"A",link:b,scope:c,templateUrl:"views/components/organizations/directives/hexaa-organizations-role-widget.html"};return d}])}(),function(){"use strict";angular.module("hexaaApp.components.organizations.directives").directive("hexaaOrganizationsRolesWidget",["profileService",function(a){function b(b){function c(){b.profile=a.getProfile()}function d(a){void 0!==b.deleteRole&&b.deleteRole({role:a})}function e(a){void 0!==b.editRole&&b.editRole({role:a})}c(),b["delete"]=d,b.edit=e}var c={filterBy:"=",pageBy:"=",organization:"=",deleteRole:"&deleteRole",editRole:"&editRole"},d={restrict:"A",link:b,scope:c,templateUrl:"views/components/organizations/directives/hexaa-organizations-roles-widget.html"};return d}])}(),function(){"use strict";angular.module("hexaaApp.components.organizations.directives").directive("hexaaOrganizationsUsersWidget",["profileService",function(a){function b(b){function c(){b.profile=a.getProfile()}function d(a){void 0!==b.revokePrincipal&&b.revokePrincipal({principal:a})}function e(a){void 0!==b.proposePrincipal&&b.proposePrincipal({principal:a})}function f(a){void 0!==b.removePrincipal&&b.removePrincipal({principal:a})}c(),b.revoke=d,b.propose=e,b.remove=f}var c={organization:"=",revokePrincipal:"&revokePrincipal",proposePrincipal:"&proposePrincipal",removePrincipal:"&removePrincipal",filterText:"="},d={restrict:"A",link:b,scope:c,templateUrl:"views/components/organizations/directives/hexaa-organizations-users-widget.html"};return d}])}(),function(){"use strict";angular.module("hexaaApp.components.organizations.directives").directive("hexaaOrganizationsInvitationsWidget",["profileService","baseUIAddr",function(a,b){function c(c){function d(){c.profile=a.getProfile()}function e(a){return void 0!==a?Object.keys(a).length:0}function f(a){void 0!==c.deleteInvitation&&c.deleteInvitation({invitation:a})}function g(a){void 0!==c.editInvitation&&c.editInvitation({invitation:a})}function h(a){void 0!==c.resendInvitation&&c.resendInvitation({invitation:a})}d(),c.baseUIAddr=b,c["delete"]=f,c.edit=g,c.resend=h,c.keyCount=e}var d={organization:"=",deleteInvitation:"&deleteInvitation",editInvitation:"&editInvitation",resendInvitation:"&resendInvitation"},e={restrict:"A",link:c,scope:d,templateUrl:"views/components/organizations/directives/hexaa-organizations-invitations-widget.html"};return e}])}(),function(){"use strict";angular.module("hexaaApp.components.organizations.directives").directive("hexaaOrganizationsInvitationbarWidget",["profileService","baseUIAddr",function(){function a(){}var b={organization:"="},c={restrict:"A",link:a,scope:b,templateUrl:"views/components/organizations/directives/hexaa-organizations-invitationbar-widget.html"};return c}])}(),function(){"use strict";angular.module("hexaaApp.components.organizations.directives").directive("hexaaOrganizationsEntitlementcatalogWidget",["profileService",function(){function a(a){function b(b){if(void 0!==a.organization.entitlementpacks&&void 0!==b){var c=$linq(a.organization.entitlementpacks).indexOf("x => x.id == "+b.id);return c>=0}return!1}function c(b){var c=$linq(a.organization.entitlementpacks).where("x=>x.id == "+b).singleOrDefault(null);return null!==c?c.status:null}function d(b){void 0!==a.addEntitlementpack&&a.addEntitlementpack({entitlementpack:b})}function e(b){void 0!==a.removeEntitlementpack&&a.removeEntitlementpack({entitlementpack:b})}function f(b){void 0!==a.showServiceDetails&&a.showServiceDetails({id:b})}a.isAttached=b,a.getStatus=c,a.add=d,a.remove=e,a.isAttached=b,a.getStatus=c,a.showService=f}var b={organization:"=",entitlementpacks:"=",showServiceDetails:"&showServiceDetails",addEntitlementpack:"&addEntitlementpack",removeEntitlementpack:"&removeEntitlementpack"},c={restrict:"A",link:a,scope:b,templateUrl:"views/components/organizations/directives/hexaa-organizations-entitlementcatalog-widget.html"};
return c}])}(),function(){"use strict";angular.module("hexaaApp.components.organizations.directives").directive("hexaaOrganizationsAttributeEditorWidget",[function(){function a(a){function b(){a.attribute.undo()}function c(){void 0!==a.saveAttribute&&a.saveAttribute({attribute:a.attribute})}a.undo=b,a.save=c}var b={attributeSpecification:"=",attribute:"=",saveAttribute:"&saveAttribute"},c={restrict:"A",link:a,scope:b,templateUrl:"views/components/organizations/directives/hexaa-organizations-attribute-editor-widget.html"};return c}])}(),function(){"use strict";angular.module("hexaaApp.components.profile.controllers.pages").controller("ProfileMyOrganizationsCtrl",["$scope","PrincipalProxy","pageTitleService","$translate","dialogService","$route",function(a,b,c,d,e,f){function g(){b.getMyOrganizations().then(h)["catch"](i),c.setSubPageTitle(d.instant(j+"lbl.title"))}function h(b){a.organizations=b.data.items}function i(){e.error(d.instant(j+"msg.getMyOrganizationsError"))}var j="profile.myorganizations.";a.organizations=[],a.lookuped_entitlement=f.current.params.entitlement_id,g()}])}(),function(){"use strict";angular.module("hexaaApp.components.profile.controllers.pages").controller("ProfileMyServicesCtrl",["$scope","PrincipalProxy","pageTitleService","$translate","dialogService","$route",function(a,b,c,d,e,f){function g(){b.getMyServices().then(function(b){a.services=b.data.items})["catch"](function(){e.error(d.instant(h+"msg.getMyServicesError"))}),c.setSubPageTitle(d.instant(h+"lbl.title"))}var h="profile.myservices.";a.services=[],a.lookuped_entitlement=f.current.params.entitlement_id,g()}])}(),function(){angular.module("hexaaApp.shared.controllers.modals").controller("ModalInstanceCtrl",["$scope","$interval","$modalInstance","unitName","principal","roles","invitation",function(a,b,c,d,e,f,g){function h(){a.invitation.emails=(a.invitation.emails||"").split(","),a.prop.useEmail?a.invitation.limit=void 0:a.invitation.emails=[],c.close(a.invitation)}function i(){c.dismiss("cancel")}function j(b,c){b.preventDefault(),b.stopPropagation(),a[c]=!0}function k(){void 0!==g?void 0!==a.invitation.emails&&a.invitation.emails.isArray&&(a.invitation.emails=g.emails.join(","),a.prop.useEmail=g.emails.length>0):a.invitation={}}a.unitName=d,a.principal=e,a.roles=f,a.invitation=angular.copy(g),a.prop={useEmail:!1},a.ok=h,a.cancel=i,a.open=j,k()}])}(),function(){"use strict";angular.module("hexaaApp.shared.controllers.modals").controller("ModalMessageCtrl",["$scope","$modalInstance","title","body",function(a,b,c,d){function e(){b.dismiss("close")}a.title=c,a.body=d,a.close=e}])}(),function(){angular.module("hexaaApp.shared.controllers.modals").controller("ConfirmationDialogCtrl",["$scope","$modalInstance","title","body",function(a,b,c,d){function e(a){b.close(a)}a.title=c,a.body=d,a.close=e}])}(),function(){angular.module("hexaaApp.components.organizations.controllers.modals").controller("OrganizationDetailsCtrl",["$scope","$modalInstance","organizationId","OrganizationsProxy","dialogService",function(a,b,c,d,e){function f(){b.dismiss("close")}function g(){d.getOrganization(c).then(h)["catch"](k)}function h(b){a.organization=b.data,d.getManagers(b.data.id).then(i)["catch"](j)}function i(b){a.organization.managers=b.data}function j(a){e.error(translate.instant(l+".msg.organizationManagersGetError")+a.data.message)}function k(a){e.error(translate.instant(l+".msg.organizationGetError")+a.data.message)}var l="modals.organizationDetails.";a.organization={},a.close=f,g()}])}(),function(){angular.module("hexaaApp.components.services.controllers.modals").controller("ServiceDetailsCtrl",["$scope","$modalInstance","serviceId","ServicesProxy","dialogService","$translate",function(a,b,c,d,e,f){function g(){b.dismiss("close")}function h(){d.getService(c).then(i)["catch"](j)}function i(b){a.service=b.data}function j(a){e.error(f.instant(k+"msg.getServiceError")+a.data.message)}var k="modals.serviceDetails.";a.service={},a.close=g,h()}])}(),function(){angular.module("hexaaApp.components.organizations.controllers.modals").controller("OrganizationChangerController",["$modalInstance","organizations",function(a,b){function c(){}function d(){a.dismiss()}function e(b){a.close(b)}var f=this;f.close=d,f.organizations=b,f.select=e,f.pager={itemPerPage:5,maxSize:5,totalItems:b.length,currentPage:1,numPages:0},c()}])}(),function(){"use strict";angular.module("hexaaApp.components.organizations.controllers.modals").controller("OrganizationAttributeEditorDialogCtrl",["$translate","$modalInstance","targetAttribute","targetAttributeSpecification",function(a,b,c,d){function e(){}function f(){b.dismiss()}function g(a){b.close(a)}var h=this;h.attribute=angular.copy(c),h.attributeSpecification=angular.copy(d),h.close=f,h.save=g,e()}])}(),function(){angular.module("hexaaApp.components.services.controllers.modals").controller("ServiceChangerController",["$modalInstance","services",function(a,b){function c(){}function d(){a.dismiss()}function e(b){a.close(b)}var f=this;f.close=d,f.services=b,f.select=e,f.pager={itemPerPage:5,maxSize:5,totalItems:b.length,currentPage:1,numPages:0},c()}])}(),function(){angular.module("hexaaApp.components.services.controllers.modals").controller("ServiceEntitlementNewCtrl",["$modalInstance","targetEntitlement","prefix","$scope",function(a,b,c){function d(a){return void 0!==a?a.replace(i.prefix,""):""}function e(){}function f(){a.dismiss()}function g(){a.close(i.entitlement)}function h(){i.entitlement.undo(),i.entitlement.uri=d(i.entitlement.uri)}var i=this;i.close=f,i.entitlement=angular.copy(b),i.save=g,i.prefix=c,i.undo=h,e()}])}(),function(){"use strict";angular.module("hexaaApp.components.services.controllers.pages").controller("ServicesCtrl",["$scope","ServicesProxy","$route","$translate","events","dialogService","$location","settingsService","$modal","pageTitleService",function(a,b,c,d,e,f,g,h,i,j){function k(){a.$parent.page=c.current.params.page||"news",a.$on(e.serviceCanBeSaved,l),a.$on(e.serviceChanged,x),b.getServices().then(r),j.setPageTitle(d.instant(B+"lbl.title"))}function l(b,c){a.canBeSaved=c}function m(){f.success(d.instant(B+"msg.serviceSPNotifySuccess"))}function n(){f.error(d.instant(B+"msg.serviceSPNotifyError"))}function o(a){return function(c){"close"!==c&&b.notifySP(a.id,c).then(m)["catch"](n)}}function p(a){return function(b){var c=i.open({templateUrl:"views/components/services/modals/entityIdContactDialog.html",controller:"EntityIdContactDialogController",resolve:{entityIds:function(){return b.data.items[a.entityid]}}});c.result.then(o(a))}}function q(a){b.getEntityIds().then(p(a))}function r(b){if(a.services=angular.copy(b.data.items),void 0!==c.current.params.id){var d=$linq(a.services).where("x=>x.id=="+c.current.params.id).singleOrDefault(void 0);a.selectionChanged(d)}else if(void 0!=h.get("selectedService")){var d=$linq(a.services).where("x=>x.id=="+h.get("selectedService")).singleOrDefault(void 0);a.selectionChanged(d)}else A()}function s(b){a.selectedService=b,null!==a.selectedService&&(h.set("selectedService",b.id),a.$broadcast(e.servicesSelectionChanged,b.id))}function t(a){void 0!=a&&f.confirm(d.instant(B+"msg.confirmationNeeded"),d.instant(B+"msg.serviceDeleteConfirm",{name:a.name})).then(w(a))}function u(b){return function(){f.success(d.instant(B+"msg.serviceDeleteSuccess")),h.set("selectedService",void 0);var c=$linq(a.services).indexOf("x=>x.id=="+b.id);a.services.removeAt(c),a.navigate("#/")}}function v(a){f.error(d.instant(B+"msg.serviceDeleteError")+a.data.message)}function w(a){return function(c){"yes"==c&&b.deleteService(a.id).then(u(a))["catch"](v)}}function x(b,c){var d=$linq(a.services).indexOf("x=>x.id == service.id");a.services[d]=c}function y(a){null!==a&&s(a)}function z(){null===a.selectedService&&a.navigate("#/")}function A(){var b=i.open({templateUrl:"views/components/services/modals/serviceChangerDialog.html",controller:"ServiceChangerController as vm",resolve:{services:function(){return a.services}}});b.result.then(y,z)}var B="services.index.";a.services=[],a.canBeSaved=!0,a.Page=j,a.selectedService=null,a.resendEntityIdAuth=q,a.selectionChanged=s,a.deleteService=t,a.openServiceChanger=A,k(),a.saveService=function(b){void 0!==b?a.$broadcast(e.serviceSave,b.id):a.$broadcast(e.serviceSave,-1)}}])}(),function(){"use strict";angular.module("hexaaApp.components.services.controllers.pages").controller("ServiceNewsCtrl",["$scope","$rootScope","$translate","events","ServicesProxy","tags","dialogService","pageTitleService",function(a,b,c,d,e,f,g,h){function i(){a.$emit(d.serviceCanBeSaved,!1),a.$watch("tagSources",n,!0),a.$watch("pager.currentPage",l),a.$watch("pager.itemPerPage",o),a.$on(d.servicesSelectionChanged,m),h.setSubPageTitle(c.instant(r+"lbl.title")),j()}function j(){a.tagSources.push({name:"<strong>Tags</strong>",multiSelectGroup:!0}),angular.forEach(f,function(a){this.push(a)},a.tagSources),a.tagSources.push({multiSelectGroup:!1})}function k(b){var c=$linq(a.tagSources).where("x=>x.ticked==true").toArray();e.getNews(b.id,(a.pager.currentPage-1)*a.pager.itemPerPage,a.pager.itemPerPage,c).then(p)["catch"](q)}function l(){-1!=a.service.id&&k(a.service)}function m(b,c){a.pager.currentPage=1,a.service.id=c,a.service.news.length=0,-1!=c&&k(a.service)}function n(){-1!=a.service.id&&(a.pager.currentPage=1,k(a.service))}function o(){-1!=a.service.id&&k(a.service)}function p(b){a.service.news=b.data.items,a.pager.totalItems=b.data.item_number}function q(a){void 0!==a.data&&void 0!==a.data.message&&g.error(a.data.message)}var r="organizations.news.";a.service={id:-1,news:[]},a.pager={itemPerPage:25,maxSize:5,totalItems:Number.MAX_VALUE,currentPage:1,numPages:0},a.tagSources=[],i()}])}(),function(){"use strict";angular.module("hexaaApp.components.services.controllers.pages").controller("ServicePropertiesCtrl",["$scope","ServicesProxy","$translate","events","$upload","baseAddr","securityService","$q","dialogService","pageTitleService",function(a,b,c,d,e,f,g,h,i,j){function k(){a.$emit(d.serviceCanBeSaved,!0),a.$on(d.servicesSelectionChanged,m),a.$on(d.serviceSave,n),b.getEntityIds().then(o),j.setSubPageTitle(c.instant(w+"lbl.title"))}function l(b){return e.upload({url:f+"/api/services/"+a.properties.id+"/logos.json",method:"POST",headers:{"X-HEXAA-AUTH":g.getToken()},file:b[0],fileFormDataName:"logo"}).progress(q)}function m(a,c){-1!=c&&b.getService(c).then(r)["catch"](s)}function n(b,c){if(a.servicePropertiesForm.$valid&&void 0!=c&&-1!=a.properties.id){var d=[];void 0!=a.service.logo&&d.push(l(a.service.logo)["catch"](t)),d.push(a.properties.save()["catch"](u)),h.all(d).then(v)}}function o(b){a.entityids=angular.copy(b.data.items)}function p(b){a.service.logo=b}function q(b){a.progress=parseInt(100*b.loaded/b.total)}function r(b){a.properties=angular.copy(b.data)}function s(){}function t(b){return a.progress=0,i.error(c.instant(w+"msg.serviceLogoUpdateError")),h.reject(b)}function u(a){return i.notifyUIError(a.data.errors),i.error(c.instant(w+"msg.serviceUpdateError")),h.reject(a)}function v(){a.progress=0,i.success(c.instant(w+"msg.serviceUpdateSuccess"))}var w="services.properties.";a.entityids=[],a.service={id:-1},a.progress=0,a.onFileSelect=p,k()}])}(),function(){"use strict";angular.module("hexaaApp.components.services.controllers.pages").controller("ServiceManagersCtrl",["$scope","ServicesProxy","$cookies","$translate","events","PrincipalProxy","dialogService","pageTitleService",function(a,b,c,d,e,f,g,h){function i(){a.$emit(e.serviceCanBeSaved,!0),a.$on(e.serviceSave,k),a.$on(e.servicesSelectionChanged,j),a.profile.isAdmin&&f.getPrincipals().then(l)["catch"](m),h.setSubPageTitle(d.instant(r+"lbl.title"))}function j(c,d){a.service={id:d},void 0!=d&&b.getManagers(d).then(n)["catch"](o)}function k(c,d){void 0!=d&&-1!=a.service.id&&b.updateManagers(a.service).success(p).error(q)}function l(b){a.principals=angular.copy(b.data.items)}function m(){}function n(b){a.service.managers=angular.copy(b.data.items),a.service.managers.saveMemento()}function o(){}function p(){g.success(d.instant(r+"msg.managerUpdated ")),a.service.managers.saveMemento()}function q(){g.error(d.instant(r+"msg.managerFailedToUpdate")),a.service.managers.restoreMemento()}var r="services.managers.";a.service={},a.principals=[],i()}])}(),function(){"use strict";angular.module("hexaaApp.components.services.controllers.pages").controller("ServiceAttributeSpecificationsCtrl",["$scope","AttributeSpecificationsProxy","$translate","events","ServicesProxy","dialogService","pageTitleService",function(a,b,c,d,e,f,g){function h(){a.private_attrspecs.restoreMemento(),angular.forEach(a.service.public_attrspecs,function(b){var c=$linq(a.private_attrspecs).indexOf("x=>x.id=="+b.id);a.private_attrspecs.removeAt(c)})}function i(){a.public_attrspecs.restoreMemento(),angular.forEach(a.service.private_attrspecs,function(b){var c=$linq(a.public_attrspecs).indexOf("x=>x.id=="+b.id);a.public_attrspecs.removeAt(c)}),a.$emit("refreshListBox_publicAttrSpecBox"),a.$emit("refreshListBox_privateAttrSpecBox")}function j(){a.$emit(d.serviceCanBeSaved,!0),a.$on(d.servicesSelectionChanged,n),a.$on(d.serviceSave,k),a.$watch("service.public_attrspecs",h),a.$watch("service.private_attrspecs",i),b.getAttributeSpecifications().then(l),g.setSubPageTitle(c.instant(q+"lbl.title"))}function k(b,c){-1!=a.service.id&&void 0!=c&&(angular.forEach(a.service.public_attrspecs,function(a){a.is_public=!0}),a.service.attrspecs=$linq(a.service.public_attrspecs).union(a.service.private_attrspecs).toArray(),e.updateAttributeSpecifications(a.service).then(o)["catch"](p))}function l(b){a.private_attrspecs=angular.copy(b.data.items),a.private_attrspecs.saveMemento(),a.public_attrspecs=angular.copy(b.data.items),a.public_attrspecs.saveMemento()}function m(b){void 0!=b.data&&(a.service.public_attrspecs=$linq(b.data.items).where("x=>x.is_public==true").select("x => x.attribute_spec").toArray(),a.service.public_attrspecs.saveMemento(),a.service.private_attrspecs=$linq(b.data.items).where("x=>x.is_public==false").select("x => x.attribute_spec").toArray(),a.service.private_attrspecs.saveMemento())}function n(b,c){a.service={id:c},void 0!=c&&e.getAttributeSpecifications(c).then(m)}function o(){f.success(c.instant(q+"msg.allChangesSaved"))}function p(){f.error(c.instant(q+"msg.AttributeSpecificationsUpdateError"))}var q="services.attributespecifications.";a.service={id:-1,public_attrspecs:[],private_attrspecs:[]},a.public_attrspecs=[],a.private_attrspecs=[],j()}])}(),function(){"use strict";angular.module("hexaaApp.components.services.controllers.pages").controller("ServiceNewCtrl",["$scope","HexaaService","$translate","$modalInstance","ServicesProxy","dialogService",function(a,b,c,d,e,f){function g(){e.getEntityIds().then(m)}function h(b){var c=$linq(a.selectedContacts).contains(b);c?a.selectedContacts.remove(b):a.selectedContacts.push(b)}function i(){a["new"].contacts=a.selectedContacts,a["new"].save().then(l)["catch"](k)}function j(){d.dismiss("close")}function k(a){f.error(c.instant(n+"msg.serviceCreateError")+a.data.message),f.notifyUIError(a.data.errors)}function l(){f.success(c.instant(n+"msg.serviceCreateSuccess")),d.close(a["new"])}function m(b){a.entityids=b.data.items}var n="services.new.";a.entityIdsPanel_collapse=!1,a.entityids=[],a["new"]=e["new"](),a.selectedContacts=[],a.select=h,a.save=i,a.close=j,g()}])}(),function(){"use strict";angular.module("hexaaApp.components.services.controllers.pages").controller("ServiceOwnerCtrl",["$scope","ServicesProxy","$translate","events","$upload","baseAddr","securityService","$q","dialogService","pageTitleService",function(a,b,c,d,e,f,g,h,i,j){function k(){a.$emit(d.serviceCanBeSaved,!0),a.$on(d.servicesSelectionChanged,n),a.$on(d.serviceSave,q),j.setSubPageTitle(c.instant(r+"lbl.title"))}function l(b){a.owner=angular.copy(b.data)}function m(){}function n(a,c){-1!=c&&b.getService(c).then(l)["catch"](m)}function o(){i.success(c.instant(r+"msg.ownerUpdateSuccess"))}function p(a){i.notifyUIError(a.data.errors),i.error(c.instant(r+"msg.ownerUpdateError")+a.data.message)}function q(c,d){void 0!=d&&a.ownerForm.$valid&&b.updateService(a.owner).then(o)["catch"](p)}var r="services.owner.";a.service={id:-1},k()}])}(),function(){"use strict";angular.module("hexaaApp.components.services.controllers.pages").controller("ServiceEntitlementsCtrl",["$scope","ServicesProxy","$translate","events","dialogService","EntitlementpacksProxy","ResourceEntity","pageTitleService","$modal",function(a,b,c,d,e,f,g,h,i){function j(){a.$emit(d.serviceCanBeSaved,!1),a.$on(d.servicesSelectionChanged,q),h.setSubPageTitle(c.instant(A+"lbl.title"))}function k(a){var b=a||g["new"]({id:-1}),c=i.open({templateUrl:"views/components/services/modals/newEntitlementDialog.html",controller:"ServiceEntitlementNewCtrl as vm",resolve:{targetEntitlement:function(){return b.uri=o(b.uri),b},prefix:function(){return B.prefix}}});c.result.then(l)}function l(a){p(a)}function m(a){e.confirm(c.instant(A+"msg.confirmationNeeded"),c.instant(A+"msg.entitlementDeleteConfirm",{name:a.name})).then(t(a))}function n(a){return void 0!==a?-1!==a.indexOf(B.prefix)?a:B.prefix+a:B.prefix}function o(a){return void 0!==a?a.replace(B.prefix,""):""}function p(a){-1!=B.service.id&&(a.uri=n(a.uri),-1==a.id?b.addEntitlement(B.service.id,a).then(u(a))["catch"](v(a)):b.updateEntitlement(a).then(w(a))["catch"](y(a)))}function q(a,c){void 0!=c&&(B.service={id:c},b.getEntitlements(c).then(x),f.getEntitlementPrefix().then(z))}function r(a){e.error(c.instant(A+"msg.entitlementpackUpdateError")+a.data.message)}function s(a){return function(){var b=$linq(B.service.entitlements).indexOf("x=>x.id == "+a.id);B.service.entitlements.removeAt(b)}}function t(a){return function(c){"yes"==c&&b.deleteEntitlement(a.id).then(s(a))["catch"](r)}}function u(a){return function(){a.commit(),e.success(c.instant(A+"msg.entitlementpackAddSuccess")),B.service.entitlements.push(a)}}function v(){return function(a){e.notifyUIError(a.data.errors),e.error(c.instant(A+"msg.entitlementpackAddError")+a.data.message)}}function w(a){return function(){a.commit(),e.success(c.instant(A+"msg.entitlementpackUpdateSuccess"));var b=$linq(B.service.entitlements).indexOf("x => x.id == "+a.id);-1!==b&&(B.service.entitlements[b]=a)}}function x(a){B.service.entitlements=angular.copy(a.data.items)}function y(){return function(a){e.notifyUIError(a.data.errors),e.error(c.instant(A+"msg.entitlementpackUpdateError")+a.data.message)}}function z(a){B.prefix=a.data.entitlement_base+":"+B.service.id+":"}var A="services.entitlements.",B=this;B.service={id:-1,entitlements:[]},B.newEntitlement=k,B.editEntitlement=k,B.deleteEntitlement=m,B.editEntitlement=k,B.save=p,j()}])}(),function(){"use strict";angular.module("hexaaApp.components.services.controllers.pages").controller("ServiceEntitlementpacksCtrl",["$scope","$window","$timeout","$cookies","$q","$rootScope","$translate","events","EntitlementpacksProxy","ServicesProxy","$modal","dialogService","pageTitleService",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){a.$emit(h.serviceCanBeSaved,!1),a.$on(h.servicesSelectionChanged,y),a.$watch("pager.itemPerPage",o),a.$watch("pager.currentPage",p),m.setSubPageTitle(g.instant(F+"lbl.title"))}function o(){x()}function p(){x()}function q(b){var c=k.open({templateUrl:"views/components/services/modals/newEntitlementpackDialog.html",controller:"ServicesEntitlementpacksNewCtrl as vm",resolve:{targetService:function(){return a.service},targetEntitlementpack:function(){return b||i["new"]({type:"private",id:-1,entitlements:[],service:{id:a.service.id}})}}});c.result.then(z)}function r(a){-1!=a.id&&l.confirm(g.instant(F+"msg.confirmationNeeded"),g.instant(F+"msg.entitlementpackDeleteConfirmation",{name:a.name})).then(C(a))}function s(a){i.generateToken(a.id).success(D(a)).error(E)}function t(){l.error(g.instant(F+"msg.entitlementpacksLoadError"))}function u(b){a.service.entitlementpacks=b.data.items,a.service.entitlementpacks.saveMemento(),a.pager.totalItems=b.data.item_number}function v(b){a.service.entitlements=b.data.items}function w(){l.error(g.instant(F+"msg.entitlementsRefreshError"))}function x(){-1!==a.service.id&&j.getEntitlementpacks(a.service.id,a.pager).then(u)["catch"](t)}function y(b,c){void 0!=a.selectedService&&(a.service={id:c},x(),j.getEntitlements(c).then(v)["catch"](w))}function z(b){var c=$linq(a.service.entitlementpacks).indexOf("x => x.id == "+b.id);-1===c?(a.service.entitlementpacks.push(b),a.pager.totalItems++):a.service.entitlementpacks[c]=b}function A(b){return function(){l.success(g.instant(F+"msg.entitlementpackRemoveSuccess"));var c=$linq(a.service.entitlementpacks).indexOf("x=>x.id == "+b.id);a.service.entitlementpacks.removeAt(c),a.service.entitlementpacks.saveMemento(),a.pager.totalItems--}}function B(a){l.error(g.instant(F+"msg.entitlementpackRemoveError")+a.message)}function C(a){return function(b){"yes"==b&&i.remove(a.id).success(A(a.id)).error(B)}}function D(a){return function(b){a.token=b.token}}function E(a){l.error(a.message)}var F="services.entitlementpacks.";a.service={id:-1,entitlementpacks:[]},a.pager={itemPerPage:5,maxSize:5,totalItems:0,currentPage:1,numPages:0},a.newEntitlementpack=q,a.removeEntitlementpack=r,a.generateToken=s,a.editEntitlementpack=q,n()}])}(),function(){angular.module("hexaaApp.components.services.controllers.pages").controller("InviteServiceManagersCtrl",["$scope","$modal","dialogService","ServicesProxy","$translate","InvitationsProxy","baseUIAddr","events",function(a,b,c,d,e,f,g,h){function i(){a.$on(h.servicesSelectionChanged,k)}function j(b){a.service=b.data}function k(a,b){void 0!=b&&d.getService(b).then(j)}function l(){c.success(e.instant(p+"msg.invitationSendSuccess")),a.$emit(h.refreshServiceInvitations)}function m(){c.error(e.instant(p+"msg.invitationSendError"))}function n(a){a.save().then(l)["catch"](m)}function o(a){var c=b.open({templateUrl:"views/shared/modals/invitation.html",controller:"ModalInstanceCtrl",size:"lg",resolve:{unitName:function(){return a.name},principal:function(){return"manager"},roles:function(){return a.roles},invitation:function(){return f["new"]({service:a.id,as_manager:!0})}}});c.result.then(n)}var p="services.inviteservicemanagers.";a.inviteManagers=o,i()}])}(),function(){"use strict";angular.module("hexaaApp.components.services.controllers.pages").controller("ServiceConnectedEntitlementpacksCtrl",["$scope","ServicesProxy","OrganizationsProxy","$translate","events","$modal","dialogService","pageTitleService",function(a,b,c,d,e,f,g,h){function i(){a.$emit(e.serviceCanBeSaved,!1),a.$on(e.servicesSelectionChanged,k),h.setSubPageTitle(d.instant(s+"lbl.title"))}function j(a){f.open({templateUrl:"views/components/organizations/modals/organizationDetails.html",controller:"OrganizationDetailsCtrl",size:"lg",resolve:{organizationId:function(){return a}}})}function k(c,d){a.service={id:d},void 0!=d&&b.getLinkedOrganizations(d).then(n)["catch"](o)}function l(a){g.confirm(d.instant(s+"msg.confirmationNeeded"),d.instant(s+"msg.connectionDeleteConfirmation")).then(r(a))}function m(a){b.acceptConnectionRequest(a.organization_id,a.entitlement_pack_id).success(function(){g.success(d.instant(s+"msg.connectionAcceptSuccess")),a.status="accepted"}).error(function(a){g.error(d.instant(s+"msg.connectionAcceptError")+a.message)})}function n(b){a.service.connections=angular.copy(b.data.items),a.service.connections.saveMemento(),a.pager.totalItems=b.data.length}function o(a){g.error(a.data.message)}function p(b){return function(){g.success(d.instant(s+"msg.connectionRemoveSuccess"));var c=$linq(a.service.connections).indexOf("x => (x.organization_id=="+b.organization_id+") && (x.entitlement_pack_id=="+b.entitlement_pack_id+")");a.service.connections.removeAt(c),a.pager.totalItems--}}function q(a){g.error(d.instant(s+"msg.connectionRemoveError")+a.message)}function r(a){return function(b){"yes"==b&&c.deleteEntitlementpack(a.organization_id,a.entitlement_pack_id).success(p(a)).error(q)}}var s="services.connectedpacks.";a.pager={itemPerPage:5,maxSize:5,totalItems:0,currentPage:1,numPages:0},a.service={id:-1,connections:[]},a.deleteConnection=l,a.showDetails=j,a.acceptConnection=m,i()}])}(),function(){"use strict";angular.module("hexaaApp.components.services.controllers.pages").controller("ServicesInvitationsCtrl",["$scope","$window","$timeout","InvitationsProxy","ServicesProxy","$cookies","$modal","$translate","events","dialogService","baseUIAddr","pageTitleService",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){a.$emit(i.serviceCanBeSaved,!1),a.$on(i.servicesSelectionChanged,y),a.$on(i.refreshServiceInvitations,t),a.$watch("pager.itemPerPage",o),a.$watch("pager.currentPage",p),l.setSubPageTitle(h.instant(F+"lbl.title"))}function n(){-1!==a.service.id&&e.getInvitations(a.service.id,a.pager).then(w)["catch"](x)}function o(){n()}function p(){n()}function q(a){a.resend().then(u)["catch"](v)}function r(a){j.confirm(h.instant(F+"msg.confirmationNeeded"),h.instant(F+"msg.invitationDeleteConfirmation")).then(B(a))}function s(a){1==a.emails.length&&""==a.emails[0]&&(a.emails=[]);var b=g.open({templateUrl:"views/shared/modals/invitation.html",controller:"ModalInstanceCtrl",size:"lg",resolve:{unitName:function(){return"Service"},principal:function(){return"manager"},roles:function(){return void 0},invitation:function(){return angular.copy(a)}}});b.result.then(E)}function t(){n()}function u(){j.success(h.instant(F+"msg.invitationResendSuccess"))}function v(){j.error(h.instant(F+"msg.invitationResendError"))}function w(b){a.service.invitations=$linq(b.data.items).orderByDescending("x => x.created_at").toArray(),a.pager.totalItems=b.data.item_number}function x(){j.error(h.instant(F+"msg.invitationsGetError"))}function y(b,c){void 0!=c&&(a.service={id:c},n())}function z(b){return function(){j.success(h.instant(F+"msg.invitationRemoveSuccess")),a.service.invitations.removeAt($linq(a.service.invitations).indexOf("x=>x.id=="+b.id)),a.pager.totalItems--}}function A(){j.error(h.instant(F+"msg.invitationRemoveError"))}function B(a){return function(b){"yes"==b&&a["delete"]().then(z(a))["catch"](A)}}function C(){j.success(h.instant(F+"msg.invitationUpdateSuccess")),a.$emit(i.refreshServiceInvitations)}function D(){j.error(h.instant(F+"msg.invitationUpdateError"))}function E(a){a.save().success(C).error(D)}var F="services.invitations.";a.baseUIAddr=k,a.service={id:-1},a.pager={itemPerPage:5,maxSize:5,totalItems:0,currentPage:1,numPages:0},a.resend=q,a["delete"]=r,a.edit=s,m(),a.keyCount=function(a){return void 0!==a?Object.keys(a).length:0}}])}(),function(){"use strict";angular.module("hexaaApp.components.services.controllers.pages").controller("ServicesEntitlementpacksNewCtrl",["$scope","$translate","$modalInstance","targetService","targetEntitlementpack","dialogService",function(a,b,c,d,e,f){function g(){c.dismiss()}function h(){k.entitlementpack.save().then(i(k.entitlementpack))["catch"](j(k.entitlementpack)),c.close(k.entitlementpack)}function i(a){return function(){f.success(b.instant(l+"msg.entitlementpackSaveSuccess")),a.commit()}}function j(){return function(a){f.notifyUIError(a.data.errors),f.error(b.instant(l+"msg.entitlementpackSaveError"))}}var k=this,l="services.modals.newEntitlementpackDialog.";k.service=angular.copy(d),k.entitlementpack=angular.copy(e),k.saveEntitlementpack=h,k.close=g}])}(),function(){"use strict";angular.module("hexaaApp.components.profile.controllers.pages").controller("ProfileCtrl",["$scope","$route","$translate","pageTitleService",function(a,b,c,d){function e(){a.$parent.page=b.current.params.page,void 0==a.page&&(a.$parent.page="news"),d.setPageTitle(c.instant(f+"lbl.title"))}var f="profile.index.";e()}])}(),function(){"use strict";angular.module("hexaaApp.components.profile.controllers.pages").controller("ProfileAttributesCtrl",["$scope","dialogService","$translate","AttributeSpecificationsProxy","PrincipalProxy","ResourceEntity","pageTitleService","$modal",function(a,b,c,d,e,f,g,h){function i(){e.getAttributeSpecifications().then(t),g.setSubPageTitle(c.instant(x+"lbl.title"))}function j(a){e.getAttributeValuePrincipals(a.id).then(s(a)),d.getSupportingServices(a).then(u(a))}function k(a,d){return function(){d.commit(),b.success(c.instant(x+"msg.attributeValuePrincipalCreateSuccess")),a.values.push(d)}}function l(a){b.notifyUIError(a.data.errors),b.error(c.instant(x+"msg.attributeValuePrincipalCreateError")+a.data.message)}function m(a,d){return function(){d.commit();var e=$linq(a.values).indexOf("x => x.id == "+d.id);a.values[e]=d,b.success(c.instant(x+"msg.attributeValuePrincipalUpdateSuccess"))}}function n(){return function(a){b.notifyUIError(a.data.errors),b.error(c.instant(x+"msg.attributeValuePrincipalUpdateError")+a.data.message)}}function o(a,b){-1==b.id?e.addAttributeValuePrincipal(b).then(k(a,b))["catch"](l):e.updateAttributeValuePrincipal(b).then(m(a,b))["catch"](n(b))}function p(a,b){var c=b||f["new"]({id:-1,is_default:!1,attribute_spec_id:a.id,services:[],associatedServices:[]}),d=h.open({templateUrl:"views/components/profile/modals/attributeEditorDialog.html",controller:"ProfileAttributeEditorDialogCtrl as vm",resolve:{targetAttribute:function(){return c},targetAttributeSpecification:function(){return a}}});d.result.then(q(a))}function q(a){return function(b){o(a,b)}}function r(a,b){e.deleteAttributeValuePrincipal(b.id).then(v(a,b))["catch"](w)}function s(a){return function(b){a.values=angular.copy(b.data.items)}}function t(b){a.profile.attributeSpecifications=angular.copy(b.data.items)}function u(a){return function(b){a.supportingServices=angular.copy(b.data.items)}}function v(a,d){return function(){var e=$linq(a.values).indexOf("x=> x.id == "+d.id);a.values.removeAt(e),b.success(c.instant(x+"msg.attributeValuePrincipalRemoveSuccess"))}}function w(a){b.showMessage(c.instant(x+"msg.problemOccured"),a.data.message)}var x="profile.attributes.";a.profile.attributeSpecifications=[],a.load=j,a.saveAttribute=o,a.newAttribute=p,a.removeAttribute=r,a.editAttribute=p,i()}])}(),function(){"use strict";angular.module("hexaaApp.components.profile.controllers.pages").controller("ProfileConsentsCtrl",["$scope","$translate","PrincipalProxy","ServicesProxy","ConsentsProxy","$q","dialogService","pageTitleService",function(a,b,c,d,e,f,g,h){function i(){c.getRelatedServices(a.pager).then(l),h.setSubPageTitle(b.instant(r+"lbl.title"))}function j(a){f.all([d.getAttributeSpecifications(a.id),c.getServiceConsent(a.id)]).then(q(a))}function k(a){var b={id:a.consentId,service:a.id,enabled_attribute_specs:$linq(a.consent).where("x=>x.consented").toArray().map(function(a){return a.id}),enable_entitlements:a.entitlements||!1};void 0===b.id?e.addConsent(b).success(m).error(n):e.updateConsent(b).then(o)["catch"](p)}function l(b){a.profile.relatedServices=angular.copy(b.data.items),a.pager.totalItems=angular.copy(b.data.item_number)}function m(){g.success(b.instant(r+"msg.consentAddSuccess"))}function n(a){g.error(b.instant(r+"msg.consentAddError")+a.data.message)}function o(){g.success(b.instant(r+"msg.consentUpdateSuccess"))}function p(a){g.error(b.instant(r+"msg.consentUpdateError")+a.data.message)}function q(a){return function(b){var c=b[0].data.items,d=b[1].data;a.consent=$linq(c).where("x=>x.attribute_spec.maintainer == 'user'").toArray().map(function(a){return a.attribute_spec.consented=-1!=$linq(d.enabled_attribute_spec_ids).indexOf("x => x == "+a.attribute_spec.id),a.attribute_spec}),a.entitlements=d.enable_entitlements,a.consentId=d.id}}var r="profile.consents.";a.pager={itemPerPage:5,maxSize:5,totalItems:0,currentPage:1,numPages:0},a.load=j,a.save=k,i()}])}(),function(){"use strict";angular.module("hexaaApp.components.profile.controllers.pages").controller("ProfileMeCtrl",["$scope","HexaaService","$translate","cssInjector","themeService","PrincipalProxy","dialogService","settingsService","pageTitleService",function(a,b,c,d,e,f,g,h,i){function j(){a.profile.lang=c.use(),a.themes=e.getThemes(),a.selectedTheme=h.get("selectedTheme"),i.setSubPageTitle(c.instant(p+".lbl.title"))
}function k(){c.use(a.profile.lang)}function l(){h.set("selectedTheme",a.selectedTheme),e.apply(e.getTheme(a.selectedTheme))}function m(){f.updatePrincipal(a.profile).then(o)["catch"](n)}function n(){g.error(c.instant(p+".msg.profileUpdateError"))}function o(){g.success(c.instant(p+".msg.profileUpdateSuccessful"))}var p="profile.me";a.languageChanged=k,a.themeSelectionChanged=l,a.change=m,j()}])}(),function(){"use strict";angular.module("hexaaApp.components.profile.controllers.pages").controller("ProfileLogoutCtrl",["$scope","profileService",function(a,b){function c(){b.logout()}c()}])}(),function(){"use strict";angular.module("hexaaApp.components.profile.controllers.pages").controller("ProfileNewsCtrl",["$scope","HexaaService","$translate","events","PrincipalProxy","ServicesProxy","OrganizationsProxy","tags","dialogService","pageTitleService",function(a,b,c,d,e,f,g,h,i,j){function k(){l(),a.$emit(d.organizationCanBeSaved,!1),f.getServices().then(m),g.getOrganizations().then(n),a.$watch("dataSources",p,!0),a.$watch("tagSources",p,!0),a.$watch("pager.currentPage",o),a.$watch("pager.itemPerPage",o),s(),j.setSubPageTitle(c.instant(t+"lbl.title"))}function l(){a.tagSources.push({name:"<strong>Tags</strong>",multiSelectGroup:!0}),angular.forEach(h,function(a){this.push(a)},a.tagSources),a.tagSources.push({multiSelectGroup:!1})}function m(b){a.dataSources.push({name:"<strong>Services</strong>",multiSelectGroup:!0}),angular.forEach(b.data.items,function(a){this.push({id:a.id,type:"service",name:a.name,ticked:!0})},a.dataSources),a.dataSources.push({multiSelectGroup:!1})}function n(b){a.dataSources.push({name:"<strong>Organizations</strong>",multiSelectGroup:!0}),angular.forEach(b.data.items,function(a){this.push({id:a.id,type:"organization",name:a.name,ticked:!0})},a.dataSources),a.dataSources.push({multiSelectGroup:!1})}function o(){var b=$linq(a.dataSources).where("x=>x.type=='organization' && x.ticked==true").select("x=>x.id").toArray(),c=$linq(a.dataSources).where("x=>x.type=='service' && x.ticked==true").select("x=>x.id").toArray();s(c,b)}function p(){var b=$linq(a.dataSources).where("x=>x.type=='organization' && x.ticked==true").select("x=>x.id").toArray(),c=$linq(a.dataSources).where("x=>x.type=='service' && x.ticked==true").select("x=>x.id").toArray();a.pager.currentPage=1,s(c,b)}function q(b){a.me.news=b.data.items,a.pager.totalItems=b.data.item_number}function r(a){i.error(a.message)}function s(b,c){var d=$linq(a.tagSources).where("x=>x.ticked==true").toArray();e.getNews((a.pager.currentPage-1)*a.pager.itemPerPage,a.pager.itemPerPage,d,b,c).then(q)["catch"](r)}var t="profile.news.";a.dataSources=[],a.me={news:[]},a.tagSources=[],a.pager={itemPerPage:5,maxSize:5,totalItems:Number.MAX_VALUE,currentPage:1,numPages:0},a.refreshFeed=s,k()}])}(),function(){"use strict";angular.module("hexaaApp.components.profile.controllers.pages").controller("ProfileDashboardCtrl",["$scope","ServicesProxy","OrganizationsProxy","$modal","pageTitleService","$translate","profileService",function(a,b,c,d,e,f,g){function h(){b.getServices().then(i),c.getOrganizations(j).then(j),e.setSubPageTitle(f.instant(o+"lbl.title"))}function i(b){a.dashboard.services=b.data.items}function j(b){a.dashboard.organizations=b.data.items}function k(b){a.dashboard.services.push(b),a.profile.addManagedService(b)}function l(){var a=d.open({templateUrl:"views/components/organizations/modals/new.html",controller:"OrganizationNewDialogCtrl as vm",resolve:{}});a.result.then(m)}function m(b){a.dashboard.organizations.push(b),a.profile.addManagedOrganization(b)}function n(){var a=d.open({templateUrl:"views/components/services/pages/new.html",controller:"ServiceNewCtrl",resolve:{}});a.result.then(k)}var o="profile.dashboard.";a.profile=g.getProfile(),a.dashboard={organizations:[],services:[],entityIdRequests:[]},a.newOrganization=l,a.newService=n,h()}])}(),function(){"use strict";angular.module("hexaaApp.components.profile.controllers.pages").controller("ProfileVOWizardCtrl",["$scope","pageTitleService","$translate","dialogService","EntitlementpacksProxy","OrganizationsProxy","$modal","InvitationsProxy","RolesProxy","$q","$location",function(a,b,c,d,e,f,g,h,i,j,k){function l(){Y.organization=f["new"](),e.getPublicEntitlementpacks().then(m)}function m(a){Y.entitlementpacks=angular.copy(a.data.items)}function n(a){Y.organization.entitlementpacks.push(a)}function o(a){var b=$linq(Y.organization.entitlementpacks).indexOf("x => x.id == "+a.id);Y.organization.entitlementpacks.removeAt(b)}function p(a){var b=g.open({templateUrl:"views/components/organizations/modals/newRole.html",controller:"OrganizationsRolesNewCtrl",resolve:{targetOrganization:function(){return Y.organization},targetRole:function(){return a}}});return b}function q(){p().result.then(r)}function r(a){a.id=Math.floor(1e3*Math.random()+1),Y.organization.roles.push(a)}function s(a){var b=$linq(Y.organization.roles).indexOf("x => x.id == "+a.id);Y.organization.roles[b]=a}function t(a){if(a.is_default===!0)d.warning("You can not delete the default role!");else{var b=$linq(Y.organization.roles).indexOf("x => x.id == "+a.id);Y.organization.roles.removeAt(b)}}function u(a){p(a).result.then(s)}function v(a,b,c){var d=g.open({templateUrl:"views/shared/modals/invitation.html",controller:"ModalInstanceCtrl",size:"lg",resolve:{unitName:function(){return Y.organization.name},principal:function(){return a?"manager":"member"},roles:function(){return c},invitation:function(){return b||h["new"]({organization:Y.organization.id,as_manager:a})}}});return d}function w(a){var b=$linq(Y.organization.invitations).indexOf("x => x.id == "+a.id);-1!==b&&Y.organization.invitations.removeAt(b)}function x(a){v(a.as_manager,a,Y.organization.roles).result.then(y)}function y(a){var b=$linq(Y.organization.invitations).indexOf("x => x.id == "+a.id);-1!==b&&(Y.organization.invitations[b]=a)}function z(){}function A(){v(!1,null,Y.organization.roles).result.then(C)}function B(){v(!0,null,Y.organization.roles).result.then(C)}function C(a){a.id=Math.floor(1e3*Math.random()+1),Y.organization.invitations.push(a)}function D(a){switch(a){case 1:return"danger";case 2:case 3:case 4:return"warning";default:return"success"}}function E(){var a=$linq(Y.organization.roles).indexOf("x => x.is_default === true");if(-1===a){var b=i["new"]();b.id=Math.floor(1e3*Math.random()+1),b.name=Y.organization.role.name,b.is_default=!0,Y.organization.roles.push(b)}else Y.organization.roles[a].name=Y.organization.role.name}function F(){null!==Y.organization.name&&null!==Y.organization.role.name&&H(++Y.currentStep)}function G(){Y.currentStep>1&&H(--Y.currentStep)}function H(a){Y.organizationIsValid?Y.currentStep=a:(d.warning("First you must create an organization!"),Y.currentStep=X.createVO),E()}function I(a){return function(){d.success(c.instant(W+"msg.entitlementpackAddSuccess",{entitlementpack:a.name}))}}function J(a){return function(b){return d.error(c.instant(W+"msg.entitlementpackAddError",{entitlementpack:a.name})),Y.currentStep=X.attachService,j.reject(b)}}function K(a){return function(){d.success(c.instant(W+"msg.invitationAddSuccess",{invitation:a.message}))}}function L(a){return function(b){return d.error(c.instant(W+"msg.invitationAddError",{invitation:a.message})),Y.currentStep=X.inviteMembers,j.reject(b)}}function M(a,b){return function(){d.success(c.instant(W+"msg.roleAddSuccess",{role:a.name})),void 0!==b&&angular.forEach(b,function(b){var c=$linq(Y.organization.invitations).indexOf("x => x.id == "+b.id);-1!==c&&(Y.organization.invitations[c].role=parseInt(a.id))})}}function N(a){return function(b){return d.error(c.instant(W+"msg.roleAddError",{role:a.name})),Y.currentStep=X.createRoles,j.reject(b)}}function O(){return j.all(Y.organization.roles.map(function(a){var b=$linq(Y.organization.invitations).where("x => x.role == "+a.id).toArray();return a.is_default===!1?i.createRole(Y.organization.id,a).then(M(a,b),N(a)):(a.id=parseInt(Y.organization.default_role),i.updateRole(a).then(M(a,b),N(a)))}))}function P(){return j.all(Y.organization.invitations.map(function(a){return a.id=void 0,a.organization=parseInt(Y.organization.id),h.invite(a).then(K(a),L(a))}))}function Q(){j.all(Y.organization.entitlements.map(function(a){return f.addEntitlementpack(Y.organization,a).then(I(a))["catch"](J(a))}))}function R(){d.success(c.instant(W+"msg.organizationAddSuccess",{organization:Y.organization.name})),Q(),O().then(T)}function S(){var a="/organizations/"+Y.organization.id+"/news";k.path(a)}function T(){P().then(S)}function U(a){Y.currentStep=X.createVO,d.notifyUIError(a.data.errors)}function V(){Y.organization.save().then(R,U)}var W="profile.vowizard.",X=Object.freeze({createVO:1,attachService:2,createRoles:3,inviteMembers:4,finish:5}),Y=this;Y.currentStep=1,Y.numberOfSteps=5,Y.next=F,Y.previous=G,Y.select=H,Y.getProgressbarType=D,Y.entitlementpacks=[],Y.organizationIsValid=!1,Y.addEntitlementpack=n,Y.removeEntitlementpack=o,Y.editRole=u,Y.deleteRole=t,Y.newRole=q,Y.newMember=A,Y.newManager=B,Y.editInvitation=x,Y.resendInvitation=z,Y.deleteInvitation=w,Y.finish=V,l()}])}(),function(){"use strict";angular.module("hexaaApp.components.profile.controllers.modals").controller("ProfileAttributeEditorDialogCtrl",["$scope","$translate","$modalInstance","targetAttribute","targetAttributeSpecification","PrincipalProxy",function(a,b,c,d,e){function f(){}function g(){c.dismiss()}function h(a){c.close(a)}var i=this;i.attribute=angular.copy(d),i.attributeSpecification=angular.copy(e),i.close=g,i.save=h,f()}])}(),function(){"use strict";angular.module("hexaaApp.components.profile.directives").directive("hexaaProfileAttributeEditorWidget",[function(){function a(a){function b(){a.attribute.undo()}function c(){void 0!==a.saveAttribute&&a.saveAttribute({attribute:a.attribute})}a.undo=b,a.save=c}var b={attributeSpecification:"=",attribute:"=",saveAttribute:"&saveAttribute"},c={restrict:"A",link:a,scope:b,templateUrl:"views/components/profile/directives/hexaa-profile-attribute-editor-widget.html"};return c}])}(),function(){"use strict";angular.module("hexaaApp.components.admin.directives").directive("hexaaAdminAttributespecificationEditorWidget",[function(){function a(a){function b(){void 0!==a.saveAttributeSpecification&&a.saveAttributeSpecification()}a.save=b}var b={attributeSpecification:"=",saveAttributeSpecification:"&saveAttributeSpecification"},c={restrict:"A",link:a,scope:b,templateUrl:"views/components/admin/directives/hexaa-admin-attributespecification-editor-widget.html"};return c}])}(),function(){"use strict";angular.module("hexaaApp.components.admin.directives").directive("hexaaAdminPrincipalEditorWidget",[function(){function a(a){function b(){void 0!==a.savePrincipal&&a.savePrincipal(a.principal)}a.save=b}var b={principal:"=",savePrincipal:"&savePrincipal"},c={restrict:"A",link:a,scope:b,templateUrl:"views/components/admin/directives/hexaa-admin-principal-editor-widget.html"};return c}])}(),function(){"use strict";angular.module("hexaaApp.components.admin.controllers.pages").controller("AdminCtrl",["$scope","$route","pageTitleService","$translate",function(a,b,c,d){function e(){void 0==a.page&&(a.page="attributespecifications"),a.profile.isAdmin||a.navigate("index.html"),c.setPageTitle(d.instant(f+"lbl.title"))}var f="admin.index.";a.page=b.current.params.page,e()}])}(),function(){"use strict";angular.module("hexaaApp.components.admin.controllers.pages").controller("AdminAttributeSpecificationsCtrl",["$scope","AttributeSpecificationsProxy","$translate","dialogService","$modal","pageTitleService",function(a,b,c,d,e,f){function g(a){var c=e.open({templateUrl:"views/components/admin/modals/newAttrspecDialog.html",controller:"AdminNewAttributeSpecificationDialogCtrl as vm",resolve:{targetAttributeSpecification:function(){return a||b["new"]()}}});c.result.then(k)}function h(a){d.confirm(c.instant(q+"msg.confirmationNeeded"),c.instant(q+"msg.attributeSpecificationDeleteConfirm",{name:a.name})).then(n(a))}function i(){b.getAttributeSpecifications(r.pager).then(o)["catch"](p),a.$watch("vm.pager.currentPage",j),a.$watch("vm.pager.itemPerPage",j),f.setSubPageTitle(c.instant(q+"lbl.title"))}function j(a,c){c!==a&&b.getAttributeSpecifications(r.pager).then(o)["catch"](p)}function k(a){if(-1===a.id)r.attrspecs.push(a);else{var b=$linq(r.attrspecs).indexOf("x => x.id == "+a.id);-1!==b&&(r.attrspecs[b]=a)}}function l(a){return function(){d.success(c.instant(q+"msg.attributeSpecificationDeleteSuccess")),r.attrspecs.splice($linq(r.attrspecs).indexOf("x=>x.id=="+a.id),1)}}function m(){d.error(c.instant(q+"msg.attributeSpecificationDeleteError"))}function n(a){return function(b){"yes"==b&&a["delete"]().then(l(a))["catch"](m)}}function o(a){r.attrspecs=a.data.items,r.pager.totalItems=a.data.item_number}function p(){d.error(c.instant(q+"msg.attributeSpecificationGetError"))}var q="admin.attributespecifications.",r=this;r.attrspecs=[],r.pager={itemPerPage:25,maxSize:5,totalItems:0,currentPage:1,numPages:0},r.edit=g,r["delete"]=h,r["new"]=g,i()}])}(),function(){"use strict";angular.module("hexaaApp.components.admin.controllers.modals").controller("AdminNewAttributeSpecificationDialogCtrl",["$translate","dialogService","$modalInstance","targetAttributeSpecification",function(a,b,c,d){function e(){k.attrspec=angular.copy(d)}function f(){k.attrspec.save().then(g)["catch"](h)}function g(){b.success(a.instant(j+"msg.attributeSpecificationUpdateSuccess")),c.close(k.attrspec)}function h(c){b.notifyUIError(c.data.errors),b.error(a.instant(j+"msg.attributeSpecificationUpdateError"))}function i(){c.dismiss()}var j="admin.modals.newAttrspecDialog.",k=this;k.save=f,k.close=i,e()}])}(),function(){"use strict";angular.module("hexaaApp.components.admin.controllers.modals").controller("AdminNewPrincipalDialogCtrl",["$translate","dialogService","$modalInstance","targetPrincipal",function(a,b,c,d){function e(){k.principal=angular.copy(d)}function f(){k.principal.save().success(g(k.principal)).error(h(k.principal))}function g(d){return function(){b.success(-1==d.id?a.instant(j+"msg.principalCreateSuccess"):a.instant(j+"msg.principalUpdateSuccess")),c.close(d)}}function h(c){return function(d){b.notifyUIError(d.errors),b.error(-1==c.id?a.instant(j+"msg.principalCreateError"):a.instant(j+"msg.principalUpdateError"))}}function i(){c.dismiss()}var j="admin.modals.newPrincipalDialog.",k=this;k.save=f,k.close=i,e()}])}(),function(){"use strict";angular.module("hexaaApp.components.admin.controllers.pages").controller("AdminPrincipalsCtrl",["PrincipalProxy","$translate","dialogService","$modal","pageTitleService",function(a,b,c,d,e){function f(b){var c=d.open({templateUrl:"views/components/admin/modals/newPrincipalDialog.html",controller:"AdminNewPrincipalDialogCtrl as vm",resolve:{targetPrincipal:function(){return b||a["new"]()}}});c.result.then(g)}function g(a){var b=$linq(o.principals).indexOf("x => x.id == "+a.id);-1===b?o.principals.push(a):o.principals[b]=a}function h(a){c.confirm(b.instant(n+"msg.confirmationNeeded"),b.instant(n+"msg.principalDeleteConfirm",{fedid:a.fedid})).then(function(b){"yes"==b&&a["delete"]().success(j(a)).error(k)})}function i(){a.getPrincipals().then(l)["catch"](m),e.setSubPageTitle(b.instant(n+"lbl.title"))}function j(a){return function(){c.success(b.instant(n+"msg.principalDeleteSuccess")),o.principals.splice($linq(o.principals).indexOf("x=>x.id=="+a.id),1)}}function k(){c.error(b.instant(n+"msg.principalDeleteError"))}function l(a){o.principals=a.data.items,o.pager.totalItems=a.data.items.length}function m(){c.error(b.instant(n+"msg.principalGetError"))}var n="admin.principals.",o=this;o.principals=[],o.pager={itemPerPage:25,maxSize:5,totalItems:0,currentPage:1,numPages:0},o.deletePrincipal=h,o.newPrincipal=f,o.edit=f,i()}])}(),function(){"use strict";angular.module("hexaaApp.components.admin.controllers.pages").controller("AdminEntityIdsCtrl",["$translate","ServicesProxy","dialogService","pageTitleService",function(a,b,c,d){function e(){b.getEntityIds().then(f)["catch"](g),d.setSubPageTitle(a.instant(h+"lbl.title"))}function f(a){for(var b in a.data.items)i.entityids.push({key:b,value:a.data.items[b]});i.pager.totalItems=a.data.items.length}function g(){c.error(a.instant(h+"msg.entityIdsGetError"))}var h="admin.entityids.",i=this;i.entityids=[],i.pager={itemPerPage:5,maxSize:5,totalItems:0,currentPage:1,numPages:0},e()}])}(),angular.module("hexaaApp.services").factory("HexaaService",["$http","$rootScope","$q","apiAddr",function(a,b,c,d){function e(b,c,e,f,h){var i=new QueryStringBuilder(c);return i.set("admin",g),console.log(b+" "+i.toString()+" "+f),a({method:b,url:d+i.toString(),headers:{"X-HEXAA-AUTH":e},data:f,tag:h})}var f="token",g=!1,h={doRequest:e};return{getServices:function(){return h.doRequest("GET","/services.json?offset=0",f,null)},getService:function(a){return h.doRequest("GET","/services/"+a+".json",f,null)},addService:function(a,b,c,d,e,g,i,j,k,l){var m=new Jobject;return m.prop("name",a),m.prop("url",b),m.prop("entityid",c),m.prop("description",d),m.prop("org_name",e),m.prop("org_short_name",g),m.prop("org_url",i),m.prop("org_description",j),m.prop("priv_url",k),m.prop("priv_description",l),h.doRequest("POST","/services.json",f,JSON.stringify(m))},updateService:function(a,b,c,d,e,g,i,j,k,l,m){var n=new Jobject;return n.prop("name",b),n.prop("description",e),n.prop("url",c),n.prop("entityid",d),n.prop("org_name",g),n.prop("org_short_name",i),n.prop("org_url",j),n.prop("org_description",k),n.prop("priv_url",l),n.prop("priv_description",m),h.doRequest("PUT","/services/"+a+".json",f,JSON.stringify(n))},deleteService:function(a){return h.doRequest("DELETE","/services/"+a+".json",f,null)},getOrganizations:function(){return h.doRequest("GET","/organizations.json?offset=0",f,null)},getOrganization:function(a,b){return h.doRequest("GET","/organizations/"+a+".json",f,null,b)},addOrganization:function(a,b,c){var d=new Jobject;return d.prop("name",a),d.prop("description",b),d.prop("url",c),h.doRequest("POST","/organizations.json",f,JSON.stringify(d))},deleteOrganization:function(a){return h.doRequest("DELETE","/organizations/"+a+".json",f,null)},updateOrganization:function(a,b,c,d,e){var g=new Jobject;return g.prop("name",b),g.prop("description",c),g.prop("url",d),g.prop("default_role",e),h.doRequest("PUT","/organizations/"+a+".json",f,JSON.stringify(g))},getPrincipals:function(){return h.doRequest("GET","/principals.json?offset=0",f,null)},getManagersOfOrganization:function(a){return h.doRequest("GET","/organizations/"+a+"/managers.json?offset=0",f,null)},addManagerToOrganization:function(a,b){return h.doRequest("PUT","/organizations/"+a+"/managers/"+b+".json",f,null)},deleteManagerFromOrganization:function(a,b){return h.doRequest("DELETE","/organizations/"+a+"/managers/"+b+".json",f,null)},getMembersOfOrganization:function(a){return h.doRequest("GET","/organizations/"+a+"/members.json?offset=0",f,null)},addMemberToOrganization:function(a,b){return h.doRequest("PUT","/organizations/"+a+"/members/"+b+".json",f,null)},deleteMemberFromOrganization:function(a,b){return h.doRequest("DELETE","/organizations/"+a+"/members/"+b+".json",f,null)},getManagersOfService:function(a){return h.doRequest("GET","/services/"+a+"/managers.json?offset=0",f,null)},addManagerToService:function(a,b){return h.doRequest("PUT","/services/"+a+"/managers/"+b+".json",f,null)},deleteManagerFromService:function(a,b){return h.doRequest("DELETE","/services/"+a+"/managers/"+b+".json",f,null)},getEntityIds:function(){return h.doRequest("GET","/entityids.json?offset=0",f,null)},getAttributeSpecifications:function(a,b){var c=new QueryStringBuilder("/attributespecs.json").set("offset",a||0).set("limit",b);return h.doRequest("GET",c.toString(),f,null)},deleteAttributeSpecification:function(a){return h.doRequest("DELETE","/attributespecs/"+a+".json",f,null)},getAttributeSpecification:function(a){return h.doRequest("GET","/attributespecs/"+a+".json",f,null)},updateAttributeSpecification:function(a,b,c,d,e,g,i){var j=new Jobject;return j.prop("uri",b),j.prop("description",e),j.prop("maintainer",d),j.prop("syntax",g),j.prop("is_multivalue",i),j.prop("name",c),h.doRequest("PUT","/attributespecs/"+a+".json",f,JSON.stringify(j))},addAttributeSpecification:function(a,b,c,d,e,g){var i=new Jobject;return i.prop("uri",a),i.prop("description",d),i.prop("maintainer",c),i.prop("syntax",e),i.prop("is_multivalue",g),i.prop("name",b),h.doRequest("POST","/attributespecs.json",f,JSON.stringify(i))},getServiceAttributeSpecifications:function(a,b){return h.doRequest("GET","/services/"+a+"/attributespecs.json?verbose=expanded&offset=0",f,null,b)},addServiceAttributeSpecification:function(a,b,c){var d=new Jobject;return d.prop("is_public",c),h.doRequest("PUT","/services/"+a+"/attributespecs/"+b+".json",f,JSON.stringify(d))},deleteServiceAttributeSpecification:function(a,b){return h.doRequest("DELETE","/services/"+a+"/attributespecs/"+b+".json",f,null)},getPrincipalAttributeSpecifications:function(){return h.doRequest("GET","/principal/attributespecs.json?verbose=expanded&offset=0",f,null)},getPrincipalAttributeValues:function(){return h.doRequest("GET","/principal/attributevalueprincipal.json?offset=0",f,null)},getPrincipal:function(){return h.doRequest("GET","/principal/self.json",f,null)},deleteAttributeValuePrincipal:function(a){return h.doRequest("DELETE","/attributevalueprincipals/"+a+".json",f,null)},updateAttributeValuePrincipal:function(a,b,c,d){var e=new Jobject;return e.prop("value",c),e.prop("attribute_spec",b),e.prop("services",d),h.doRequest("PUT","/attributevalueprincipals/"+a+".json",f,JSON.stringify(e))},addAttributeValuePrincipal:function(a,b,c){var d=new Jobject;return d.prop("value",b),d.prop("attribute_spec",a),d.prop("services",c),h.doRequest("POST","/attributevalueprincipals.json",f,angular.toJson(d))},getOrganizationRoles:function(a,b,c){var d=new QueryStringBuilder("/organizations/"+a+"/roles.json").set("verbose","expanded").set("offset",b||0).set("limit",c);return h.doRequest("GET",d.toString(),f,null)},addRoleToOrganization:function(a,b,c,d,e){var g=new Jobject;return g.prop("name",b),g.prop("description",c),g.prop("start_date",d),g.prop("end_date",e),h.doRequest("POST","/organizations/"+a+"/roles.json",f,JSON.stringify(g))},updateRole:function(a,b,c,d,e){var g=new Jobject;return g.prop("name",b),g.prop("description",c),g.prop("start_date",d),g.prop("end_date",e),h.doRequest("PUT","/roles/"+a+".json",f,JSON.stringify(g))},deleteRole:function(a){return h.doRequest("DELETE","/roles/"+a+".json",f,null)},getServiceEntitlements:function(a){return h.doRequest("GET","/services/"+a+"/entitlements.json?offset=0",f,null)},addServiceEntitlement:function(a,b,c,d){var e=(new Jobject).prop("name",c).prop("uri",b).prop("description",d);return h.doRequest("POST","/services/"+a+"/entitlements.json",f,JSON.stringify(e))},updateEntitlement:function(a,b,c,d){var e=new Jobject;return e.prop("name",c),e.prop("uri",b),e.prop("description",d),h.doRequest("PUT","/entitlements/"+a+".json",f,JSON.stringify(e))},deleteEntitlement:function(a){return h.doRequest("DELETE","/entitlements/"+a+".json",f,null)},addServiceEntitlementPack:function(a,b,c,d){var e=new Jobject;return e.prop("name",b),e.prop("description",c),e.prop("type",d),h.doRequest("POST","/services/"+a+"/entitlementpacks.json",f,JSON.stringify(e))},updateEntitlementPack:function(a,b,c,d){var e=new Jobject;return e.prop("name",b),e.prop("description",c),e.prop("type",d),h.doRequest("PUT","/entitlementpacks/"+a+".json",f,JSON.stringify(e))},deleteEntitlementPack:function(a){return h.doRequest("DELETE","/entitlementpacks/"+a+".json",f,null)},getServiceEntitlementPacks:function(a,b,c){var d=new QueryStringBuilder("/services/"+a+"/entitlementpacks.json").set("verbose","expanded").set("offset",b||0).set("limit",c);return h.doRequest("GET",d.toString(),f,null)},getEntitlementsOfEntitlementPack:function(a){return h.doRequest("GET","/entitlementpacks/"+a+"/entitlements.json?offset=0",f,null)},inviteOrganizationManager:function(a,b,c,d,e,g,i,j){var k=new Jobject;return k.prop("organization",a),k.prop("emails",b),k.prop("message",c),k.prop("landing_url",d),k.prop("as_manager",!0),k.prop("start_date",e),k.prop("end_date",g),k.prop("limit",i),k.prop("locale",j),h.doRequest("POST","/invitations.json",f,JSON.stringify(k))},inviteOrganizationMember:function(a,b,c,d,e,g,i,j,k){var l=new Jobject;return l.prop("organization",a),l.prop("emails",b),l.prop("message",c),l.prop("role",d),l.prop("landing_url",e),l.prop("start_date",g),l.prop("end_date",i),l.prop("limit",j),l.prop("locale",k),l.prop("as_manager",!1),h.doRequest("POST","/invitations.json",f,JSON.stringify(l))},inviteRoleMember:function(a,b,c,d){var e=new Jobject;return e.prop("role",a),e.prop("emails",b),e.prop("message",c),e.prop("landing_url",d),e.prop("locale",d),h.doRequest("POST","/invitations.json",f,JSON.stringify(e))},inviteServiceManager:function(a,b,c,d,e,g,i,j){var k=(new Jobject).prop("service",a).prop("emails",b).prop("message",c).prop("landing_url",d).prop("start_date",e).prop("end_date",g).prop("limit",i).prop("locale",j);return h.doRequest("POST","/invitations.json",f,JSON.stringify(k))},invite:function(a){return h.doRequest("POST","/invitations.json",f,angular.toJson(a))},addEntitlementToEntitlementpack:function(a,b){var c=new Jobject;return c.prop("id",a),c.prop("eid",b),h.doRequest("PUT","/entitlementpacks/"+a+"/entitlements/"+b+".json",f,JSON.stringify(c))},deleteEntitlementFromEntitlementpack:function(a,b){var c=new Jobject;return c.prop("id",a),c.prop("eid",b),h.doRequest("DELETE","/entitlementpacks/"+a+"/entitlements/"+b+".json",f,JSON.stringify(c))},getPublicEntitlementpacks:function(a,b){var c=new QueryStringBuilder("/entitlementpacks/public.json").set("verbose","expanded").set("offset",a||0).set("limit",b);return h.doRequest("GET",c.toString(),f,null)},getOrganizationEntitlementPacks:function(a){return h.doRequest("GET","/organizations/"+a+"/entitlementpacks.json?verbose=expanded&offset=0",f,null)},linkEntitlementToOrganization:function(a,b){return h.doRequest("PUT","/organizations/"+a+"/entitlementpacks/"+b+"/token.json",f,null)},unlinkEntitlementToOrganization:function(a,b){return h.doRequest("DELETE","/organizations/"+a+"/entitlementpacks/"+b+"/token.json",f,null)},addEntitlementpackToOrganization:function(a,b){return h.doRequest("PUT","/organizations/"+a+"/entitlementpacks/"+b+".json",f,null)},deleteEntitlementpackFromOrganization:function(a,b){return h.doRequest("DELETE","/organizations/"+a+"/entitlementpacks/"+b+".json",f,null)},getOrganizationEntitlements:function(a){return h.doRequest("GET","/organizations/"+a+"/entitlements.json?offset=0",f,null)},getRoleEntitlements:function(a){return h.doRequest("GET","/roles/"+a+"/entitlements.json?offset=0",f,null)},getRole:function(a){return h.doRequest("GET","/roles/"+a+".json",f,null)},addRoleEntitlement:function(a,b){return h.doRequest("PUT","/roles/"+a+"/entitlements/"+b+".json",f,null)},setRoleEntitlements:function(a,b){var c=new Jobject;return c.prop("entitlements",b),h.doRequest("PUT","/roles/"+a+"/entitlement.json",f,angular.toJson(c))},setRolePrincipals:function(a,b){var c=new Jobject;return c.prop("principals",b),h.doRequest("PUT","/roles/"+a+"/principal.json",f,angular.toJson(c))},deleteRoleEntitlement:function(a,b){return h.doRequest("DELETE","/roles/"+a+"/entitlements/"+b+".json",f,null)},getRolePrincipals:function(a){return h.doRequest("GET","/roles/"+a+"/principals.json?verbose=expanded&offset=0",f,null)},addRolePrincipal:function(a,b,c){var d=new Jobject;return d.prop("expiration",c),h.doRequest("PUT","/roles/"+a+"/principals/"+b+".json",f,JSON.stringify(d))},deleteRolePrincipal:function(a,b){return h.doRequest("DELETE","/roles/"+a+"/principals/"+b+".json",f,null)},getOrganizationsLinkedToService:function(a){return h.doRequest("GET","/services/"+a+"/entitlementpack/requests.json?verbose=expand&offset=0",f,null)},getEntitlementpack:function(a,b){return h.doRequest("GET","/entitlementpacks/"+a+".json",f,null,b)},acceptOrganizationToEntitlementpackageRequest:function(a,b){return h.doRequest("PUT","/organizations/"+a+"/entitlementpacks/"+b+"/accept.json",f,null,null)},getAttributeValuePrincipalsPerAttributeSpecification:function(a){return h.doRequest("GET","/principals/"+a+"/attributespecs/attributevalueprincipals.json?offset=0",f,null,null)},getAttributeValuePrincipalConsents:function(a,b){return h.doRequest("GET","/attributevalueprincipals/"+a+"/consents.json?offset=0",f,null,b)},addAttributeValuePrincipalConsent:function(a,b,c){var d=new Jobject;return d.prop("is_allowed",!0),h.doRequest("PUT","/attributevalueprincipals/"+b+"/services/"+a+".json",f,JSON.stringify(d),c)},deleteAttributeValuePrincipalConsent:function(a,b,c){return h.doRequest("DELETE","/attributevalueprincipals/"+b+"/services/"+a+".json",f,null,c)},getOrganizationAttributeSpecifications:function(a,b){return h.doRequest("GET","/organizations/"+a+"/attributespecs.json?verbose=expanded&offset=0",f,null,b)},getOrganizationAttributeValues:function(a){return h.doRequest("GET","/organizations/"+a+"/attributevalueorganization.json?offset=0",f,null)},getAttributeValueOrganizationsPerAttributeSpecification:function(a,b){return h.doRequest("GET","/organizations/"+a+"/attributespecs/"+b+"/attributevalueorganizations.json?verbose=expanded&offset=0",f,null)},deleteAttributeValueOrganization:function(a,b){return h.doRequest("DELETE","/attributevalueorganizations/"+a+".json",f,null,b)},addAttributeValueOrganization:function(a,b,c,d){var e=new Jobject;return e.prop("services",d),e.prop("value",c),e.prop("organization",a),e.prop("attribute_spec",b),h.doRequest("POST","/attributevalueorganizations.json",f,angular.toJson(e))},updateAttributeValueOrganization:function(a,b,c,d){var e=new Jobject;return e.prop("attribute_spec",b),e.prop("value",c),e.prop("services",d),h.doRequest("PUT","/attributevalueorganizations/"+a+".json",f,angular.toJson(e))},getServicesLinkedToAttributeSpecification:function(a){return h.doRequest("GET","/attributespecs/"+a+"/services.json?offset=0",f,null)},getAttributeValueOrganizationConsents:function(a){return h.doRequest("GET","/attributevalueorganizations/"+a+"/consents.json?offset=0",f,null)},addAttributeValueOrganizationConsent:function(a,b){return h.doRequest("PUT","/attributevalueorganizations/"+b+"/services/"+a+".json",f,null)},deleteAttributeValueOrganizationConsent:function(a,b){return h.doRequest("DELETE","/attributevalueorganizations/"+b+"/services/"+a+".json",f,null)},getOrganizationInvitations:function(a,b,c){var d=new QueryStringBuilder("/organizations/"+a+"/invitations.json").set("verbose","expanded").set("offset",b||0).set("limit",c);return h.doRequest("GET",d.toString(),f,null)},deleteInvitation:function(a){return h.doRequest("DELETE","/invitations/"+a+".json",f,null)},updateInvitation:function(a,b,c,d,e,g,i,j,k,l,m,n){var o=(new Jobject).prop("emails",b).prop("landing_url",c).prop("as_manager",d).prop("message",e).prop("start_date",g).prop("end_date",i).prop("limit",j).prop("role",k).prop("organization",l).prop("service",m).prop("locale",n);return h.doRequest("PUT","/invitations/"+a+".json",f,JSON.stringify(o))},resendInvitation:function(a){return h.doRequest("GET","/invitations/"+a+"/resend.json",f,null)},getInvitation:function(a){return h.doRequest("GET","/invitations/"+a+".json",f,null)},getServiceInvitations:function(a,b,c){var d=new QueryStringBuilder("/services/"+a+"/invitations.json").set("offset",b||0).set("limit",c);return h.doRequest("GET",d.toString(),f,null)},addPrincipal:function(a,b,c){var d=(new Jobject).prop("fedid",a).prop("email",b).prop("display_name",c);return h.doRequest("POST","/principals.json",f,JSON.stringify(d))},setToken:function(a){f=a},setIsAdmin:function(a){g=a},getIsAdmin:function(){return h.doRequest("GET","/principal/isadmin.json",f,null)},getDummy:function(){return"dummy response"},addEntityIdRequest:function(a,b){var c=(new Jobject).prop("entityid",a).prop("message",b);return h.doRequest("POST","/entityidrequests.json",f,JSON.stringify(c))
},getUserEntityIds:function(){return h.doRequest("GET","/entityidrequests.json?offset=0",f,null)},deleteEntityIdRequest:function(a){return h.doRequest("DELETE","/entityidrequests/"+a+".json",f,null)},acceptEntityIdRequest:function(a){return h.doRequest("GET","/entityidrequests/"+a+"/accept.json",f,null)},rejectEntityIdRequest:function(a){return h.doRequest("GET","/entityidrequests/"+a+"/reject.json",f,null)},updateEntityIdRequest:function(a,b,c){var d=(new Jobject).prop("entityid",b).prop("message",c);return h.doRequest("PUT","/entityidrequests/"+a+".json",f,JSON.stringify(d))},getPrincipalRelatedServices:function(a,b){var c=new QueryStringBuilder("/principal/services/related.json").set("offset",a||0).set("limit",b);return h.doRequest("GET",c.toString(),f,null)},addConsent:function(a,b,c){var d=(new Jobject).prop("enable_entitlements",a).prop("enabled_attribute_specs",b).prop("service",c);return h.doRequest("POST","/consents.json",f,angular.toJson(d))},updateConsent:function(a,b,c,d){var e=(new Jobject).prop("enable_entitlements",b).prop("enabled_attribute_specs",c).prop("service",d);return h.doRequest("PUT","/consents/"+a+".json",f,angular.toJson(e))},getConsents:function(){return h.doRequest("GET","/consents.json?offset=0",f,null)},getServiceConsent:function(a){return h.doRequest("GET","/consents/"+a+"/service.json?offset=0",f,null)},getOrganizationNews:function(a,b,c,d){return h.doRequest("GET","/organizations/"+a+"/news.json?verbose=expanded&limit="+c+"&offset="+b+"&"+$.param({tags:d}),f,null)},getServiceNews:function(a,b,c,d){return h.doRequest("GET","/services/"+a+"/news.json?verbose=expanded&limit="+c+"&offset="+b+"&"+$.param({tags:d}),f,null)},getPrincipalNews:function(a,b,c,d,e){return h.doRequest("GET","/principal/news.json?verbose=expanded&limit="+b+"&offset="+a+"&"+$.param({tags:c})+"&"+$.param({services:d})+"&"+$.param({organizations:e}),f,null)},getPrincipalById:function(a){return h.doRequest("GET","/principals/"+a+"/id.json",f,null)},generateEntitlementpackToken:function(a){return h.doRequest("GET","/entitlementpacks/"+a+"/token.json",f,null)},getApiProperties:function(){return h.doRequest("GET","/properties.json",f,null)},updatePrincipal:function(a,b,c,d){var e=(new Jobject).prop("fedid",b).prop("email",c).prop("display_name",d);return h.doRequest("PUT","/principals/"+a+".json",f,angular.toJson(e))},setEntitlementPackEntitlements:function(a,b){var c=(new Jobject).prop("entitlements",b);return h.doRequest("PUT","/entitlementpacks/"+a+"/entitlement.json",f,angular.toJson(c))},setOrganizationManagers:function(a,b){var c=(new Jobject).prop("managers",b);return h.doRequest("PUT","/organizations/"+a+"/manager.json",f,angular.toJson(c))},setServiceManagers:function(a,b){var c=(new Jobject).prop("managers",b);return h.doRequest("PUT","/services/"+a+"/manager.json",f,angular.toJson(c))},setOrganizationMembers:function(a,b){var c=(new Jobject).prop("principals",b);return h.doRequest("PUT","/organizations/"+a+"/member.json",f,angular.toJson(c))},setOrganizationEntitlementpacks:function(a,b){var c=(new Jobject).prop("entitlement_packs",b);return h.doRequest("PUT","/organizations/"+a+"/entitlementpack.json",f,angular.toJson(c))},getPrincipalManagedServices:function(){return h.doRequest("GET","/manager/services.json?offset=0",f,null)},getPrincipalManagedOrganizations:function(){return h.doRequest("GET","/manager/organizations.json?offset=0",f,null)},getPrincipalMemberOrganizations:function(){return h.doRequest("GET","/member/organizations.json?offset=0",f,null)},deletePrincipal:function(a){return h.doRequest("DELETE","/principals/"+a+"/id.json",f,null)},setServiceAttributeSpecifications:function(a,b){var c=(new Jobject).prop("attribute_specs",b);return h.doRequest("PUT","/services/"+a+"/attributespec.json",f,angular.toJson(c))},notifySP:function(a,b){return h.doRequest("PUT","/services/"+a+"/notifysp.json",f,angular.toJson(b))},getEntitlementpackEntitlements:function(a){return h.doRequest("GET","/entitlementpacks/"+a+"/entitlements.json",f,null)},getPrincipalRoles:function(){return h.doRequest("GET","/principal/roles.json?verbose=expanded&offset=0",f,null)},getPrincipalEntitlements:function(){return h.doRequest("GET","/principal/entitlementpack/related.json?verbose=expanded&offset=0",f,null)}}}]),angular.module("hexaaApp.services.facades").factory("RolesProxy",["$http","$rootScope","$q","HexaaService","RoleFactory",function(a,b,c,d,e){var f={createRole:function(a,b){var e=c.defer();return d.addRoleToOrganization(a,b.name,b.description,b.start_date,b.end_date).success(function(a,f,g,h){b.id=g("Location").match("(.*)/api/roles/(.*)")[2],c.all([d.setRoleEntitlements(b.id,b.entitlements.map(function(a){return a.id})),d.setRolePrincipals(b.id,b.principals.map(function(a){return{principal:a.id,expiration:a.expiration}}))]).then(function(){e.resolve(wrapResponse(a,f,g,h))})["catch"](function(a){e.reject(wrapResponse(a,420,g,h))})}).error(function(a,b,c,d){e.reject(wrapResponse(a,b,c,d))}),e.promise},updateRole:function(a){var b=c.defer();return d.updateRole(a.id,a.name,a.description,a.start_date,a.end_date).success(function(e,f,g,h){c.all(d.setRoleEntitlements(a.id,a.entitlements.map(function(a){return a.id})),d.setRolePrincipals(a.id,a.principals.map(function(a){return{principal:a.id,expiration:a.expiration||null}}))).then(function(a){b.resolve(wrapResponse(a,f,g,h))})["catch"](function(a){b.reject(wrapResponse(a,420,g,h))})}).error(function(a,c,d,e){b.reject(wrapResponse(a,c,d,e))}),b.promise},deleteRole:function(a){return d.deleteRole(a)},getRole:function(a){var b=c.defer(),e=void 0;return d.getRole(a).success(function(f,g,h,i){e=f,c.all([d.getRolePrincipals(a),d.getRoleEntitlements(a)]).then(function(a){e.members=a[0].data.map(function(a){return a.fedid=a.principal.fedid,a.email=a.principal.email,a.display_name=a.principal.display_name,a.id=a.principal.id,a}),e.entitlements=a[1].data,b.resolve(wrapResponse(e,g,h,i))})["catch"](function(a){b.resolve(wrapResponse(a,420,h,i))})}).error(function(a,c,d,e){b.resolve(wrapResponse(a,c,d,e))}),b.promise},"new":function(a){return e["new"](a)}};return f}]),angular.module("hexaaApp.services.facades").factory("ConsentsProxy",["$http","$rootScope","$q","HexaaService",function(a,b,c,d){return{addConsent:function(a){return d.addConsent(a.enable_entitlements,a.enabled_attribute_specs,a.service)},updateConsent:function(a){return d.updateConsent(a.id,a.enable_entitlements,a.enabled_attribute_specs,a.service)}}}]),angular.module("hexaaApp.services.facades").factory("InvitationsProxy",["$http","$rootScope","$q","HexaaService","ResourceEntity","InvitationFactory",function(a,b,c,d,e,f){var g={invite:function(a){return d.invite(a)},resend:function(a){return d.resendInvitation(a)},"delete":function(a){return d.deleteInvitation(a)},update:function(a){return d.updateInvitation(a.id,String(a.emails).split(","),a.landing_url,a.as_manager,a.message,a.start_date,a.end_date,a.limit,a.role_id,a.organization_id,a.service_id,a.locale)},"new":function(a){return f["new"](a)}};return g}]),angular.module("hexaaApp.services.facades").factory("AttributeSpecificationsProxy",["$http","$rootScope","$q","HexaaService","AttributeSpecificationFactory",function(a,b,c,d,e){var f={getSupportingServices:function(a){var b=c.defer(),e=[];return d.getServicesLinkedToAttributeSpecification(a.id).success(function(a,c,f,g){a.items.forEach(function(h,i){d.getService(h.service_id).then(function(a){void 0==e&&(e=[]),e.push(a.data)})["finally"](function(){i==e.length-1&&b.resolve(wrapResponse({items:e,item_number:a.item_number},c,f,g))})})}).error(function(a,c,d,e){b.reject(wrapResponse(a,c,d,e))}),b.promise},getAttributeSpecifications:function(a){var b=null;b=void 0!==a?d.getAttributeSpecifications((a.currentPage-1)*a.itemPerPage,a.itemPerPage):d.getAttributeSpecifications();var f=c.defer();return b.success(function(a,b,c,d){var g=[];angular.forEach(a.items,function(a,b){g[b]=e["new"](a)}),f.resolve(wrapResponse({items:g,item_number:a.item_number},b,c,d))}).error(function(a,b,c,d){f.reject(wrapResponse(a,b,c,d))}),f.promise},"delete":function(a){return d.deleteAttributeSpecification(a)},update:function(a){return d.updateAttributeSpecification(a.id,a.uri,a.name,a.maintainer,a.description,a.syntax,a.is_multivalue)},create:function(a){return d.addAttributeSpecification(a.uri,a.name,a.maintainer,a.description,a.syntax,a.is_multivalue)},"new":function(a){return e["new"](a)}};return f}]),angular.module("hexaaApp.services.facades").factory("PrincipalProxy",["$http","$rootScope","$q","HexaaService","ResourceEntity","PrincipalFactory",function(a,b,c,d,e,f){var g={getPrincipal:function(){var a=c.defer(),b={};return c.all({principal:d.getPrincipal(),memberships:d.getPrincipalMemberOrganizations(),managedServices:d.getPrincipalManagedServices(),managedOrganizations:d.getPrincipalManagedOrganizations(),isAdmin:d.getIsAdmin()}).then(function(c){b=c.principal.data,b.memberships=c.memberships.data.items,b.managedServices=c.managedServices.data.items,b.managedOrganizations=c.managedOrganizations.data.items,b.isAdmin=c.isAdmin.data.is_admin,b.administrator=angular.copy(c.isAdmin.data.is_admin),a.resolve(wrapResponse(f["new"](b),200,null,null))})["catch"](function(b){a.reject(wrapResponse(b,420,null,null))}),a.promise},getAttributeSpecifications:function(){return d.getPrincipalAttributeSpecifications()},getAttributeValuePrincipals:function(a){var b=c.defer(),f=[];return d.getAttributeValuePrincipalsPerAttributeSpecification(a).success(function(a,g,h,i){c.all(a.items.map(function(a){return c.all(a.service_ids.map(function(a){return d.getService(a)})).then(function(b){a.associatedServices=b.map(function(a){return a.data}),f.push(e["new"](a))})})).then(function(){b.resolve(wrapResponse({items:f,item_number:f.length},g,h,i))})}).error(function(a,c,d,e){b.reject(wrapResponse(a,c,d,e))}),b.promise},addAttributeValuePrincipal:function(a){var b=a.associatedServices.map(function(a){return a.id}),e=c.defer();return d.addAttributeValuePrincipal(a.attribute_spec_id,a.value,b).success(function(b,c,d,f){a.id=d("Location").match("(.*)/api/attributevalueprincipals/(.*)")[2],e.resolve(wrapResponse(b,c,d,f))}).error(function(a,b,c,d){e.reject(wrapResponse(a,b,c,d))}),e.promise},updateAttributeValuePrincipal:function(a){return d.updateAttributeValuePrincipal(a.id,a.attribute_spec_id,a.value,a.associatedServices.map(function(a){return a.id}))},deleteAttributeValuePrincipal:function(a){return d.deleteAttributeValuePrincipal(a)},getRelatedServices:function(a){return void 0!==a?d.getPrincipalRelatedServices((a.currentPage-1)*a.itemPerPage,a.itemPerPage):d.getPrincipalRelatedServices()},getConsents:function(){return d.getConsents()},getServiceConsent:function(a){return d.getServiceConsent(a)},getNews:function(a,b,c,e,f){return d.getPrincipalNews(a,b,c,e,f)},updatePrincipal:function(a){return d.updatePrincipal(a.id,a.fedid,a.email,a.display_name)},addPrincipal:function(a){return d.addPrincipal(a.fedid,a.email,a.display_name)},getPrincipals:function(){var a=c.defer();return d.getPrincipals().success(function(b,c,d,e){var g=[];angular.forEach(b.items,function(a){g.push(f["new"](a))}),a.resolve(wrapResponse({items:g,item_number:b.item_number},c,d,e))}).error(function(b,c,d,e){a.reject(wrapResponse(b,c,d,e))}),a.promise},isAdmin:function(){return d.getIsAdmin()},getOrganizationMemberships:function(){return d.getPrincipalMemberOrganizations()},getManagedOrganizations:function(){return d.getPrincipalManagedOrganizations()},getManagedServices:function(){return d.getPrincipalManagedServices()},deletePrincipal:function(a){return d.deletePrincipal(a)},getEntityIds:function(){return d.getUserEntityIds()},getRoles:function(){return d.getPrincipalRoles()},getMyOrganizations:function(){var a=c.defer();return d.getPrincipalRoles().success(function(b,c,d,e){var f=$linq(b.items).groupBy("x => x.organization",null,"(x,y) => x.id == y.id").toArray();a.resolve(wrapResponse({items:f,item_number:f.length},c,d,e))}).error(function(b,c,d,e){a.reject(wrapResponse(b,c,d,e))}),a.promise},getMyServices:function(){var a=c.defer();return d.getPrincipalEntitlements().success(function(b,c,d,e){var f=$linq(b.items).groupBy("x => x.service",null,"(x,y) => x.id == y.id").toArray();a.resolve(wrapResponse({items:f,item_number:f.length},c,d,e))}).error(function(b,c,d,e){a.reject(wrapResponse(b,c,d,e))}),a.promise},"new":function(a){return f["new"](a)}};return g}]),angular.module("hexaaApp.services.facades").factory("ServicesProxy",["$http","$rootScope","$q","HexaaService","InvitationsProxy","baseUIAddr","baseAddr","ResourceEntity","EntitlementpacksProxy","SercviceFactory",function(a,b,c,d,e,f,g,h,i,j){var k=function(a){angular.extend(this,a||defaultProperties)};k.prototype.save=function(){return void 0===this.id||-1===this.id?l.addService(this,this.contacts):l.updateService(this)},k.prototype["delete"]=function(){return l.deleteService(this.id)},k.prototype.setLogo=function(a){this.logo_path=a},k.prototype.getLogo=function(){return void 0===this.logo_path||null===this.logo_path||""===this.logo_path?f+"/images/default.png":g+"/"+this.logo_path};var l={getServices:function(){return d.getServices()},deleteService:function(a){return d.deleteService(a)},getService:function(a){var b=c.defer();return d.getService(a).success(function(a,c,d,e){b.resolve(wrapResponse(j["new"](a),c,d,e))}).error(function(a,c,d,e){b.reject(wrapResponse(a,c,d,e))}),b.promise},getAttributeSpecifications:function(a){return d.getServiceAttributeSpecifications(a)},getNews:function(a,b,c,e){return d.getServiceNews(a,b,c,e)},getEntityIds:function(){return d.getEntityIds()},updateService:function(a){return d.updateService(a.id,a.name,a.url,a.entityid,a.description,a.org_name,a.org_short_name,a.org_url,a.org_description,a.priv_url,a.priv_description)},addService:function(a,b){var e=c.defer();return d.addService(a.name,a.url,a.entityid,a.description,a.org_name,a.org_short_name,a.org_url,a.org_description,a.priv_url,a.priv_description).success(function(a,c,f,g){var h=f("Location").match("(.*)/api/services/(.*)")[2];d.notifySP(h,{contacts:b}).success(function(){e.resolve(wrapResponse(a,c,f,g))}).error(function(a,b,c,d){e.reject(wrapResponse(a,b,c,d))})}).error(function(a,b,c,d){e.reject(wrapResponse(a,b,c,d))}),e.promise},getManagers:function(a){return d.getManagersOfService(a)},addEntitlement:function(a,b){return d.addServiceEntitlement(a,b.uri,b.name,b.description).success(function(a,c,d){b.id=d("Location").match("(.*)/api/entitlements/(.*)")[2]})},updateEntitlement:function(a){return d.updateEntitlement(a.id,a.uri,a.name,a.description)},getEntitlements:function(a){var b=c.defer(),e=[];return d.getServiceEntitlements(a).success(function(a,c,d,f){angular.forEach(a.items,function(a){e.push(h["new"](a))}),b.resolve(wrapResponse({items:e,item_number:a.item_number},c,d,f))}).error(function(a,c,d,e){b.reject(wrapResponse(a,c,d,e))}),b.promise},deleteEntitlement:function(a){return d.deleteEntitlement(a)},getEntitlementpacks:function(a,b){var e=c.defer();return d.getServiceEntitlementPacks(a,(b.currentPage-1)*b.itemPerPage,b.itemPerPage).success(function(a,b,c,d){var f=[];angular.forEach(a.items,function(a){f.push(i["new"](a))}),e.resolve(wrapResponse({items:f,item_number:a.item_number},b,c,d))})["catch"](function(a,b,c,d){e.reject(wrapResponse(a,b,c,d))}),e.promise},updateEntitlementpack:function(a){var b=c.defer();return d.updateEntitlementPack(a.id,a.name,a.description,a.type).success(function(c,e,f,g){d.setEntitlementPackEntitlements(a.id,a.entitlements.map(function(a){return a.id})).then(function(a){b.resolve(wrapResponse(a,e,f,g))})["catch"](function(a){b.reject(wrapResponse(a,420,f,g))})}).error(function(a,c,d,e){b.reject(wrapResponse(a,c,d,e))}),b.promise},addEntitlementpack:function(a,b){var e=c.defer();return d.addServiceEntitlementPack(a,b.name,b.description,b.type).success(function(a,c,f){b.id=f("Location").match("(.*)/api/entitlementpacks/(.*)")[2],d.setEntitlementPackEntitlements(b.id,b.entitlements.map(function(a){return a.id})).success(function(a,b,c,d){e.resolve(wrapResponse(a,b,c,d))}).error(function(a,b,c,d){e.reject(wrapResponse(a,b,c,d))})}).error(function(a,b,c,d){e.reject(wrapResponse(a,b,c,d))}),e.promise},getLinkedOrganizations:function(a){var b=c.defer();return d.getOrganizationsLinkedToService(a).then(function(a){var e=[];c.all(a.data.items.map(function(a){return c.all([d.getOrganization(a.organization_id),d.getEntitlementpack(a.entitlement_pack_id)]).then(function(b){a.organization=b[0].data.name,a.entitlementpack=b[1].data.name,e.push(a)})["catch"](function(a){b.reject(wrapResponse(a,420,null,null))})})).then(function(){b.resolve(wrapResponse({items:e,item_number:a.data.item_number},200,null,null))})["catch"](function(a){b.resolve(wrapResponse(a,420,null,null))})}),b.promise},acceptConnectionRequest:function(a,b){return d.acceptOrganizationToEntitlementpackageRequest(a,b)},getInvitations:function(a,b){var f=c.defer(),g=null;return g=void 0===b?d.getServiceInvitations(a):d.getServiceInvitations(a,(b.currentPage-1)*b.itemPerPage,b.itemPerPage),g.success(function(a,b,c,d){var g=[];angular.forEach(a.items,function(a){g.push(e["new"](a))}),f.resolve(wrapResponse({items:g,item_number:a.item_number},b,c,d))}).error(function(a,b,c,d){f.reject(wrapResponse(a,b,c,d))}),f.promise},updateManagers:function(a){return d.setServiceManagers(a.id,a.managers.map(function(a){return a.id}))},updateAttributeSpecifications:function(a){return d.setServiceAttributeSpecifications(a.id,a.attrspecs.map(function(a){return{attribute_spec:a.id,is_public:a.is_public||!1}}))},acceptEntityIdRequest:function(a){return d.acceptEntityIdRequest(a)},rejectEntityIdRequest:function(a){return d.rejectEntityIdRequest(a)},deleteEntityIdRequest:function(a){return d.deleteEntityIdRequest(a)},notifySP:function(a,b){return d.notifySP(a,{contacts:b})},"new":function(a){return j["new"](a)}};return l}]),angular.module("hexaaApp.services.facades").factory("OrganizationsProxy",["$http","$rootScope","$q","HexaaService","RolesProxy","InvitationsProxy","ResourceEntity","OrganizationFactory",function(a,b,c,d,e,f,g,h){var i={getRoles:function(a,b){var f=c.defer(),g=[],h=null;return h=void 0!==b?d.getOrganizationRoles(a,(b.currentPage-1)*b.itemPerPage,b.itemPerPage):d.getOrganizationRoles(a),h.then(function(a){angular.forEach(a.data.items,function(a){for(var b=0;b<a.principals.length;b++)a.principals[b]=a.principals[b].principal;g.push(e["new"](a))}),f.resolve(wrapResponse({items:g,item_number:a.data.item_number},a.status,a.headers,a.config))}),f.promise},getOrganizations:function(){return d.getOrganizations()},getOrganization:function(a){var b=c.defer();return d.getOrganization(a).success(function(a,c,d,e){b.resolve(wrapResponse(h["new"](a),c,d,e))}).error(function(a,c,d,e){b.reject(wrapResponse(a,c,d,e))}),b.promise},getAttributeSpecifications:function(a){return d.getOrganizationAttributeSpecifications(a)},getManagers:function(a){return d.getManagersOfOrganization(a)},getMembers:function(a){return d.getMembersOfOrganization(a)},getPrincipals:function(a){var b=c.defer();return c.all({members:d.getMembersOfOrganization(a),managers:d.getManagersOfOrganization(a)}).then(function(a){var c=a.managers.data.items.map(function(a){return a.is_manager=!0,a}),d=$linq(c).union(a.members.data.items,"(x,y)=>x.fedid==y.fedid").toArray();b.resolve(wrapResponse(d,a.members.status,a.members.headers,a.members.config))})["catch"](function(a){b.reject(wrapResponse(a,420,null,null))}),b.promise},getAttributeValueOrganizations:function(a){return d.getAttributeValueOrganizationsPerAttributeSpecification(a.organization_id,a.id)},addAttributeValueOrganization:function(a){var b=c.defer();return d.addAttributeValueOrganization(a.organization_id,a.attribute_spec.id,a.value,a.services.map(function(a){return a.id})).success(function(c,d,e,f){a.id=e("Location").match("(.*)/api/attributevalueorganizations/(.*)")[2],b.resolve(wrapResponse(c,d,e,f))}).error(function(a,c,d,e){b.reject(wrapResponse(a,c,d,e))}),b.promise},updateAttributeValueOrganization:function(a){return d.updateAttributeValueOrganization(a.id,a.attribute_spec.id,a.value,a.services.map(function(a){return a.id}))},deleteAttributeValueOrganization:function(a){return d.deleteAttributeValueOrganization(a.id)},getNews:function(a,b,c,e){return d.getOrganizationNews(a,b,c,e)},updateOrganization:function(a){return d.updateOrganization(a.id,a.name,a.description,a.url,a.default_role_id)},createOrganization:function(a){var b=c.defer();return d.addOrganization(a.name,a.description,a.url).success(function(c,e,f,g){a.id=f("Location").match("(.*)/api/organizations/(.*)")[2],void 0!=a.role?d.addRoleToOrganization(a.id,a.role.name,a.role.description,a.role.start_date,a.role.end_date).success(function(c,e,f){a.role.id=f("Location").match("(.*)/api/roles/(.*)")[2],d.updateOrganization(a.id,a.name,a.description,a.url,a.role.id).success(function(c,d,e,f){b.resolve(wrapResponse(a,d,e,f))}).error(function(a,c,d,e){b.reject(wrapResponse(a,c,d,e))})}).error(function(a,c,d,e){b.reject(b.reject(wrapResponse(a,c,d,e)))}):b.resolve(wrapResponse(a,e,f,g))}).error(function(a,c,d,e){b.reject(wrapResponse(a,c,d,e))}),b.promise},deleteOrganization:function(a){return d.deleteOrganization(a.id)},updateManagers:function(a){return d.setOrganizationManagers(a.id,a.managers.map(function(a){return a.id}))},updateMembers:function(a){return d.setOrganizationMembers(a.id,a.members.map(function(a){return a.id}))},getInvitations:function(a,b){var e=c.defer(),g=[],h={};return h=void 0!==b?d.getOrganizationInvitations(a,(b.currentPage-1)*b.itemPerPage,b.itemPerPage):d.getOrganizationInvitations(a),h.success(function(a,b,c,d){angular.forEach(a.items,function(a){g.push(f["new"](a))}),e.resolve(wrapResponse({items:g,item_number:a.item_number},b,c,d))}).error(function(a,b,c,d){e.resolve(wrapResponse(a,b,c,d))}),e.promise},getEntitlementpacks:function(a){var b=c.defer(),e=[];return d.getOrganizationEntitlementPacks(a).success(function(a,c,d,f){angular.forEach(a.items,function(a){a.id=a.entitlement_pack.id,a.name=a.entitlement_pack.name,a.description=a.entitlement_pack.description,a.scoped_name=a.entitlement_pack.scoped_name,e.push(a)}),b.resolve(wrapResponse({items:e,item_number:a.item_number},c,d,f))}).error(function(a,c,d,e){b.reject(wrapResponse(a,c,d,e))}),b.promise},getEntitlements:function(a){return d.getOrganizationEntitlements(a)},linkPrivateEntitlementpack:function(a,b){return d.linkEntitlementToOrganization(a.id,b)},updateEntitlementpacks:function(a){return d.setOrganizationEntitlementpacks(a.id,a.entitlementpacks.map(function(a){return a.id}))},deleteEntitlementpack:function(a,b){return d.deleteEntitlementpackFromOrganization(a,b)},addManager:function(a,b){return d.addManagerToOrganization(a,b)},removeManager:function(a,b){return d.deleteManagerFromOrganization(a,b)},addMember:function(a,b){return d.addMemberToOrganization(a,b)},removeMember:function(a,b){return d.deleteMemberFromOrganization(a,b)},addEntitlementpack:function(a,b){return d.addEntitlementpackToOrganization(a.id,b.id)},removeEntitlementpack:function(a,b){return d.deleteEntitlementpackFromOrganization(a,b)},"new":function(a){return h["new"](a)}};return i}]),angular.module("hexaaApp.services.facades").factory("EntitlementpacksProxy",["$http","$rootScope","$q","HexaaService","ResourceEntity","$injector","EntitlementpackFactory",function(a,b,c,d,e,f,g){var h={generateToken:function(a){return d.generateEntitlementpackToken(a)},getPublicEntitlementpacks:function(a){return void 0!==a?d.getPublicEntitlementpacks((a.currentPage-1)*a.itemPerPage,a.itemPerPage):d.getPublicEntitlementpacks()},getEntitlements:function(a){var b=c.defer(),e=[];return d.getEntitlementsOfEntitlementPack(a).success(function(a,c,d,f){angular.forEach(a,function(a){e.push(g["new"](a))}),b.resolve(wrapResponse(e,c,d,f))})["catch"](function(a,c,d,e){b.resolve(wrapResponse(a,c,d,e))}),b.promise},remove:function(a){return d.deleteEntitlementPack(a)},getEntitlementPrefix:function(){return d.getApiProperties()},getEntitlementpackEntitlements:function(a){return d.getEntitlementpackEntitlements(a)},"new":function(a){return g["new"](a)}};return h}]),angular.module("hexaaApp.models").factory("ResourceEntity",ResourceFactory),angular.module("hexaaApp.models").factory("OrganizationFactory",["$injector",OrganizationFactory]),angular.module("hexaaApp.models").factory("SercviceFactory",["$injector",SercviceFactory]),angular.module("hexaaApp.models").factory("RoleFactory",["$injector",RoleFactory]),angular.module("hexaaApp.models").factory("PrincipalFactory",["$injector",PrincipalFactory]),angular.module("hexaaApp.models").factory("InvitationFactory",["$injector",InvitationFactory]),angular.module("hexaaApp.models").factory("EntitlementpackFactory",["$injector",EntitlementpackFactory]),angular.module("hexaaApp.models").factory("AttributeSpecificationFactory",["$injector",AttributeSpecificationFactory]),angular.module("hexaaApp.services").factory("requestNotificationChannel",["$rootScope","events",function(a,b){var c="_START_REQUEST_",d="_END_REQUEST_",e=function(){a.$broadcast(c)},f=function(){a.$broadcast(d)},g=function(a,b){a.$on(c,function(){b()})},h=function(a,b){a.$on(d,function(){b()})},i=function(){a.$broadcast(b.tokenExpired)},j=function(){a.$broadcast(b.onInternalServerError)},k=function(c){a.$broadcast(b.onBadRequest,c)};return{requestStarted:e,requestEnded:f,onRequestStarted:g,onRequestEnded:h,tokenExpired:i,internalServerError:j,badRequest:k}}]),angular.module("hexaaApp.services").factory("dialogService",["$rootScope","$q","$modal","toastr","events",function(a,b,c,d,e){function f(a,b){c.open({templateUrl:"views/shared/modals/message.html",controller:"ModalMessageCtrl",backdrop:!1,resolve:{title:function(){return a},body:function(){return b}}})}function g(b){void 0!==b&&a.$broadcast(e.notifyUIError,b)}function h(a){d.success(a)}function i(a){d.warning(a)}function j(a){d.info(a)}function k(a){d.error(a)}var l=function(a,d){var e=b.defer(),f=c.open({templateUrl:"views/shared/modals/confirmationDialog.html",controller:"ConfirmationDialogCtrl",backdrop:!1,resolve:{title:function(){return a},body:function(){return d}}});return f.result.then(function(a){e.resolve(a)}),e.promise};return{confirm:l,success:h,warning:i,info:j,error:k,notifyUIError:g,showMessage:f}}]),angular.module("hexaaApp.services").service("themeService",["$rootScope","events",function(a,b){var c=[{id:0,name:"Default",src:"styles/skins/b9ab1d05.bootstrap.css",selected:!0},{id:1,name:"Amelia",src:"styles/skins/e00c0e9f.amelia.css",selected:!1},{id:2,name:"Cerulean",src:"styles/skins/e02a995e.cerulean.css",selected:!1},{id:3,name:"Cosmo",src:"styles/skins/b4c6e2a6.cosmo.css",selected:!1},{id:4,name:"Cyborg",src:"styles/skins/6375660a.cyborg.css",selected:!1},{id:5,name:"Darkly",src:"styles/skins/3f54044e.darkly.css",selected:!1},{id:6,name:"Flatly",src:"styles/skins/dced7605.flatly.css",selected:!1},{id:7,name:"Journal",src:"styles/skins/02c8d60f.journal.css",selected:!1},{id:8,name:"Lumen",src:"styles/skins/1b4a35fa.lumen.css",selected:!1},{id:9,name:"Readable",src:"styles/skins/f1e51135.readable.css",selected:!1},{id:10,name:"Simplex",src:"styles/skins/d2f99aa5.simplex.css",selected:!1},{id:11,name:"Spacelab",src:"styles/skins/7833f673.spacelab.css",selected:!1},{id:12,name:"Superhero",src:"styles/skins/63dd8ced.superhero.css",selected:!1},{id:13,name:"United",src:"styles/skins/8aaf62a2.united.css",selected:!1},{id:14,name:"Yeti",src:"styles/skins/f46fddb6.yeti.css",selected:!1},{id:15,name:"Slate",src:"styles/skins/aef8fbde.slate.css",selected:!1}],d=function(){return c},e=function(d){var e=d||c[0];a.$broadcast(b.siteThemeChanged,e)},f=function(a){return $linq(c).where("x=>x.id == "+a).singleOrDefault(c[0])};return{apply:e,getThemes:d,getTheme:f}}]),angular.module("hexaaApp.services").service("securityService",["$rootScope","events","$cookies","hexaaCookieName",function(a,b,c,d){var e=c[d],f=function(c){if(void 0!==c){var d=JSON.parse(c);a.$broadcast(b.authenticated,d.token)}else a.$broadcast(b.authError,void 0)};a.$watch(function(){return c[d]},function(c){if(void 0===c)a.$broadcast(b.authError,void 0);else{var d=JSON.parse(c);a.$broadcast(b.languageChanged,d.lang)}});var g=function(){var a=JSON.parse(e);return a.token};return{authenticate:f,getToken:g}}]),angular.module("hexaaApp.services").service("profileService",["PrincipalProxy","HexaaService","baseAddr","$rootScope","events",PrincipalProxyService]),angular.module("hexaaApp.services").service("settingsService",["$cookieStore","settingsCookieName",function(a,b){var c=a.get(b),d=function(a){return void 0!==c?c[a]:void 0},e=function(d,e){void 0===c&&(c={}),c[d]=e,a.put(b,c)};return{get:d,set:e}}]),angular.module("hexaaApp.services").service("startupService",["$rootScope","$translate","HexaaService","events","hexaaCookieName","PrincipalProxy","securityService","$cookies","$timeout","$location","profileService",function(a,b,c,d,e,f,g,h,i,j,k){function l(){a.navigate=navigate,a.isActiveTab=t,a.$on(d.authenticated,p),a.$on(d.authError,r),a.$on(d.tokenExpired,s),a.$on(d.languageChanged,q),m()}function m(){g.authenticate(h[e]),c.getApiProperties().then(o),a.$on(d.onUserPermissionChanged,n)}function n(){navigate("#"+j.url())}function o(b){a.hexaa_properties={},a.hexaa_properties.backend_version=b.data.version,a.hexaa_properties.public_attribute_spec_enabled=b.data.public_attribute_spec_enabled}function p(a,b){c.setToken(b),k.run()}function q(a,c){b.use(c)}function r(){navigate("index.php")}function s(){navigate("index.php")}function t(a){return j.path()===a||j.path().startsWith(a)}return{run:l}}]),angular.module("hexaaApp.services").factory("pageTitleService",[function(){function a(a){f=a}function b(a){g=a}function c(){return f+" / "+g}function d(){return g}function e(){return f}var f="",g="";return{setPageTitle:a,setSubPageTitle:b,getTitle:c,getSubPageTitle:d,getPageTitle:e}}]),angular.module("hexaaApp.shared.directives").directive("ngModelOnblur",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){"radio"!==c.type&&"checkbox"!==c.type&&(b.unbind("input").unbind("keydown").unbind("change"),b.bind("blur",function(){a.$apply(function(){d.$setViewValue(b.val())})}))}}}),angular.module("hexaaApp.shared.directives").directive("validate",["$compile","$interval",function(a,b){function c(a,c){a.showError=e,c.focusout(g(c)),c.focus(f(c)),b(d(a,c),1e3,1)}function d(a,b){e(b)}function e(a){if(!a[0].hasAttribute("tooltipVisible")){var b=a[0].validationMessage;void 0!==b&&(a.data("bs.tooltip",!1).tooltip({placement:"left",trigger:"manual",title:b}).tooltip("show"),a.attr("tooltipVisible",!0))}}function f(a){a.tooltip("hide"),a.removeAttr("tooltipVisible")}function g(a){e(a)}var h={restrict:"A",scope:!0,link:c};return h}]),function(){"use strict";angular.module("hexaaApp.shared.directives").directive("draggable",function(){function a(a,b){$(b).draggable({handle:$(b).attr("draggable")})}var b={restrict:"A",link:a};return b})}(),angular.module("hexaaApp.shared.directives").directive("resizable",function(){function a(a,b){$(b).resizable()}return{restrict:"A",link:a}}),angular.module("hexaaApp.shared.directives").directive("loadingWidget",["requestNotificationChannel",function(a){return{restrict:"A",link:function(b,c){c.hide();var d=function(){c.show()},e=function(){c.hide()};a.onRequestStarted(b,d),a.onRequestEnded(b,e)}}}]),angular.module("hexaaApp.shared.directives").directive("notifyuierror",["events","$rootScope",function(a,b){function c(c,e){b.$on(a.notifyUIError,d(e))}function d(a){return function(b,c){if(void 0!==c&&null!==c&&void 0!==c.children){var d=function(){$(this).tooltip("hide")},e=$(a).attr("id");void 0!==c.children[e]&&void 0!==c.children[e].errors&&c.children[e].errors.length>0&&($(a).prop("data-toggle","tooltip"),$(a).prop("title",c.children[e].errors[0]),$(a).tooltip({placement:"left",trigger:"manual"}).tooltip("show"),$(a).focus(d))}}}return{restrict:"A",link:c}}]),function(){"use strict";angular.module("hexaaApp.shared.directives").directive("angularDuallistbox",["$interval",function(a){function b(b,c){function d(){var a=$(c).find("select");
g=$(a).bootstrapDualListbox({nonSelectedListLabel:b.nonSelectedListLabel,selectedListLabel:b.selectedListLabel,moveOnSelect:!1,filterPlaceHolder:b.filterPlaceHolder})}function e(){d(),a(f,1e3,0,!1)}function f(){g.bootstrapDualListbox("refresh",!1)}var g=null;b.refresh=f,e()}var c={elements:"=",selected:"=",elementDisplay:"=",elementValue:"=",nonSelectedListLabel:"&",selectedListLabel:"&",filterPlaceHolder:"&"},d={restrict:"A",scope:c,link:b,templateUrl:"views/shared/directives/angular-duallistbox.tpl.html"};return d}])}(),function(){"use strict";angular.module("hexaaApp.shared.directives").directive("hexaaSharedNewsWidget",function(){function a(){}var b={news:"="},c={restrict:"A",link:a,scope:b,templateUrl:"views/shared/directives/hexaa-shared-news-widget.html"};return c})}(),function(){"use strict";angular.module("hexaaApp.shared.directives").directive("bootstrapSwitch",[function(){function a(a,b){var c=null;c=$(b).bootstrapSwitch()}var b={restrict:"A",link:a};return b}])}(),angular.module("hexaaApp.filters").filter("pager",pagerFilterFactory),angular.module("hexaaApp.filters").filter("imageFormatter",["baseAddr","baseUIAddr",imageFormatterFilter]),angular.module("hexaaApp.filters").filter("placeholder",placeholderFilterFactory),Array.prototype.isArray=!0,Array.prototype.indexOfField=function(a,b){for(var c=0;c<this.length;c+=1)if(this[c][b]===a[b])return c;return-1},Array.prototype.position=function(a,b){for(var c=0;c<this.length;c+=1)if(this[c][b]===a)return c;return-1},Array.prototype.where=function(a,b){for(var c=0;c<this.length;c+=1)if(this[c][b]===a)return this[c];return void 0},String.prototype.bool=function(){return"true"===String(this)},Array.prototype.diff=function(a){return this.filter(function(b){return a.indexOfField(b)<0})},Array.prototype.diffField=function(a,b){return this.filter(function(c){return a.indexOfField(c,b)<0})},String.prototype.format=String.prototype.f=function(){for(var a=this,b=arguments.length;b--;)a=a.replace(new RegExp("\\{"+b+"\\}","gm"),arguments[b]);return a},Array.prototype.remove=function(){for(var a,b,c=arguments,d=c.length;d&&this.length;)for(a=c[--d];-1!==(b=this.indexOf(a));)this.splice(b,1);return this},String.prototype.toDateString=function(){return this},Array.prototype.insert=function(a,b){this.splice(a,0,b)},String.prototype.endsWith=function(a){return-1!==this.indexOf(a,this.length-a.length)},String.prototype.startsWith=function(a){return this.slice(0,a.length)===a},Array.prototype.saveMemento=function(){this._original=this.slice()},Array.prototype.restoreMemento=function(){if(this.hasOwnProperty("_original")){this.splice(0,this.length);for(var a in this._original)"_original"!==a&&(this[a]=this._original[a])}},Array.prototype.removeAt=function(a){this.splice(a,1)},Array.prototype.removeItemsProperty=function(a){return angular.forEach(this,function(b){b[a]=void 0}),this},String.prototype.endsWith=function(a){return-1!==this.indexOf(a,this.length-a.length)},function(a,b){var c={};c.map=function(a,d){var e=arguments[2];if(a.map!==b)return a.map(d,e);var f=a.length;if(!c.isFunction(d))throw new TypeError;for(var g=new Array(f),h=0;f>h;h++)h in a&&(g[h]=d.call(e,a[h],h,a));return g},c.filter=function(a,d){var e=arguments[2];if(a.filter!==b)return a.filter(d,e);var f=a.length;if(!c.isFunction(d))throw new TypeError;for(var g=new Array,h=0;f>h;h++)if(h in a){var i=a[h];d.call(e,i,h,a)&&g.push(i)}return g},c.every=function(a,d){var e=arguments[2];if(a.every!==b)return a.every(d,e);var f=a.length;if(!c.isFunction(d))throw new TypeError;for(var g=0;f>g;g++)if(g in a&&!d.call(e,a[g],g,a))return!1;return!0},c.some=function(a,c){var d=arguments[2];if(a.some!==b)return a.some(c,d);for(var e=a.length,f=0;e>f;f++)if(f in a&&c.call(d,a[f],f,a))return!0;return!1},c.isFunction=function(a){return"function"==typeof a},c.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},c.extendDeferredSort=function(a,b){var c=function(a){return{keySelector:a.keySelector,comparer:a.comparer,reverse:a.reverse,next:null==a.next?b:c(a.next)}};return c(a)},c.createLambda=function(a){if(c.isFunction(a))return a;if("string"==typeof a&&""!==a){if(a.indexOf("=>")<0)return new Function("$,$$,$$$","return "+a);var b=a.match(/^\s*\(?\s*([^)]*)\s*\)?\s*=>(.*)/);return new Function(b[1],"return "+b[2])}return a},c.processDeferredSort=function(a){if(null!=a.deferredSort){var b=function(a,c,d){var e;return e=d.reverse?d.comparer(d.keySelector(c),d.keySelector(a)):d.comparer(d.keySelector(a),d.keySelector(c)),0==e?null==d.next?0:b(a,c,d.next):e};a.array.sort(function(c,d){return b(c,d,a.deferredSort)}),a.deferredSort=null}},c.identity=function(a){return a},c.isString=function(a){return"string"==typeof a||a instanceof String},c.isBoolean=function(a){return"boolean"==typeof a||a instanceof Boolean},c.isNumber=function(a){return"number"==typeof a||a instanceof Number},c.caseInsensitiveComparer=function(a,b){var d=c.isString(a)?a.toLowerCase():a,e=c.isString(a)?b.toLowerCase():b;return e>d?-1:d>e?1:0},c.caseSensitiveComparer=function(a,b){return b>a?-1:a>b?1:0},c.defaultStringComparer=c.caseSensitiveComparer,c.strictComparer=function(a,b){return a===b},c.normalizeComparer=function(a){return function(b,d){var e=a(b,d);if(c.isBoolean(e))return e;if(c.isNumber(e))return 0==e;throw new Error("Invalid value from comparer function.")}};var d=function(a){var b=!0;arguments.length>=1&&null!=arguments[1]&&!arguments[1]&&(b=!1),this.array=b?null==a?[]:a.slice(0):a,this.deferredSort=null};d.identity=c.identity,d.isString=c.isString,d.isBoolean=c.isBoolean,d.isNumber=c.isNumber,d.caseInsensitiveComparer=c.caseInsensitiveComparer,d.caseSensitiveComparer=c.caseSensitiveComparer,d.defaultStringComparer=c.defaultStringComparer,d.strictComparer=c.strictComparer,d.from=function(a){return null==a?new d([]):a instanceof d?a:c.isArray(a)?new d(a):jQuery&&a instanceof jQuery?new d(a.get()):new d([a],!1)},d.range=function(a,b,c){if(null==a||isNaN(a))throw new Error("Invalid 'from' value.");if(null==b||isNaN(b))throw new Error("Invalid 'to' value.");(null==c||isNaN(c))&&(c=1);for(var e=[],f=a;b>=f;f+=c)e.push(f);return new d(e,!1)},d.repeat=function(a,b){(null==b||isNaN(b))&&(b=1);for(var c=[],e=0;b>e;e++)c.push(a);return new d(c,!1)},d.matches=function(a,b,c){if(null==b)throw new Error("Invalid 'pattern' value.");if(null==a)return new d([]);if("string"!=typeof a)throw new Error("Parameter 'text' is not a string.");null==c&&(c=""),c.indexOf("g")<0&&(c+="g");var e;b instanceof RegExp?(c.indexOf("i")<0&&b.ignoreCase&&(c+="i"),c.indexOf("m")<0&&b.multiline&&(c+="m"),e=b.source):e=b;var f=new RegExp(e,c),g=a.match(f);return new d(null==g?[]:g,!1)},d.prototype={aggregate:function(a,b,d){if(b=c.createLambda(b),d=c.createLambda(d),null==b||!c.isFunction(b))throw new Error("Invalid operation.");if(null!=d&&!c.isFunction(d))throw new Error("Invalid result selector.");c.processDeferredSort(this);var e=this.array.length;if(0==e&&null==a)throw new Error("Cannot aggregate on empty collection when seed is not given.");for(var f=null==a?this.array[0]:a,g=0;e>g;g++)g in this.array&&(f=b(f,this.array[g]));return null==d?f:d(f)},all:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid predicate.");return c.processDeferredSort(this),c.every(this.array,a)},any:function(a){if(a=c.createLambda(a),null!=a&&!c.isFunction(a))throw new Error("Invalid predicate.");return c.processDeferredSort(this),null==a?this.array.length>0:c.some(this.array,a)},average:function(a){if(a=c.createLambda(a),null!=a&&!c.isFunction(a))throw new Error("Invalid selector.");c.processDeferredSort(this);for(var b=this.array.length,d=0,e=1,f=0;b>f;f++)if(f in this.array){var g=null==a?this.array[f]:a(this.array[f]);if(null==g)continue;if(isNaN(g))throw new Error("Encountered an element that is not a number.");d+=(g-d)/e,e+=1}return d},batch:function(a,b){if(b=c.createLambda(b),null!=b&&!c.isFunction(b))throw new Error("Invalid result selector.");if(null==a||isNaN(a)||0>=a)throw new Error("Invalid size.");c.processDeferredSort(this);for(var e=[],f=0,g=this.array.length,h=null,i=0;g>i;i++)i in this.array&&(null==h&&(h=[],e.push(h)),h[f]=null==b?this.array[i]:b(this.array[i]),f+=1,f==a&&(h=null,f=0));return new d(e,!1)},concat:function(a){if(c.processDeferredSort(this),null==a)return new d(this.array);var b=d.from(a);return c.processDeferredSort(b),new d(this.array.concat(b.array),!1)},contains:function(a,b){if(b=c.createLambda(b),null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");return null!=b&&(b=c.normalizeComparer(b)),c.processDeferredSort(this),c.some(this.array,function(c){return null==b?c===a:b(c,a)})},count:function(a){if(a=c.createLambda(a),null!=a&&!c.isFunction(a))throw new Error("Invalid predicate.");if(c.processDeferredSort(this),null==a)return this.array.length;for(var b=this.array.length,d=0,e=0;b>e;e++)e in this.array&&a(this.array[e])&&(d+=1);return d},defaultIfEmpty:function(a){return c.processDeferredSort(this),0==this.array.length?new d([a],!1):new d(this.array)},distinct:function(a){return this.distinctBy(c.identity,a)},distinctBy:function(a,b){if(a=c.createLambda(a),b=c.createLambda(b),null==a||!c.isFunction(a))throw new Error("Invalid key selector.");if(null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");return c.processDeferredSort(this),this.groupBy(a,null,b).select(function(a){return new d(a.values,!1).first()})},elementAt:function(a){if(null==a||isNaN(a)||0>a||a>=this.array.length)throw new Error("Invalid index.");return c.processDeferredSort(this),this.array[a]},elementAtOrDefault:function(a,b){return null==a||isNaN(a)||0>a||a>=this.array.length?b:(c.processDeferredSort(this),this.array[a])},equiZip:function(a,b){if(b=c.createLambda(b),null==b||!c.isFunction(b))throw new Error("Invalid result selector.");c.processDeferredSort(this);var e=d.from(a);if(c.processDeferredSort(e),this.array.length!=e.array.length)throw new Error("The two collections being equi-zipped are not of equal lengths.");for(var f=this.array.length,g=[],h=0;f>h;h++)g.push(b(this.array[h],e.array[h]));return new d(g,!1)},except:function(a,b){if(b=c.createLambda(b),null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");if(null!=b&&(b=c.normalizeComparer(b)),c.processDeferredSort(this),null==a)return new d(this.array);var e=d.from(a);c.processDeferredSort(e);for(var f=this.array.length,g=new d([],!1),h=0;f>h;h++)if(h in this.array){var i=this.array[h],j=function(a){return null==b?a===i:b(a,i)},k=c.some(g.array,j),l=c.some(e.array,j);k||l||g.array.push(i)}return g},first:function(a){if(a=c.createLambda(a),null!=a&&!c.isFunction(a))throw new Error("Invalid predicate.");c.processDeferredSort(this);for(var b=this.array.length,d=0;b>d;d++)if(d in this.array&&(null==a||a(this.array[d])))return this.array[d];throw new Error("No first item was found in collection.")},firstOrDefault:function(a,b){if(b=c.createLambda(b),null!=b&&!c.isFunction(b))throw new Error("Invalid predicate.");c.processDeferredSort(this);for(var d=this.array.length,e=0;d>e;e++)if(e in this.array&&(null==b||b(this.array[e])))return this.array[e];return a},foreach:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid action.");c.processDeferredSort(this);for(var b=this.array.length,d=0;b>d;d++)d in this.array&&a(this.array[d],d)},groupBy:function(a,b,e){if(a=c.createLambda(a),b=c.createLambda(b),e=c.createLambda(e),null==a||!c.isFunction(a))throw new Error("Invalid key selector.");if(null!=b&&!c.isFunction(b))throw new Error("Invalid element selector.");if(null!=e&&!c.isFunction(e))throw new Error("Invalid key comparer.");null!=e&&(e=c.normalizeComparer(e)),c.processDeferredSort(this);for(var f=this.array.length,g=new d([],!1),h=0;f>h;h++){var i=this.array[h],j=a(i),k=null==b?i:b(i),l=g.firstOrDefault(null,function(a){return null==e?a.key===j:e(a.key,j)});null==l?g.array.push({key:j,values:[k]}):l.values.push(k)}return g},groupJoin:function(a,b,e,f,g){if(b=c.createLambda(b),e=c.createLambda(e),f=c.createLambda(f),g=c.createLambda(g),null==a)throw new Error("Invalid inner collection.");if(null==b||!c.isFunction(b))throw new Error("Invalid outer key selector.");if(null==e||!c.isFunction(e))throw new Error("Invalid inner key selector.");if(null==f||!c.isFunction(f))throw new Error("Invalid result selector.");if(null!=g&&!c.isFunction(g))throw new Error("Invalid key comparer.");null!=g&&(g=c.normalizeComparer(g)),c.processDeferredSort(this);for(var h=d.from(a),i=h.groupBy(e,null,g),j=this.array.length,k=[],l=0;j>l;l++)if(l in this.array){var m=this.array[l],n=b(m),o=i.firstOrDefault(null,function(a){return null==g?a.key===n:g(a.key,n)});k.push(f(m,null==o?[]:o.values))}return new d(k,!1)},index:function(a){if(null==a&&(a=0),isNaN(a))throw new Error("Invalid startIndex");return this.select(function(b,c){return{key:a+c,value:b}})},indexOf:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid predicate.");c.processDeferredSort(this);for(var b=this.array.length,d=0;b>d;d++)if(d in this.array&&a(this.array[d]))return d;return-1},indexOfElement:function(a,b){if(b=c.createLambda(b),null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");null!=b&&(b=c.normalizeComparer(b)),c.processDeferredSort(this);for(var d=this.array.length,e=0;d>e;e++)if(e in this.array&&(null==b&&this.array[e]===a||null!=b&&b(this.array[e],a)))return e;return-1},intersect:function(a,b){if(null==a)return new d([],!1);b=c.createLambda(b);var e=d.from(a);if(c.processDeferredSort(e),null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");null!=b&&(b=c.normalizeComparer(b)),c.processDeferredSort(this);for(var f=this.array.length,g=new d([],!1),h=0;f>h;h++)if(h in this.array){var i=this.array[h],j=function(a){return null==b?a===i:b(a,i)},k=c.some(g.array,j),l=c.some(e.array,j);!k&&l&&g.array.push(i)}return g},join:function(a,b,e,f,g){if(b=c.createLambda(b),e=c.createLambda(e),f=c.createLambda(f),g=c.createLambda(g),null==a)throw new Error("Invalid inner collection.");if(null==b||!c.isFunction(b))throw new Error("Invalid outer key selector.");if(null==e||!c.isFunction(e))throw new Error("Invalid inner key selector.");if(null==f||!c.isFunction(f))throw new Error("Invalid result selector.");if(null!=g&&!c.isFunction(g))throw new Error("Invalid key comparer.");null!=g&&(g=c.normalizeComparer(g)),c.processDeferredSort(this);for(var h=d.from(a),i=h.groupBy(e,null,g),j=this.array.length,k=[],l=0;j>l;l++)if(l in this.array){var m=this.array[l],n=b(m),o=i.firstOrDefault(null,function(a){return null==g?a.key===n:g(a.key,n)});if(null!=o&&o.values.length>0)for(var p=o.values.length,q=0;p>q;q++)k.push(f(m,o.values[q]))}return new d(k,!1)},last:function(a){if(a=c.createLambda(a),null!=a&&!c.isFunction(a))throw new Error("Invalid predicate.");c.processDeferredSort(this);for(var b=this.array.length-1;b>=0;b--)if(b in this.array&&(null==a||a(this.array[b])))return this.array[b];throw new Error("No last item was found in collection.")},lastIndexOf:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid predicate.");c.processDeferredSort(this);for(var b=this.array.length,d=b-1;d>=0;d--)if(d in this.array&&a(this.array[d]))return d;return-1},lastIndexOfElement:function(a,b){if(b=c.createLambda(b),null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");null!=b&&(b=c.normalizeComparer(b)),c.processDeferredSort(this);for(var d=this.array.length,e=d-1;e>=0;e--)if(e in this.array&&(null==b&&this.array[e]===a||null!=b&&b(this.array[e],a)))return e;return-1},lastOrDefault:function(a,b){if(b=c.createLambda(b),null!=b&&!c.isFunction(b))throw new Error("Invalid predicate.");c.processDeferredSort(this);for(var d=this.array.length-1;d>=0;d--)if(d in this.array&&(null==b||b(this.array[d])))return this.array[d];return a},min:function(a){if(0==this.array.length)throw new Error("No minimum element.");if(a=c.createLambda(a),null!=a&&!c.isFunction(a))throw new Error("Invalid selector.");c.processDeferredSort(this);for(var b=this.array.length,d=null==a?this.array[0]:a(this.array[0]),e=1;b>e;e++)if(e in this.array){var f=null==a?this.array[e]:a(this.array[e]);d>f&&(d=f)}return d},minBy:function(a){if(0==this.array.length)throw new Error("No mininum element.");if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid selector.");c.processDeferredSort(this);for(var b=this.array.length,d=a(this.array[0]),e=this.array[0],f=1;b>f;f++)if(f in this.array){var g=this.array[f],h=a(g);d>h&&(d=h,e=g)}return e},max:function(a){if(0==this.array.length)throw new Error("No maximum element.");if(a=c.createLambda(a),null!=a&&!c.isFunction(a))throw new Error("Invalid selector.");c.processDeferredSort(this);for(var b=this.array.length,d=null==a?this.array[0]:a(this.array[0]),e=1;b>e;e++)if(e in this.array){var f=null==a?this.array[e]:a(this.array[e]);f>d&&(d=f)}return d},maxBy:function(a){if(0==this.array.length)throw new Error("No maximum element.");if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid selector.");c.processDeferredSort(this);for(var b=this.array.length,d=a(this.array[0]),e=this.array[0],f=1;b>f;f++)if(f in this.array){var g=this.array[f],h=a(g);h>d&&(d=h,e=g)}return e},orderBy:function(a,b){if(a=c.createLambda(a),b=c.createLambda(b),null==a||!c.isFunction(a))throw new Error("Invalid key selector.");if(null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");null==b&&(b=c.defaultStringComparer),c.processDeferredSort(this);var e=new d(this.array);return e.deferredSort={keySelector:a,comparer:b,reverse:!1,next:null},e},orderByDescending:function(a,b){if(a=c.createLambda(a),b=c.createLambda(b),null==a||!c.isFunction(a))throw new Error("Invalid key selector.");if(null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");null==b&&(b=c.defaultStringComparer),c.processDeferredSort(this);var e=new d(this.array);return e.deferredSort={keySelector:a,comparer:b,reverse:!0,next:null},e},pad:function(a,b){if(null==a||isNaN(a))throw new Error("Invalid width.");c.processDeferredSort(this);var e=this.array.length;return e>=a?new d(this.array):new d(this.array.concat(d.repeat(b,a-e).array),!1)},padWith:function(a,b){if(null==a||isNaN(a))throw new Error("Invalid width");if(b=c.createLambda(b),null==b||!c.isFunction(b))throw new Error("Invalid padding selector.");c.processDeferredSort(this);var e=this.array.length;if(e>=a)return new d(this.array);for(var f=[],g=e;a>g;g++)f.push(b(g));return new d(this.array.concat(f),!1)},pipe:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid action.");c.processDeferredSort(this);for(var b=this.array.length,e=0;b>e;e++)e in this.array&&a(this.array[e],e);return new d(this.array)},prepend:function(a){return c.processDeferredSort(this),new d([a].concat(this.array),!1)},prescan:function(a,b){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid operation.");c.processDeferredSort(this);var e=this.array.length;if(0==e)return new d([],!1);for(var f=b,g=[f],h=0;e-1>h;h++)h in this.array&&(f=a(f,this.array[h]),g.push(f));return new d(g,!1)},reverse:function(){return c.processDeferredSort(this),new d(this.array.reverse(),!1)},scan:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid operation.");c.processDeferredSort(this);var b=this.array.length;if(0==b)throw new Error("Cannot scan on empty collection.");for(var e=this.array[0],f=[e],g=1;b>g;g++)g in this.array&&(e=a(e,this.array[g]),f.push(e));return new d(f,!1)},select:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid selector.");return c.processDeferredSort(this),new d(c.map(this.array,a),!1)},selectMany:function(a,b){if(a=c.createLambda(a),b=c.createLambda(b),null==a||!c.isFunction(a))throw new Error("Invalid collection selector.");if(null!=b&&!c.isFunction(b))throw new Error("Invalid result selector.");c.processDeferredSort(this);for(var e=this.array.length,f=[],g=0;e>g;g++){var h=this.array[g],i=a(h,g);if(c.isArray(i)||(i=d.from(i).toArray()),null!=i&&i.length>0)for(var j=i.length,k=0;j>k;k++){var l=i[k],m=null==b?l:b(l,h);f.push(m)}}return new d(f,!1)},sequenceEqual:function(a,b){if(null==a)return!1;if(b=c.createLambda(b),null!=b&&!c.isFunction(b))throw new Error("Invalid comparer");null!=b&&(b=c.normalizeComparer(b)),c.processDeferredSort(this);var e=d.from(a);c.processDeferredSort(e);var f=this.array.length;if(f!=e.array.length)return!1;for(var g=0;f>g;g++)if(null==b){if(this.array[g]!==e.array[g])return!1}else if(!b(this.array[g],e.array[g]))return!1;return!0},sequenceEquivalent:function(a,b){if(null==a)return!1;if(b=c.createLambda(b),null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");null!=b&&(b=c.normalizeComparer(b)),c.processDeferredSort(this);var e=d.from(a);c.processDeferredSort(e);var f=this.array.length,g=e.array.length;if(f!=g)return!1;var h=this.toLookup("x => x",b),i=e.toLookup("x => x",b);return h.count()==i.count()&&h.all(function(a){var c=i.firstOrDefault(null,function(c){return null==b?c.key===a.key:b(c.key,a.key)});return null==c?!1:a.values.length==c.values.length})},single:function(a){if(a=c.createLambda(a),null==a){if(0==this.array.length)throw new Error("No single item in the collection.");if(this.array.length>1)throw new Error("More than one item in the collection.");return c.processDeferredSort(this),this.array[0]}if(!c.isFunction(a))throw new Error("Invalid predicate.");c.processDeferredSort(this);for(var b=this.array.length,d=!1,e=null,f=0;b>f;f++)if(f in this.array&&a(this.array[f])){if(d)throw new Error("More than one item matched the predicate in the collection.");d=!0,e=this.array[f]}if(!d)throw new Error("No single item matched the predicate in the collection.");return e},singleOrDefault:function(a,b){if(b=c.createLambda(b),null==b){if(0==this.array.length)return a;if(this.array.length>1)throw new Error("More than one item in the collection.");return c.processDeferredSort(this),this.array[0]}if(!c.isFunction(b))throw new Error("Invalid predicate.");c.processDeferredSort(this);for(var d=this.array.length,e=!1,f=null,g=0;d>g;g++)if(g in this.array&&b(this.array[g])){if(e)throw new Error("More than one item matched the predicate in the collection.");e=!0,f=this.array[g]}return e?f:a},singleOrFallback:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid fallback");if(c.processDeferredSort(this),0==this.array.length)return a();if(1==this.array.length)return this.array[0];throw new Error("More than one item in the collection.")},skip:function(a){if(null==a||isNaN(a))throw new Error("Invalid count.");return c.processDeferredSort(this),new d(this.array.slice(a),!1)},skipUntil:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid predicate");return this.skipWhile(function(b){return!a(b)})},skipWhile:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid predicate.");c.processDeferredSort(this);for(var b=this.array.length,e=[],f=!0,g=0;b>g;g++){var h=this.array[g];f?a(h)||(f=!1,e.push(h)):e.push(h)}return new d(e,!1)},sum:function(a){if(c.processDeferredSort(this),0==this.array.length)return 0;if(a=c.createLambda(a),null!=a&&!c.isFunction(a))throw new Error("Invalid selector.");for(var b=this.array.length,d=0,e=0;b>e;e++)if(e in this.array){var f=null==a?this.array[e]:a(this.array[e]);null!=f&&(d+=f)}return d},take:function(a){if(null==a||isNaN(a))throw new Error("Invalid count.");return c.processDeferredSort(this),new d(this.array.slice(0,a),!1)},takeEvery:function(a){if(null==a||isNaN(a))throw new Error("Invalid count.");return c.processDeferredSort(this),this.where(function(b,c){return c%a==0})},takeLast:function(a){if(null==a||isNaN(a))throw new Error("Invalid count.");return c.processDeferredSort(this),0>=a?new d([],!1):(a>this.array.length&&(a=this.array.length),new d(this.array.slice(this.array.length-a),!1))},takeUntil:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid predicate");return this.takeWhile(function(b){return!a(b)})},takeWhile:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid predicate.");c.processDeferredSort(this);for(var b=this.array.length,e=[],f=!0,g=0;b>g&&f;g++){var h=this.array[g];a(h)?e.push(h):f=!1}return new d(e,!1)},thenBy:function(a,b){if(a=c.createLambda(a),b=c.createLambda(b),null==a||!c.isFunction(a))throw new Error("Invalid key selector.");if(null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");if(null==this.deferredSort)throw new Error("ThenBy can only be called following an OrderBy/OrderByDescending.");null==b&&(b=c.defaultStringComparer);var e=new d(this.array);return e.deferredSort=c.extendDeferredSort(this.deferredSort,{keySelector:a,comparer:b,reverse:!1,next:null}),e},thenByDescending:function(a,b){if(a=c.createLambda(a),b=c.createLambda(b),null==a||!c.isFunction(a))throw new Error("Invalid key selector.");if(null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");if(null==this.deferredSort)throw new Error("ThenByDescending can only be called following an OrderBy/OrderByDescending.");null==b&&(b=c.defaultStringComparer);var e=new d(this.array);return e.deferredSort=c.extendDeferredSort(this.deferredSort,{keySelector:a,comparer:b,reverse:!0,next:null}),e},toDelimitedString:function(a){return null==a&&(a=","),c.processDeferredSort(this),this.array.join(a)},toDictionary:function(a,b){if(a=c.createLambda(a),b=c.createLambda(b),null==a||!c.isFunction(a))throw new Error("Invalid key selector.");if(null!=b&&!c.isFunction(b))throw new Error("Invalid element selector.");c.processDeferredSort(this);for(var d=this.array.length,e={},f=0;d>f;f++){var g=this.array[f],h=a(g);if(h in e)throw new Error("Duplicate key in collection.");e[h]=null==b?g:b(g)}return e},toJQuery:function(){if(!jQuery)throw new Error("Cannot return jQuery object--jQuery not available.");return c.processDeferredSort(this),jQuery(this.array)},toLookup:function(a,b){if(a=c.createLambda(a),b=c.createLambda(b),null==a||!c.isFunction(a))throw new Error("Invalid key selector.");if(null!=b&&!c.isFunction(b))throw new Error("Invalid comparer");null!=b&&(b=c.normalizeComparer(b)),c.processDeferredSort(this);for(var e=new d([],!1),f=this.array.length,g=0;f>g;g++)if(g in this.array){var h=this.array[g],i=a(h),j=e.firstOrDefault(null,function(a){return null==b?a.key===i:b(a.key,i)});null==j&&(j={key:i,values:[]},e.array.push(j)),j.values.push(h)}return e},union:function(a,b){if(b=c.createLambda(b),null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");null!=b&&(b=c.normalizeComparer(b)),c.processDeferredSort(this);var e=d.from(null==a?[]:a);c.processDeferredSort(e);for(var f=this.array.length,g=new d([],!1),h=0;f>h;h++)if(h in this.array){var i=this.array[h],j=c.some(g.array,function(a){return null==b?a===i:b(a,i)});j||g.array.push(i)}f=e.array.length;for(var h=0;f>h;h++)if(h in e.array){var i=e.array[h],j=c.some(g.array,function(a){return null==b?a===i:b(a,i)});j||g.array.push(i)}return g},where:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid predicate.");return c.processDeferredSort(this),new d(c.filter(this.array,a),!1)},zip:function(a,b){if(b=c.createLambda(b),null==b||!c.isFunction(b))throw new Error("Invalid result selector.");if(c.processDeferredSort(this),null==a)return new d([],!1);var e=d.from(a);c.processDeferredSort(e);for(var f=Math.min(this.array.length,e.array.length),g=[],h=0;f>h;h++)g.push(b(this.array[h],e.array[h]));return new d(g,!1)},zipLongest:function(a,b,e,f){if(f=c.createLambda(f),null==f||!c.isFunction(f))throw new Error("Invalid result selector.");c.processDeferredSort(this);var g=d.from(a);c.processDeferredSort(g);for(var h=Math.max(this.array.length,g.array.length),i=[],j=0;h>j;j++)i.push(f(j>=this.array.length?b:this.array[j],j>=g.array.length?e:g.array[j]));return new d(i,!1)},toArray:function(){return c.processDeferredSort(this),this.array.slice(0)}},a.linq=d,a.$linq=d.from}(window);